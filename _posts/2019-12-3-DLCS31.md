---
title: "[31] CS2241N: Lecture 1 Word Vectors ì •ë¦¬"
date:   2019-12-30
excerpt: "Lecture 1 | Word Vectors ìš”ì•½"  
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---

# ëª©ì°¨
- [**INTRO**](--#intro--)
- [**Problems with NLP**](#--problems-with-nlp--)
  * [Problems resources like WordNet](#problems-resources-like-wordnet)
  * [Representing words as discrete symbols](#representing-words-as-discrete-symbols)
- [**Word2Vec**](#--word2vec--)
  * [Representing words by their context](#representing-words-by-their-context)
  * [Word2Vec Overview](#word2vec-overview)
  * [Word2vec: objective function](#word2vec--objective-function)
  * [more about objective function](#more-about-objective-function)
- [**train the model**](#--train-the-model--)



-----

# **INTRO**
ê°•ì˜ ì†Œê°œì™€ NLPì— ëŒ€í•œ overviewë¥¼ ì§„í–‰í•œë‹¤.     
ì˜¤ëŠ˜ ìš°ë¦¬ì˜ ëª©í‘œì¸ word2vecê³¼ ë³„ë¡œ ìƒê´€ì´ ì—†ê¸° ë•Œë¬¸ì— ìƒëµí•˜ê² ë‹¤.    

<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/178132912-247dc377-09f2-481d-8902-b0833e42c745.png)
![image](https://user-images.githubusercontent.com/76824611/178132914-602a0d79-e2c8-48b3-a371-440a7f764f06.png)
![image](https://user-images.githubusercontent.com/76824611/178132917-f100eedf-06ba-4b3a-9390-8fe3d0530644.png)

  
</div>
</details>

---


# **Problems with NLP**
ë¨¼ì € NLP taskì˜ ëŒ€í‘œì ì¸ ë¬¸ì œì ì„ ì‚´í´ë³´ê² ë‹¤.


## Problems resources like WordNet
* 1) ë‰˜ì•™ìŠ¤ì˜ ë¶€ì¡±     
   * ë‹¨ì–´ë“¤ì€ ë¬¸ì¥ì˜ ë¬¸ë§¥ì— ë”°ë¼ ì˜ë¯¸ê°€ ì¡°ê¸ˆì”© ë‹¬ë¼ì§„ë‹¤.         
   * ì´ëŸ¬í•œ ë‹¨ì–´ì˜ ë‰˜ì•™ìŠ¤ë¥¼ í‘œí˜„í•˜ê¸°ê°€ í˜ë“¤ë‹¤.    
* 2) OOVë¬¸ì œ     
   * out of vocabarary ë¬¸ì œë¡œ í•™ìŠµ ë•Œ ì—†ë˜ ìƒˆë¡œìš´ ë‹¨ì–´ë¥¼ ë´¤ì„ ë•Œ ì»´í“¨í„°ê°€ ë¬´ìŠ¨ ë‹¨ì–´ì¸ì§€ íŒŒì•…í•˜ê¸° í˜ë“¤ë‹¤ëŠ” ê²ƒì´ë‹¤.        
   * ê·¸ë¦¬ê³  ë‹¨ì–´ëŠ” ë¹ ë¥´ê²Œ ìƒˆë¡œìš´ë‹¨ì–´ë“¤ì´ ì¶œí˜„í•˜ëŠ”ë° ì´ëŸ¬í•œ ìƒˆë¡œìš´ ë‹¨ì–´ì— ëŒ€í•œ ëŒ€ì‘ì´ ë¶€ì¡±í•˜ë‹¤.     
* 3) ì£¼ê´€ì     
   * ê°™ì€ ë¬¸ì¥ì´ì–´ë„ ì‚¬ëŒì— ë”°ë¼ ê·¸ ë‹¨ì–´ì— ëŒ€í•´ ëŠë¼ëŠ” ë‰˜ì•™ìŠ¤ê°€ ë‹¤ë¦„     
* 4) ì¸ê°„ì˜ ë…¸ë™    
   * ë°ì´í„° ì „ì²˜ë¦¬ì™€ ê°™ì€ ì‘ì—…ì‹œ ë§ì€ ì¸ê°„ì˜ ë…¸ë™ì´ í•„ìš”í•˜ë‹¤.         
* 5) ë‹¨ì–´ ìœ ì‚¬ì„±ì„ ì •í™•í•˜ê²Œ ê³„ì‚°í•  ìˆ˜ ì—†ë‹¤.        



ì—¬ê¸°ì„œ 5)ì˜ ë¬¸ì œë¥¼ ìì„¸í•˜ê²Œ í™•ì¸í•´ë³´ê² ë‹¤.   



<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/178133425-7ff3b02a-118f-451a-8636-cded1f948e5c.png)

  
</div>
</details>

------


## Representing words as discrete symbols
NLP taskì—ì„œ ìš°ë¦¬ëŠ” ë‹¨ì–´í‘œí˜„ì„ [one-hot vectors](https://yerimoh.github.io/DL14/#%EC%A4%80%EB%B9%84-%EC%9B%90%ED%95%AB-one-hot-%ED%91%9C%ED%98%84)ë¡œ í‘œí˜„í•œë‹¤.       

ì¦‰, ì˜ˆë¥¼ ë“¤ì–´ hotel, motel ë¥¼  localí•œ ë‹¨ì–´ ë§ë­‰ì¹˜ì— ìˆë‹¤ê³  ê°€ì •í•´ë³´ê³  ì´ë¥¼ ì›í•« ë²¡í„°ë¡œ í‘œí˜„í•´ë³´ë©´,    
ì•„ë˜ì™€ ê°™ë‹¤.    
ì´ì™€ ê°™ì€ í‘œí˜„ì„ **localist representation**ë¼ê³  í•œë‹¤.      


![image](https://user-images.githubusercontent.com/76824611/178133125-e5755b4f-9502-45e3-ada1-d1015a0db3a4.png)


ì—¬ê¸°ì„œ ì›í•« ë²¡í„°ì˜ ì°¨ì›(Vector dimension)ì€ ì „ì²´ ë§ë­‰ì¹˜ì—ì„œ ë‹¨ì–´ì˜ ê°œìˆ˜ì´ë‹¤.        


**[ìœ ì‚¬ë‹¨ì–´ í‘œí˜„ ë¬¸ì œ]**    
ê·¸ëŸ°ë° ì´ë ‡ê²Œ ì›í•«ë²¡í„°ë¡œ í‘œí˜„í•˜ë©´ ìœ„ ë‹¨ì–´ë“¤ì´ ì „í˜€ ì—°ê´€ì„±ì´ ì—†ëŠ” ë‹¨ì–´ê°€ ì•„ë‹Œ "ìˆ™ì†Œ"ë¼ëŠ” ê³µí†µì ì„ ê°–ì—ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ì´ë¥¼ ë‹¨ì–´ ë²¡í„°ì—ì„œ í‘œí˜„í•˜ì§€ ëª»í•œë‹¤(ë‘ ë‹¨ì–´ì— ëŒ€í•œ ë‹¨ì–´ ë²¡í„°ê°€ ì „í˜€ ë‹¤ë¥´ê²Œ ìƒê²¼ë‹¤.)      
ì™œëƒí•˜ë©´ í•˜ë‚˜ì˜ ë‹¨ì–´ì— í•˜ë‚˜ë§Œ 1ìœ¼ë¡œ í‘œí˜„ë˜ë¯€ë¡œ ê·¸ ë‹¨ì–´ì˜ ì¡´ì¬ ì´ì™¸ì— ë‹¤ë¥¸ ì •ë³´ë¥¼ í‘œí˜„í•  ë°©ë²•ì´ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.       


<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/178133438-316e73ee-33fe-4c16-9432-68d7d0b7397b.png)
![image](https://user-images.githubusercontent.com/76824611/178133445-841530bc-e80d-4c33-a454-f7df36fee750.png)

  
</div>
</details>




----
-----


# **Word2Vec**   



## Representing words by their context
ê·¸ë˜ì„œ ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë¬¸ë§¥ì„ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ë‹¨ì–´ ë²¡í„°ë¥¼ ë§Œë“¤ì—ˆë‹¤.    

**[Distributional semantics(ë¶„í¬ ì˜ë¯¸ë¡ )]**            
"ë‹¨ì–´ì˜ ì˜ë¯¸ë¥¼ ê·¸ ë‹¨ì–´ì˜ ê°€ê¹Œì´ì— ìˆëŠ” ë‹¨ì–´ì˜ ë¶„í¬ë¥¼ í†µí•´ í‘œí˜„í•˜ì" (A wordâ€™s meaning is given by the words that frequently appear close-by)ê°€ ê¸°ë³¸ ëª¨í† ì´ë‹¤.        

ì¦‰ í‘œí˜„í•˜ê³ ì í•˜ëŠ” ë‹¨ì–´(tagret w) ì£¼ë³€ì— ìˆëŠ” ë‹¨ì–´(context)ë¥¼ í†µí•´ ê·¸ ë‹¨ì–´ë¥¼ í‘œí˜„í•˜ìëŠ” ê²ƒì´ë‹¤.       
ì—¬ê¸°ì„œ í‘œí˜„í•˜ê³ ì í•˜ëŠ” ë‹¨ì–´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ **ì£¼ë³€ ëª‡ê°œì˜ ë‹¨ì–´ë¥¼ ë³¼ ê²ƒì¸ì§€**í•˜ëŠ” ì£¼ë³€ ë‹¨ì–´ ê³ ë ¤ ì‚¬ì´ì¦ˆë¥¼ **window size**ë¼ê³  í•œë‹¤.     

ì¦‰ ì•„ë˜ì—ì„œ targetì´ bankingì¼ ë•Œ ê·¸ ì£¼ìœ„ì˜ íšŒìƒ‰ì´ ë¬¸ë§¥(context)ë‹¨ì–´ì¸ ê²ƒì´ë‹¤.    
![image](https://user-images.githubusercontent.com/76824611/178133627-9337520f-1b5f-49b8-adcd-1ecadc7987db.png)




**[Word vectors]****          
ì´ ê°œë…ì€ ë¬¸ë§¥ì—ì„œ ë°œìƒí•˜ëŠ” ë‹¨ì–´ë¥¼ ë²¡í„°ë¼ê³  ë³¸ë‹¤.   
ê·¸ë¦¬ê³  ê° ë‹¨ì–´ì— ëŒ€í•´ ì–´ë–¤ ì˜ë¯¸ì—ì„œ **ê·¸ ë‹¨ì–´ì˜ ì˜ë¯¸**ë¥¼ ë‚˜íƒ€ë‚´ëŠ” **ì¡°ë°€í•œ ì‹¤ìˆ˜ê°’ ë²¡í„°**ë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.     
ì¦‰ í•˜ë‚˜ë§Œ 1ì´ê³  ë‚˜ë¨¸ì§€ 0ì¸ rawí•œ í‘œí˜„ì—ì„œ ì‹¤ìˆ˜ê°’ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ **ë‹¨ì–´ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´**ë¥¼ ë‹´ëŠ” ê²ƒì„ ëª©í‘œë¡œ ì‚¼ëŠ” ê²ƒì´ë‹¤.    
â¡ ì´ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ **vector dot (scalar) product**ê³¼ **similarity**ë¥¼ ì¸¡ì •í•˜ë©´ì„œ **ìœ ì‚¬í•œ ë§¥ë½ì—ì„œ ë‚˜íƒ€ë‚˜ëŠ” ë‹¨ì–´ì˜ ë²¡í„°ì™€ ë¹„ìŠ·**í•˜ë„ë¡ ì„ íƒëœ ê° ë‹¨ì–´ì— ëŒ€í•´ ì¡°ë°€í•œ ë²¡í„°ë¥¼ ë§Œë“¤ ê²ƒì´ë‹¤.                


ì‹¤ì œë¡œëŠ” 3ì²œì°¨ì›ì˜ ë²¡í„°ì§€ë§Œ ìš”ì•½í•´ì„œ ê·¸ë ¤ë³´ë©´,    
![image](https://user-images.githubusercontent.com/76824611/178134129-3da62229-357c-4bf6-b7cb-f0ceeb7ae5b1.png)
ìœ„ì—ì„œ 0ê³¼ 1ë¡œ ë‚˜íƒ€ë‚´ì–´ì§„ ë²¡í„°ì™€ ë‹¬ë¦¬ ì‹¤ìˆ˜ê°’ìœ¼ë¡œ ë‚˜íƒ€ëŸ¬ì ¸ ìˆë‹¤.        

â¡ ì´ëŠ” banking, monetaryë¼ëŠ” ë‹¨ì–´ì˜ ì˜ë¯¸ê°€ ë²¡í„°ì˜ 3ì²œì°¨ì› ëª¨ë‘ì— í¼ì ¸ìˆê¸° ë•Œë¬¸ì—,      
localist representation í‘œí˜„ì´ ì•„ë‹Œ distributed representation ì´ë‹¤.     



**[Word meaning as a neural word vector â€“ visualization]**          
ê° ë‹¨ì–´ë¥¼ ìœ„ì™€ ê°™ì´ í‘œí˜„í•˜ê³ ,   
ì´ë ‡ê²Œ í‘œí˜„í•œ word vectorë¥¼ ê³ ì°¨ì› ë²¡í„° ê³µê°„ì— ë°°ì¹˜í•˜ì—¬ í•´ë‹¹ ê³µê°„ì— ì„ë² ë”©í•œë‹¤.     


ê·¸ ê²°ê³¼ë¥¼ í™•ëŒ€í•˜ë©´(3ì²˜ë‚µì˜ ë‹¨ì–´ê°€ ìˆê°œ ë•Œë¬¸ì— ì „ì²´ë¥¼ ë³´ì—¬ì£¼ë©´ ì•„ì´ì— ë­ê°€ ë­”ì§€ ëª¨ë¥¸ë‹¤) ì•„ë˜ê³¼ ê°™ì´ ìƒê²¼ë‹¤.       

í™•ì¸í•´ë³´ë©´ ë¹„ìŠ·í•œ ë‹¨ì–´ë¼ë¦¬ ë¶™ì–´ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.     
ì¦‰ ì´ë ‡ê²Œ ë°€ì§‘ë²¡í„°ë¥¼ ì´ìš©í•˜ì—¬ ë‹¨ì–´ì˜ ìœ ì‚¬ì„±ë¥´ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.       
![image](https://user-images.githubusercontent.com/76824611/178134464-33f9f8d5-1c7a-445b-b165-a2dc876a6230.png)


-----


## Word2Vec Overview
Example windows and process for computing $$P(w_{t+j}|w_t)$$         
* $$w$$: ê° ë‹¨ì–´   
* $$t$$: í‘œí˜„í•˜ê³ ì í•˜ëŠ” íƒ€ê²Ÿ ë‹¨ì–´     
* $$j$$: window sizeë¡œ íƒ€ê²Ÿ ë‹¨ì–´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì£¼ë³€ ëª‡ê°œì˜ ë‹¨ì–´ë¥¼ ê³ ë ¤í•  ê²ƒì¸ì§€      

![image](https://user-images.githubusercontent.com/76824611/178134611-93188868-ce8e-4b56-ad03-9d5f9b225cc6.png)

ìœ„ì˜ ê³¼ì •ì„ ì•„ë˜ì™€ ê°™ì´ ëª¨ë“  ë‹¨ì–´ì— ë°˜ë³µí•œë‹¤.        

![image](https://user-images.githubusercontent.com/76824611/178134663-7f833c73-70de-419f-b30a-aa33cad2e6ee.png)


-----


## Word2vec: objective function  

1ï¸âƒ£ **Data likelihood**       
ê·¸ëŸ¼ í•œë‹¨ì–´ë¥¼ í‘œí˜„í•˜ëŠ” $$P(w_{t+j}|w_t)$$ ì´ ì‹ìœ¼ë¡œ ëª¨ë“  ë‹¨ì–´ë¥¼ í‘œí˜„í•´ì•¼ í•˜ë¯€ë¡œ,     
$$t= 1, â€¦ , T$$ ì´ì™€ ê°™ì´ të¥¼ í™•ì¥í•´ì¤€ë‹¤.       
ëª©ì : ì¤‘ì‹¬ë‹¨ì–´ ì£¼ë³€ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ë¬¸ë§¥ ë‹¨ì–´ì˜ ê°€ëŠ¥ì„±(Likelihood)ì„ ìµœëŒ€í™”    

![image](https://user-images.githubusercontent.com/76824611/178136026-38a4a926-aea6-466a-b10f-e50fe349e369.png)
* $$m$$: ê³ ì •ëœ window size            
* $$w_t$$: ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ì£¼ì–´ì§„ íƒ€ê²Ÿ ë‹¨ì–´(given center word)     
* $$Î¸$$: ìµœì í™”í•˜ê³ ìí•˜ëŠ” ë‹¨ì–´     


â€» $$;Î¸$$ëŠ” ëª¨ë“  ì„¸íƒ€ì— ëŒ€í•´ì„œ, ì¦‰ ì—¬ê¸°ì„  ëª¨ë“  ìµœì í™”í•˜ê³ ìí•˜ëŠ” ë‹¨ì–´ì— ëŒ€í•´ì„œ ë¼ëŠ” ëœ»ì´ë¼ëŠ”ë° ê°•ì˜ì— ì •í™•í•˜ê²Œ ë‚˜ì˜¤ì§€ ì•Šì•„ì„œ í˜¹ì‹œ ë” ì •í™•í•œ ì„¤ëª…ì´ ìˆìœ¼ë©´ ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤ã… ã…      

<details>
<summary>ğŸ“œ ìˆ˜ì‹ ì´í•´ë¥¼ ìœ„í•œ ì¶”ê°€ ì„¤ëª…</summary>
<div markdown="1">
  
**[Optimization: Gradient Descent]**      
* We have a cost function $$J(Î¸)$$ we want to **minimize**       
* [Gradient Descent](https://yerimoh.github.io/DL7/) is an algorithm to minimize $$J(Î¸)$$     
* Idea: for current value of $$Î¸$$, calculate gradient of $$J(Î¸)$$, then take **small step** in d**irection of negative gradient**. Repeat.        
* ì¦‰ í˜„ì¬ ìœ„ì¹˜ì—ì„œ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•˜ì—¬ ê¸°ìš¸ê¸°ê°€ ì‘ì€ ê³³ìœ¼ë¡œ ì´ë™í•´ ì†ì‹¤ê°’ì´ ìµœì†Œí™”ê°€ ë˜ëŠ” ì§€ì ì„ ì°¾ì•„ë‚˜ê°€ëŠ” ê²ƒì´ë‹¤.     
* ê·¸ëŸ¬ë¯€ë¡œ ì´ ê³¼ì •ì—ì„œ $$J(Î¸)$$ëŠ” ìµœì†Œí™”í•  ê¸°ìš¸ê¸°ë¥¼ ì°¾ì•„ë‚˜ê°€ê²Œ í•˜ëŠ” ê¸°ìš¸ê¸° ê³„ì‚° ë¯¸ë¶„ í•¨ìˆ˜ë¼ê³  ë³´ë©´ ëœë‹¤.        
![image](https://user-images.githubusercontent.com/76824611/178135398-3fca9c39-d336-4820-babc-d0a53300d39f.png)
  
 
ê·¸ë¦¬ê³  ì´ $$J(Î¸)$$ë¥¼ ê³„ì‚°í•˜ê³ , ê³„ì‚°í•œ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ì†ì‹¤ê°’ì´ ë‚®ì€ê³³ìœ¼ë¡œ Î¸ë¥¼ ì—…ë°ì´íŠ¸ ì‹œì¼œì¤˜ì•¼í•œë‹¤.       
  
![image](https://user-images.githubusercontent.com/76824611/178135716-0ff63dd3-f18a-4d0d-a080-b17dad8152c8.png)
  
  
  
</div>
</details>  


2ï¸âƒ£ **ìœ ë„ì‹**      
3ì„ ìœ ë„í•˜ëŠ” ìœ ë„ì‹ì¸ë° ê°•ì˜ì—ëŠ” ë”°ë¡œ ì„¤ëª…ì´ ë˜ì–´ìˆì§€ ì•Šì•„ì„œ ì¶”ê°€í•´ë´¤ë‹¤.          
ìœ ë„ì‹ì„ ì˜ ë”°ë¼ê°€ë³´ë©´ 1ê³¼ 3ì´ ê°™ì€ ì‹ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.     
* ë¨¼ì € í™•ë¥  ì‹ì„ ë³´ì
![image](https://user-images.githubusercontent.com/76824611/178136442-0e93be89-d421-4b1a-9e95-bb1b48f82b53.png)
* ì—¬ê¸°ì„œ ë§¥ë½ì˜ ë‹¨ì–´ë“¤ ì‚¬ì´ì— ê´€ë ¨ì„±ì´ ì—†ë‹¤ê³  ê°€ì • í›„ ë¶„í•´ (â€˜ì¡°ê±´ë¶€ ë…ë¦½â€™ì´ë¼ê³  ê°€ì •).   
![image](https://user-images.githubusercontent.com/76824611/178136447-ced4c47d-254d-4bb8-ae4d-e2b16a9abc94.png)
* ì†ì‹¤í•¨ìˆ˜ ìœ ë„     
skip-gramì—ì„œ ì†ì‹¤í•¨ìˆ˜ëŠ” ë‹¨ìˆœíˆ í™•ë¥ ì— logë¥¼ ì·¨í•œ ë‹¤ìŒ ë§ˆì´ë„ˆìŠ¤ë¥¼ ë¶™ì´ë©´ ë¨         
![image](https://user-images.githubusercontent.com/76824611/178136458-4d384fae-b378-44a3-ae3e-a3fe3b9f4583.png)
skip-gram ëª¨ë¸ì˜ ì†ì‹¤ í•¨ìˆ˜ëŠ” ë§¥ë½ë³„ ì†ì‹¤ì„ êµ¬í•œ ë‹¤ìŒ ëª¨ë‘ ë”í•¨.     
* ë§ë­‰ì¹˜ ì „ì²´ë¡œ í™•ì¥     
ì—¬ê¸°ì„œì˜ ì˜ˆì‹œëŠ” jê°€ 1ë¡œ ê³ ì •ë˜ì–´ìˆì§€ë§Œ ì´ jë¥¼ í™•ì¥ì‹œì¼œ mìœ¼ë¡œ ëŠ˜ë ¤ ëŠ˜ë¦° í™•ë¥ ë“¤ì„ ê³„ì‚°í•´ ì£¼ë©´ ë‹¤ìŒ ë‹¨ê³„ì¸ 3ì˜ ì‹ì´ ë‚˜ì˜¨ë‹¤.     
![image](https://user-images.githubusercontent.com/76824611/178136588-27798f38-5091-45ee-b5c5-8979b5fda731.png)




3ï¸âƒ£ **objective function**     
**(average) negative log likelihood:** ì•ì„œ ë§í–ˆë“¯ì´ skip-gramì—ì„œ ì†ì‹¤í•¨ìˆ˜ëŠ” ë‹¨ìˆœíˆ í™•ë¥ ì— logë¥¼ ì·¨í•œ ë‹¤ìŒ ë§ˆì´ë„ˆìŠ¤ë¥¼ ë¶™ì´ë©´ ëœë‹¤.            
ê·¸ë¦¬ê³  ì†ì‹¤ê°’ì˜ í‰ê· ì„ êµ¬í•´ì•¼í•˜ë‹ˆê¹Œ ì „ì²´ ë‹¨ì–´ì˜ ê°œìˆ˜ë¡œ ë‚˜ëˆ ($$1/T$$) nomalizationì„ í•´ì¤€ë‹¤.       
ì¦‰ ì•„ë˜ì˜ ì‹ìœ¼ë¡œ ì†ì‹¤ê°’ì„ êµ¬í•˜ê³  ì´ë¥´ë¥¼ ìµœì†Œí™” ì‹œí‚¤ëŠ” ê²ƒì´ë‹¤.   
**Minimizing objective function âŸº Maximizing predictive accuracy**       
ìš°ë¦¬ëŠ” ì•„ë˜ì˜ í•¨ìˆ˜ë¥¼ **minimize í•˜ëŠ” ê²ƒì´ ëª©ì **ì´ë‹¤.     

![image](https://user-images.githubusercontent.com/76824611/178137032-751898f6-397d-4e7c-a36d-bd5304586a9d.png)
* $$J(Î¸)$$: sometimes called a cost or [loss function](https://yerimoh.github.io/DL3/#%EC%86%90%EC%8B%A4-%ED%95%A8%EC%88%98loss-function)      



-----

ê·¸ëŸ¼ ìœ„ì˜ ì‹ì—ì„œ $$P(w_{t+j}|w_t ; Î¸)$$ë¥¼ ê³„ì‚°í•´ë³´ì.     

ë³¸ê²©ì ìœ¼ë¡œ ê³„ì‚°ì— ë“¤ì–´ê°€ê¸° ì „ì— ê° ë‹¨ì–´ $$w$$ì— ëŒ€í•´ **2ê°œì˜ vector**ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.     
* $$v_w$$ when w is a center word    
* $$u_w$$ when w is a context word     



1ï¸âƒ£ **ì‹ ì¬ì •ì˜**       
ê·¸ëŸ¼ $$P(w_{t+j}|w_t ; Î¸)$$ ì´ ì‹ì„ ì•„ë˜ì™€ ê°™ì´ ë°”ê¿”ì“¸ ìˆ˜ ìˆë‹¤.       
* $$c$$: center word      
* $$o$$: context word     
ì´ë¯€ë¡œ ì•„ë˜ ì‹ì€ center wordê°€ ì£¼ì–´ì¡Œì„ ë•Œ context wordê°€ ë‚˜ì˜¬ í™•ë¥ ì´ë‹¤.        

![image](https://user-images.githubusercontent.com/76824611/178138068-b70c03c9-cce4-443c-a633-563f0c39efca.png)


2ï¸âƒ£ **ì‹ ì„¤ëª… ë° ë¶„ì„**       
ì•„ë˜ í•¨ìˆ˜ëŠ” **softmax function**ì„ ì ìš©í•œ ê²ƒì´ë‹¤.        
* **(1)** ë‚´ì (Dot product)ì„ ì´ìš©í•˜ì—¬ oì™€ cì˜ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•œë‹¤.      
   * $$u^{T}v = u.v = \displaystyle\sum_{i=1}^{n}{u_{i}v_{i}}$$ â¡ ë²¡í„°ì˜ ì°¨ì›ë“¤ì´ ê°™ìœ¼ë‹ˆ ë‚´ì ì„ ìœ„í•´ $$T$$(ì°¨ì› ë³€ê²½) ìˆ˜í–‰      
    ex) $$u = 300$$x$$1$$, $$v= 300$$x$$1$$ ì´ë¼ë©´ $$u^{T}v = [1$$x$$300]$$ x $$[300$$x$$1]$$ ìœ¼ë¡œ ë°”ê¿” ê° ìë¦¬ $$i$$ë§ˆë‹¤ ê³„ì‚°í•˜ëŠ” ë‚´ì ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ë‹¤.        
* **(2)** exp(Exponentiation)ë¼ëŠ” ì§€ìˆ˜í™”ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ê°’ë“¤ì„ ì–‘ìˆ˜ê°’ìœ¼ë¡œ ë°”ê¾¼ë‹¤.     
   * ì•„ë˜ ì‹ì€ í™•ë¥ ì´ê¸° ë•Œë¬¸ì— ê°’ì´ ëª¨ë‘ ì–‘ìˆ˜ë¡œ ë‚˜ì™€ì•¼í•œë‹¤.      
* **(3)** í™•ë¥  ë¶„í¬ë¥¼ ë‚˜íƒ€ë‚´ê¸°ìœ„í•´ ì „ì²´ í•©ìœ¼ë¡œ ë‚˜ëˆ  ì •ê·œí™”ë¥¼ ì‹œí‚¨ë‹¤.          
![image](https://user-images.githubusercontent.com/76824611/178140131-6a4a85b0-739b-46f8-8b00-ccfb38719929.png)


       
<details>
<summary>ğŸ“œ softmax function ì„¤ëª… ë³´ê¸°</summary>
<div markdown="1">

í™•ë¥ ì„ 0ì—ì„œ 1ì‚¬ì´ë¡œ ì •ê·œí™” í•˜ëŠ” ê²ƒìœ¼ë¡œ  ì¡°ê¸ˆ íŠ¹ì´í•œ ì´ë¦„ì˜ ëœ»ì„ ê°–ê³ ìˆë‹¤.     
* **â€œsoftâ€**: ì¡°ê¸ˆì´ë¼ë„ ìœ ì‚¬í•˜ë©´ $$x_i$$ì— í™•ë¥ ì„ ë¶€ì—¬í•˜ê¸´ í•œë‹¤.          
* **â€œmaxâ€** : $$x_i$$ì¤‘ì—ì„œ ê°€ì¥ í° ê°’ì„ ë°˜í™˜í•œë‹¤.(ê·¸ëŸ°ë° ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ëŠ” ìµœëŒ€ê°’ì´ ì•„ë‹Œ ë¶„í¬ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ì¡°ê¸ˆ ì´ìƒí•œ ì´ë¦„ì´ë‹¤)       
* ë”¥ëŸ¬ë‹ì—ì„œ ë§ì´ ì‚¬ìš©í•œë‹¤.            
![image](https://user-images.githubusercontent.com/76824611/178140110-e2c928ce-f29b-4d2e-8458-fdec849f3704.png)

  
  
  
  
</div>
</details>  


-----


## more about objective function

ìœ„ì—ì„œ ë³¸ ëª©ì í•¨ìˆ˜(loss function) $$J(Î¸)$$ì˜ ë¯¸ë¶„ê°’, $$J'(Î¸)$$ë¥¼ **ìµœëŒ€í™”($$maximize$$)** í•˜ê±°ë‚˜,      
ì‹ì„ ë³´ë©´ likehoodì™€ ë¹„ìŠ·í•˜ë‹¤. ì¦‰ $$L(Î¸)$$ì—ì„œ ì†ì‹¤í•¨ìˆ˜ë¡œ ë°”ê¾¸ë©´ $$J(Î¸)$$ê°€ ë˜ë¯€ë¡œ ê·¸ëŸ¬ëŠ” ê²ƒì´ë‹¤.      
![image](https://user-images.githubusercontent.com/76824611/178569682-be046386-6cb0-4447-a35f-22e59834e34a.png)


$$J(Î¸)$$ì˜ í‰ê·  ì†ì‹¤ê°’(negotive log likelihood)ë¥¼ **ìµœì†Œí™”($$minimize$$)** í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.     
ì—¬ê¸°ì„œ ë¡œê·¸ë¥¼ ì”Œìš°ë©´ ê°’ë“¤ì´ monotoneí•˜ê²Œ ë˜ë¯€ë¡œ ì”Œìš°ëŠ” ê²ƒì´ë‹¤.       
![image](https://user-images.githubusercontent.com/76824611/178571347-0ec32240-6c4d-4c58-b29a-64ed17f6736a.png)
* $$T$$: ê¸€ ì „ì²´(text)ì˜ ê¸¸ì´      
* $$m$$: window size         
* $$t$$: ì¤‘ì•™ ë¬¸ì ìœ„ì¹˜      


ê·¸ëŸ¼,    
ìœ„ ì‹ì—ì„œ $$P(w_{t+j}|w_t ; Î¸)$$ ì´ ì‹ì„ ì•„ë˜ì™€ ê°™ì´ ì¬ì •ì˜í•´ë³´ì(ìœ„ì—ì„œ í–ˆì—ˆë‹¤.)    
ì•„ë˜ ì‹ì€ ì•ì„œ ë§í–ˆë“¯ 2ê°œì˜ ë‹¨ì–´(centor word, context word)ë¥¼ ê°–ê³ ìˆëŠ” ê²ƒì´ë‹¤.      
![image](https://user-images.githubusercontent.com/76824611/178572258-c48c3d44-34cb-4a8f-884d-49d699215b87.png)


ìš°ë¦¬ëŠ” $$J(Î¸)$$ì˜ ìµœì†Œí™”(minimize)ë¥¼ ìœ„í•´ ì´ ì‹ì„ **ë¯¸ë¶„**í•´ë³¼ ê²ƒì´ë‹¤.     
ì¦‰ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°(í¸ë¯¸ë¶„)í•˜ëŠ” ê²ƒì´ë‹¤.       
ì´ëŠ” ë‚´ì ê°’ì„ ê³„ì‚°í•˜ì—¬(ê°’ì´ í´ìˆ˜ë¡ ë‘ ë‹¨ì–´ê°€ ìœ ì‚¬)ë„ì¶œí•´ë‚¸ë‹¤.    

ë¨¼ì € ë¯¸ë¶„($$ \frac{âˆ‚}{âˆ‚v_c} $$)í•˜ê³ ,       
![image](https://user-images.githubusercontent.com/76824611/178587581-a41c26db-e82f-4e6f-a39c-6f1db58d5e32.png)

$$log$$ $$ \frac{a}{b} $$ $$= a-b$$ì´ë¯€ë¡œ   
![image](https://user-images.githubusercontent.com/76824611/178587596-2ee89f0d-3343-499e-9fe9-1cd50304f7b5.png)

ê·¸ëŸ¼ ê° ì‹ì„ <span style="colcr: #000FF">â‘ </span>ê³¼ ë¡œ ë³´ê³  ê³„ì‚°í•´ë³´ì     

1ï¸âƒ£ **â‘  ì‹**            
$$log$$ì™€ $$exp$$ëŠ” inverseê´€ê³„ ì´ë¯€ë¡œ ì„œë¡œ ì—†ì–´ì§€ê³  basic factì— ì˜í•´ $$u_o$$ê°€ ëœë‹¤.      
ì°¸ê³ ë¡œ $$v$$ëŠ” ê³ ë“±í•™êµë•Œ ë°°ìš´ ë‹¨ì¼ ë³€ìˆ˜ê°€ ì•„ë‹Œ vectorì´ë‹¤.         
![image](https://user-images.githubusercontent.com/76824611/178578395-146744af-9e7e-49e2-a41e-794ef260e043.png)


<details>
<summary>ğŸ“œ basic fact ì¦ëª…</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/178579765-c908788d-6aea-42dc-b67e-180a09c1b540.png)
  
</div>
</details>  

2ï¸âƒ£ **â‘¡ ì‹**       
Chain Ruleì„ 2ë²ˆ ì´ìš©í•˜ì—¬ ê³„ì‚°í•œë‹¤.       
ì—¬ê¸°ì„œ indexë¥¼ ë°”ê¿”ì£¼ê¸° ìœ„í•´ì„œ **x=1**ë¥¼ í•˜ëŠ” ì´ìœ ëŠ” ì›ë˜ ë³€ìˆ˜ì¸ wë¥¼ ì´ìš©í•˜ë©´ ì•ì˜ ë³€ìˆ˜ì™€ ì„ì—¬ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.    
![image](https://user-images.githubusercontent.com/76824611/178591046-b3b9b74b-3188-4e1d-acdb-b759bc19e415.png)



<details>
<summary>ğŸ“œ Chain Rule ì¦ëª…</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/178580277-802b8abb-9e1e-4f71-97ef-1eda6dce4f5e.png)
  
</div>
</details>  



3ï¸âƒ£ **â‘ +â‘¡**      
ì ê·¸ëŸ¼ ì•ì˜ â‘ ê³¼ â‘¡ë¥¼ ëŒ€ì…í•´ì„œ ì²« ì‹ì„ ì •ë¦¬í•œ ê²°ê³¼ë¥¼ ë³´ì.       
![image](https://user-images.githubusercontent.com/76824611/178591217-35f55429-ceb9-45e7-b94b-eeb0c86fab03.png)
ê·¸ ë‹¤ìŒ â‘¡ ì‹ì—ì„œ sumì„ ë°°ë¶„í•˜ë©´(distribute term across sum),     
â‘¡ëŠ” í‰ê· (expectation)ì´ ëœë‹¤: í™•ë¥ ì— ì˜í•œ ëª¨ë“  ë¬¸ë§¥ ë²¡í„° ê°€ì¤‘ì¹˜ì— ëŒ€í•œ í‰ê·         
![image](https://user-images.githubusercontent.com/76824611/178592370-4cdf4bf5-ff79-4c8d-982f-428b7853d5d7.png)

ì¦‰, ê²°ë¡ ì ìœ¼ë¡œ ìš°ë¦¬ê°€ **ì¤„ì´ê³ ì í•˜ëŠ”** ì†ì‹¤í•¨ìˆ˜ì˜ ìµœì¢… ëª©í‘œëŠ” ```ê´€ì°°ê°’-ê¸°ëŒ€ê°’```ì˜ $$Minimize$$ì´ë‹¤.        


<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
ê°•ì˜ ìŠ¬ë¼ì´ë“œê°€ ë‚œì¡í•´ì„œ ìœ„ì™€ê°™ì´ ê¹”ë”í•˜ê²Œ ì •ë¦¬í•´ë´¤ë‹¤.      
![image](https://user-images.githubusercontent.com/76824611/178580461-ae4849ef-a939-4668-a1eb-e3fb16440343.png)
![image](https://user-images.githubusercontent.com/76824611/178580473-d5acbc67-3c22-40a3-bb34-94b8891d1a59.png)
![image](https://user-images.githubusercontent.com/76824611/178580488-e5923b09-fe27-4370-abf8-e93d0f1457ac.png)
![image](https://user-images.githubusercontent.com/76824611/178580497-f12f80c0-065d-4939-9b67-5c13c66579db.png)

  
</div>
</details>



------
-------


# **train the model**   
To train the model: Optimize value of parameters to minimize loss     
ìœ„ì˜ Loss functionì„ ì´ìš©í•˜ì—¬ ëª¨ë“  ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•œë‹¤.     



![image](https://user-images.githubusercontent.com/76824611/178561243-5c2bebf1-ea35-4954-8995-5f5056e0596e.png)
* $$Î¸$$: ìš°ë¦¬ì˜ ëª¨ë“  ëª¨ë¸ ë§¤ê°œë³€ìˆ˜ë¥¼ í•˜ë‚˜ì˜ ê¸´ ë²¡í„°ë¡œ ë‚˜íƒ€ë‚¸ë‹¤.    
* $$d$$: ìš°ë¦¬ì˜ ê²½ìš° $$d$$(ì°¨ì›)ëŠ” 300ì´ë‹¤.     
* $$v$$: ë˜í•œ ë§ì€ $$v$$ë¥¼ ê°–ê³ ìˆë‹¤.     
* 2: ê·¸ë¦¬ê³  ëª¨ë“  ë‹¨ì–´ê°€ 2ê°œì˜ ë²¡í„°ë¥¼ ê°–ê³ ìˆë‹¤.        


ê·¸ë¦¬ê³  ìš°ë¦¬ì˜ ëª©í‘œëŠ” ëª¨ë“  ë²¡í„°ì˜ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•´ì„œ ì†ì‹¤ê°’ì´ ê°€ì¥ ë‚®ì€ ê³³ìœ¼ë¡œ ì´ë™í•˜ëŠ” ê²ƒì´ë‹¤.      

















---
title: "[33] CS2241N: Lecture 3 Backprop and Neural Networks ì •ë¦¬"
date:   2019-12-28
excerpt: "Lecture 3 | Lecture 3 Backprop and Neural Networks ìš”ì•½"  
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---


# **Deep Learning Classification Task: NER**   
 
**[NER]**    
* Named Entity Recognitionì˜ ì•½ì     
* ë¬¸ë§¥ì„ ì¶”ë¡ í•˜ì—¬ í•´ë‹¹ ìë¦¬ì— ì–´ë– í•œ ì¢…ë¥˜ì˜ ë‹¨ì–´ê°€ ë“¤ì–´ê°ˆì§€ë¥¼ ì •í•˜ëŠ” ê²ƒì´ë‹¤.     
* ë¯¸ë¦¬ ì •ì˜í•´ ë‘” ì‚¬ëŒ, íšŒì‚¬, ì¥ì†Œ, ì‹œê°„, ë‹¨ìœ„ ë“±ì— í•´ë‹¹í•˜ëŠ” ë‹¨ì–´(ê°œì²´ëª…)ë¥¼ ë¬¸ì„œì—ì„œ ì¸ì‹í•˜ì—¬ ì¶”ì¶œ ë¶„ë¥˜í•˜ëŠ” ê¸°ë²•ì´ë‹¤.    
* ì¶”ì¶œëœ ê°œì²´ëª…ì€ ì¸ëª…(person), ì§€ëª…(location), ê¸°ê´€ëª…(organization), ì‹œê°„(time) ë“±ìœ¼ë¡œ ë¶„ë¥˜ëœë‹¤. ê°œì²´ëª… ì¸ì‹(NER)ì€ ì •ë³´ ì¶”ì¶œì„ ëª©ì ìœ¼ë¡œ ì‹œì‘ë˜ì–´ ìì—°ì–´ ì²˜ë¦¬, ì •ë³´ ê²€ìƒ‰ ë“±ì— ì‚¬ìš©ëœë‹¤.       
* ì‰½ê²Œ í‘œí˜„í•˜ìë©´ 'ë¬¸ìì—´ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ë‹¨ì–´ ë³„ë¡œ í•´ë‹¹ë˜ëŠ” íƒœê·¸ë¥¼ ë‚´ë±‰ê²Œ í•˜ëŠ” multi-class ë¶„ë¥˜ ì‘ì—…'ì´ë¼ ë§í•  ìˆ˜ ìˆë‹¤.   



ì˜ˆë¥¼ ë“¤ì–´ë³´ì.     
ì•„ë˜ì˜ ë¬¸ì¥ë“¤ì—ì„œ ë¬¸ë§¥ì— ë”°ë¼ ê° ë¶„í™ìƒ‰ì—ëŠ”,    
* ```PER```ì—ëŠ” ì‚¬ëŒì´ ë“¤ì–´ê°€ì•¼ ìì—°ìŠ¤ëŸ½ë‹¤.     
* ```LOC```ì—ëŠ” ìœ„ì¹˜ê°€ ë“¤ì–´ê°€ì•¼ ìì—°ìŠ¤ëŸ½ë‹¤.       
* ```DATE```ì—ëŠ” ë‚ ì§œê°€ ë“¤ì–´ê°€ì•¼ ìì—°ìŠ¤ëŸ½ë‹¤. 
* ì¦‰ ì´ì™€ ê°™ì´ ê° ë‹¨ì–´ì— ëŒ€í•´ íƒœê·¸ë¥¼ í‘œí˜„í•´ì£¼ëŠ” ê²ƒì´ NERì´ë‹¤.      
![image](https://user-images.githubusercontent.com/76824611/180602458-33ad2484-759b-4d17-87e5-7ce210685240.png)


----

**[Simple NER]**    
* ê·¸ëŸ¼ ê°„ë‹¨í•œ NERë¡œ ì„¤ëª…ì„ ë” êµ¬ì²´ì ìœ¼ë¡œ í•´ë³´ì.     
* ì´ëŠ” binary logistic classifierë¥¼ ì´ìš©í•œ Window classificationì´ë‹¤.     
* **Idea**: ê° ë‹¨ì–´ë¥¼ ì¸ì ‘ ë‹¨ì–´ì˜ context windowì— ë¶„ë¥˜í•œë‹¤.      
  * windowì˜ ë‹¨ì–´ word vectors ì—°ê²°ì„ ê¸°ë°˜ìœ¼ë¡œ ê° í´ë˜ìŠ¤ì— ëŒ€í•´ ì¤‘ì‹¬ ë‹¨ì–´ {yes/no}ë¥¼ ë¶„ë¥˜í•˜ë„ë¡ ì†ìœ¼ë¡œ ë ˆì´ë¸”ë§ëœ ë°ì´í„°ì— ëŒ€í•œ logistic classifier êµìœ¡     
  * ì‚¬ì‹¤, ìš°ë¦¬ëŠ” ë³´í†µ multi-class softmaxë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ê·¸ê²ƒì„ ë‹¨ìˆœí•˜ê²Œ ìœ ì§€í•˜ë ¤ê³  ë…¸ë ¥í•˜ê³  ìˆë‹¤.(ì´ì§„ ë¶„ë¥˜ê¸°ë¡œ!)     
* **ê³¼ì •:**      
  * **1)** ê° ë‹¨ì–´ ëª¨ë‘ ì•„ë˜ì™€ ê°™ì€ ê³¼ì •ì„ ë°˜ë³µí•˜ëŠ”ë° ì§€ê¸ˆì€ â€œParisâ€ ì°¨ë¡€ë¼ê³  ê°€ì •í•´ë³´ì       
  * **2)** ì£¼ìœ„ì— **window**ë¥¼ ë§Œë“ ë‹¤.       
  * **3)** 5ë‹¨ì–´ì— ëŒ€í•´ word2vecì´ë‚˜ Gloveë¥¼ í†µí•´ **ë‹¨ì–´ ë²¡í„°**ë¥¼ ì–»ëŠ”ë‹¤.      
  * **4)** targrt ë‹¨ì–´(â€œParisâ€)ê°€ ì¤‘ê°„ì— ì˜¤ë„ë¡ 5ê°œì˜ **ë‹¨ì–´ ë²¡í„°ë¥¼ ì—°ê²°**í•˜ì—¬ ê¸´ ë²¡í„°ë¥¼ ë§Œë“¤ ê²ƒì´ë‹¤.           
  * **5)** ê·¸ëŸ¬ê³  ë‚˜ì„œ ì´ë ‡ê²Œ ë§Œë“  ë²¡í„°ë¥¼ **classifierì— ë„£ìœ¼ë©´** classifierëŠ” ë‹¨ì–´ê°€ ìœ„ì¹˜ë  í™•ë¥ ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.    
  * **6)** ì¦‰ ê·¸ ê²°ê³¼ ë‹¨ì–´ê°€ "ìœ„ì¹˜(Parisë‹ˆê¹Œ)"ì¼ í™•ë¥ ì„ ë§í•˜ëŠ” **ë¶„ë¥˜ê¸° íšë“**ì´ ê°€ëŠ¥í•˜ë‹¤.       
  * **7)** ì´ëŸ¬í•œ ê³¼ì • ëª¨ë“  ë‹¨ì–´ì— ì ìš©í•˜ì—¬ ê° ë‹¨ì–´ì— ëŒ€í•´ **í‰ê°€ë¥¼ ì§„í–‰**í•œë‹¤
window ê¸¸ì´ê°€ 2ì¸ ë¬¸ì¥ì—ì„œ â€œParisâ€ë¥¼ **+(ë§ëŠ” ìë¦¬)/-(í‹€ë¦° ìë¦¬)** ìœ„ì¹˜ë¡œ ë¶„ë¥˜:      
![image](https://user-images.githubusercontent.com/76824611/180617707-b104c32f-0db8-41b8-b459-943715cda69a.png)


----

**[NERì˜ ì“°ì„]**    
* ìì—°ì–´ ì²˜ë¦¬ë¥¼ ì´ìš©í•œ ì •ë³´ ê²€ìƒ‰ê³¼ ìš”ì•½    
* ì§ˆë¬¸ ë‹µë³€    
* ì§€ì‹ base build     
* ê¸°ê³„ ë²ˆì—­    
* ì¦‰, ëª…ì‚¬ë¥¼ ì˜ëª»ëœ íƒœê·¸ë¡œ ë¶„ë¥˜í•˜ë©´ ë²ˆì—­ ì„±ëŠ¥ì´ ë‚˜ë¹ ì§ˆ ìˆ˜ ìˆëŠ”ë° (HOT DOGë¥¼ ìŒì‹ì´ ì•„ë‹Œ ë™ë¬¼ë¡œ ë¶„ë¥˜í•˜ë©´ í•´ì„ì´ ì´ìƒí•´ì§„ë‹¤.) ì´ë¥¼ ë°©ì§€í•´ ì¤€ë‹¤.     

-----

**[NERì˜ ê³„ì‚°]**    
* NERì€ center wordì˜ ìœ„ì¹˜ì— ëŒ€í•œ ì´ì§„ ë¶„ë¥˜(+/-)ì´ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.    
* **ëª©ì :** ì ì ˆí•œ ìœ„ì¹˜ì— ìˆì„ë•Œ ë†’ì€ ì ìˆ˜ë¥¼ ë‚´ëŠ” supervised trainingì„ í•  ê²ƒì´ë‹¤.    
* **ê³„ì‚° ê³¼ì •:**    
   * **1)** $$x(input)$$:    
      * $$x$$ëŠ” ì¤‘ì‹¬ ë‹¨ì–´ì¸ $$x_{Paris}$$ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ window sizeê°€ 2ì¸ ë²¡í„°ì´ë‹¤.        
      * ì´ˆê¸° ë²¡í„°ëŠ” ì„ì˜ì˜ ìˆ«ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì±„ì ë‹¨ì–´ê°€ í•´ë‹¹ ìœ„ì¹˜ì¼ í™•ë¥  ë³€í™˜         
   * **2)** $$h = f(W$$**$$x$$**$$+b)$$:    
      * ìœ„ì˜ $$x(input)$$ì„ ì‹ ê²½ë§ ë ˆì´ì–´ì— ë„£ëŠ”ë‹¤. ê·¸ ê²°ê³¼ ë°€ì§‘ ë²¡í„°(ì •ë³´ê°€ ì¶”ê°€ëœ ë²¡í„°)ê°€ ëœë‹¤.        
      * $$W$$: ì‹ ê²½ë§ì—ì„œ í•™ìŠµí•  ë‹¨ì–´ì˜ ê°€ì¤‘ì¹˜ë¥¼ ê³±í•¨     
      * $$b$$: ë‹¨ì–´ë¥¼ ë³´ì •í•´ì¤„ biasë¥¼ ë”í•¨    
      * $$f$$: logistic, tanh, ReLUì™€ ê°™ì€ non-linear function í™œì„±í™” í•¨ìˆ˜       
      * $$h$$: ê·¸ ê²°ê³¼ ì‹ ê²½ë§ ì•ˆì˜ ì€ë‹‰ë²¡í„°ê°€ ëœë‹¤.     
   * **3)** $$s = u^{T}$$**$$h$$**:     
      * ì¶”ê°€ ë²¡í„°ì™€ ë‚´ì í•œë‹¤     
      * $$s$$: í•˜ë‚˜ì˜ ìˆ«ìë¡œ ì„ì˜ì˜ ìˆ«ìì¼ ìˆ˜ ìˆë‹¤, ì¦‰ ì ìˆ˜(score)ì´ë‹¤.    
   * **4)** $$ J_t(ğœƒ)$$ = **ğœ(s) = $$ \frac{1}{1+e^{-s}} $$**:     
      * ìŒìˆ˜ ìƒ˜í”Œë§í•  ë•Œ ë´¤ë˜ ê²ƒê³¼ ê°™ì´ ê°™ì€ ì¢…ë¥˜ì˜ logisitc ë³€í™˜                      
      *  $$ J_t(ğœƒ)$$: predicted model probability of class      
      *  **logisitc ë³€í™˜**: ì•„ë˜ì˜ ê·¸ë˜í”„ì™€ ê°™ì´ sì˜ ê°’ì— ë”°ë¼  1ì´ë‚˜ 0ì— ê·¼ì‚¬í•œ ê·¹ë‹¨ì ì¸ ê°’ìœ¼ë¡œ ì´ì§„ ë¶„ë¥˜ë¨     
      ![image](https://user-images.githubusercontent.com/76824611/180619417-dd27d84b-ca95-4ff6-ae0b-fc410e963a2a.png)
   * **5)** ì¶œë ¥ì€ íŠ¹ì • í´ë˜ìŠ¤ì— ë‹¨ì–´ê°€ ì†í•  ì˜ˆì¸¡ í™•ë¥     
   * **6)** ì´ ì¶œë ¥ì„ ì§„ì§œ ì •ë‹µê³¼ ë¹„êµí•˜ì—¬ ìœ„ì¹˜ ë‹¨ì–´ì¼ í™•ë¥ ì— ëŒ€í•´ windowì˜ ê° ë‹¨ì–´ë¥¼ ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ìœ„ì¹˜ ë¶„ë¥˜ê¸°ê°€ ë  ìˆ˜ ìˆìŒ      ![image](https://user-images.githubusercontent.com/76824611/180620836-165a07a3-f1c6-48b1-bf46-e7dcd969950d.png)



<details>
<summary>ğŸ“œ Remember: Stochastic Gradient Descent</summary>
<div markdown="1">
  
**[SGD]**    
í˜„ì¬ ì†ì‹¤ì„ ê¸°ë°˜ìœ¼ë¡œ ì—…ë°ì´íŠ¸    
* ì•ì˜ ì‹ì—ì„œ ì§„ì§œë©´ 1    
* ì•ì˜ ì‹ì—ì„œ ì§„ì§œê°€ ì•„ë‹ˆë©´ 0      
 
ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹ ê²½ë§ì„ í›ˆë ¨ì‹œí‚¤ë©´ ë§¤ê°œë³€ìˆ˜ì˜ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆì–´ì•¼ í•¨     
â¡ ì´ëŸ¬ë©´ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ê³ , ëª¨ë¸ì„ íš¨ìœ¨ì ìœ¼ë¡œ í›ˆë ¨í•  ìˆ˜ ìˆìŒ     
â¡ ì¢‹ì€ ê°€ì¤‘ì¹˜ëŠ” ì •í™•ë„ê°€ ë†’ìŒ      
 
ì•„ë˜ ì‹ì€ ì—…ë°ì´íŠ¸ ë°©ì •ì‹,     
* í™•ë¥ í•¨ìˆ˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì†ì‹¤ì„ ìµœì†Œí™” í•˜ë„ë¡ ê³„ì† ğœƒ ê°’ì„ ì—…ë°ì´íŠ¸ í•´ë‚˜ê°„ë‹¤.        
![image](https://user-images.githubusercontent.com/76824611/180619888-c591e511-4655-4d73-95a6-35e021e7f90b.png)

$$âˆ‡_{ğœƒ}J(ğœƒ)$$ì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„ ,     
* ì†ìœ¼ë¡œ ê³„ì‚° í•  ìˆ˜ ìˆë‹¤     
* ê·¸ë¦¬ê³  backpropagation algorithmì„ ì´ìš©í•˜ì—¬ ê³„ì‚°ê°€ëŠ¥í•˜ë‹¤ â¡ ì´ê±¸ ë°°ìš¸ ê²ƒì´ë‹¤
 
 
</div>
</details>  


ì•„ë˜ëŠ” ê°•ì˜ì—ëŠ” ì–¸ê¸‰ë˜ì—ˆì§€ ì•Šì§€ë§Œ ìŠ¬ë¼ì´ë“œì— ìˆì–´ì„œ ê´€ì—° ì •ë¦¬ ë‚´ìš©ì„ ë§í¬ ê±¸ì–´ë’€ë‹¤.     
â• ì¶”ê°€: [Neural classification](https://yerimoh.github.io/DLCS31/)      
â• ì¶”ê°€: [cross entropy loss](https://yerimoh.github.io/DL3/#%EA%B5%90%EC%B0%A8-%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC-%EC%98%A4%EC%B0%A8cross-entropy-error-cee)     
â• ì¶”ê°€: [Non-linearities (i.e., â€œf â€ on previous slide): Why theyâ€™re needed](https://yerimoh.github.io/DL201/#%EA%B0%9C%EC%84%A0-regularization)






<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180602482-bcf4d530-417b-4d2e-a638-ac2ae8650153.png)
![image](https://user-images.githubusercontent.com/76824611/180602496-3ca42484-bd11-49ca-a72e-48346991066a.png)
![image](https://user-images.githubusercontent.com/76824611/180618475-fcc28a71-ec17-4bd7-a009-269a7d2d2622.png)
![image](https://user-images.githubusercontent.com/76824611/180618484-a0e740d1-3730-4a5a-b17c-102dec9dcd87.png)
![image](https://user-images.githubusercontent.com/76824611/180619590-9713b4f1-c154-4d38-af66-9eae254b7fb8.png)
![image](https://user-images.githubusercontent.com/76824611/180619682-79d5c72c-1b45-4728-b185-5ed08d1e0916.png)
![image](https://user-images.githubusercontent.com/76824611/180619970-d3f97978-53f7-4eef-819e-d87cce3cc72b.png)

  
</div>
</details>



----
-----


# **Introduction** 
ë“¤ì–´ê°€ê¸° ì „ì— ë¯¸ë¶„ì˜ ì˜ë¯¸ì— ëŒ€í•´ ì§ê´€ì ìœ¼ë¡œ íŒŒì•…í•´ë³´ì.     



---


## Gradients

**[Basic ì˜ë¯¸]**    
* $$f(x) = x^{3}$$ì™€ ê°™ì€ ë°©ì •ì‹ì´ ìˆë‹¤ê³  í•´ë³´ì     
   * $$f(x)$$: 1 output      
   * $$x^{3}$$: 1 input    
* **ë¯¸ë¶„(Gradients)**     
   * $$ \frac{df}{dx} $$ $$= 3x^{2}$$: ìœ„ì˜ ì‹ì„ ë¯¸ë¶„í•œ ê²ƒì´ë‹¤  
   * ì´ ë¯¸ë¶„ê°’ì˜ ì˜ë¯¸ëŠ” xê°€ 1ì¼ ë•Œ ì…ë ¥ì„ ì¡°ê¸ˆë§Œ ì›€ì§ì´ë©´ ì¶œë ¥ì´ 3ë°°ë§Œí¼ ë³€í•œë‹¤ëŠ” ê²ƒì´ë‹¤         
   * ex1) At x = 1 it changes about 3 times as much: 1.013 = 1.03    
   * ex2) At x = 4 it changes about 48 times as much: 4.013 = 64.48     


**[ë³µì¡í•œ ì‹ì— ì ìš©]**    
* ê·¸ëŸ¼ ì´ë²ˆì—” ìœ„ì˜ ë¯¸ë¶„ì˜ ì˜ë¯¸ë¥¼ ë˜ìƒˆê²¨ ì¡°ê¸ˆ ë” ë³µì¡í•œ ì‹ì˜ ì˜ë¯¸ë¥¼ ì°¾ì•„ë³´ì      
* $$f(x) = f(x_1, x_2, ... , x_n)$$ê³¼ ê°™ì€ ë°©ì •ì‹ì´ ìˆë‹¤ê³  í•´ë³´ì.     
   * $$f(x)$$: 1 output      
   * $$f(x_1, x2, ... , x_n)$$: n input   
* **ë¯¸ë¶„(Gradients)**     
   * $$ \frac{âˆ‚f}{âˆ‚x} = $$ $$ ( \frac{âˆ‚f}{âˆ‚x_1},  \frac{âˆ‚f}{âˆ‚x_2},  \frac{âˆ‚f}{âˆ‚x_n} )$$: ìœ„ì˜ ì‹ì„ ë¯¸ë¶„í•œ ê²ƒì´ë‹¤      
   * ê¸°ìš¸ê¸°ëŠ” ê° ì…ë ¥ì— ëŒ€í•œ í¸ë„í•¨ìˆ˜ì˜ ë²¡í„°ì´ë‹¤      
   * ìš°ë¦¬ëŠ” $$x_1$$ì—ì„œ $$x_n$$ê¹Œì§€ nê°œì˜ ì…ë ¥ì„ ì–»ì—ˆê³ ,       
   $$x_1$$ì— ëŒ€í•œ $$f$$ì˜ í¸ë„í•¨ìˆ˜, $$x_2$$ì— ëŒ€í•œ $$f$$ì˜ í¸ë„í•¨ìˆ˜ ë“±ì„ ê³„ì‚°í•œ ë‹¤ìŒ í¸ë„í•¨ìˆ˜ì˜ ë²¡í„°ë¥¼ ì–»ëŠ”ë‹¤.        
   * ì´ ë²¡í„°ì˜ ê° ìš”ì†ŒëŠ” í•˜ë‚˜ì˜ ë³€ìˆ˜ì— ëŒ€í•œ ë‹¨ìˆœ ë„í•œìˆ˜ì™€ ê°™ë‹¤.      



<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180620017-c558efda-fb41-4346-9efb-c4793db461d4.png)
![image](https://user-images.githubusercontent.com/76824611/180620023-7eeac476-101e-4d59-b269-d242ebc10a65.png)
![image](https://user-images.githubusercontent.com/76824611/180621660-233b4873-3c57-4517-a984-2c682e22ee3a.png)
![image](https://user-images.githubusercontent.com/76824611/180621669-24d18c64-4178-4ab1-9035-34bf54299e07.png)

  
</div>
</details>



-----

## Jacobian Matrix
Gradientë¥¼ ì¼ë°˜í™” í•˜ëŠ” ê²ƒì´ë‹¤.     

**[ë” ë³µì¡í•œ ì‹ì— ì ìš©]**    
* ê·¸ëŸ¼ ìœ„ì˜ ë¯¸ë¶„ ì˜ ì´í•´ì‹ì—ì„œ ë”  ë³µì¡í•œ ì‹ì— ì ìš©í•´ë³´ì.    
* $$f(x) = f_1(x_1, x_2, ... , x_n), ..., f_m(x_1, x_2, ... , x_n)$$ê³¼ ê°™ì€ ë°©ì •ì‹ì´ ìˆë‹¤ê³  í•´ë³´ì.     
   * $$f_1, ..., f_m$$: m output      
   * $$f(x_1, x2, ... , x_n)$$: n input   
* **ìœ„ ì‹ì˜ ì ìš©**    
   * ì¼ë°˜ì ìœ¼ë¡œ ì‹ ê²½ë§ì— ë ˆì´ì–´ì™€ ê°™ì€ ê²ƒì´ ìˆì„ ë•Œ,   
   nê°œì˜ ì…ë ¥ ë‚´ì— ë‹¨ì–´ ë²¡í„°ì™€ ê°™ì€ í•¨ìˆ˜ê°€ ìˆê³ , í–‰ë ¬ì„ ê³±í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•œ mê°œì˜ ì¶œë ¥ì„ ê°–ê²Œ ë¨    
   * ì´ì œ nê°œì˜ ì…ë ¥ì„ ë°›ê³  mê°œì˜ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ê°€ ìƒì„±ëœë‹¤    
   ë”°ë¼ì„œ **ì´ ì‹œì ì—ì„œ ê¸°ìš¸ê¸°ì— ëŒ€í•´ ê³„ì‚°**í•˜ëŠ” ê²ƒì„ Jacobian Matrixë¼ê³  í•œë‹¤.    
* **ë¯¸ë¶„(Gradients)**     
   * ìœ„ì˜ ì‹ì„ ë¯¸ë¶„í•œ ê²ƒì´ë‹¤      
   * ì´ ë¯¸ë¶„ì˜ ê²°ê³¼ëŠ” í¸ë„í•¨ìˆ˜ì˜ **ëª¨ë“  ì¡°í•©**ì— ëŒ€í•œ **m x n í–‰ë ¬**ì´ë‹¤.    
      * ë”°ë¼ì„œ í•¨ìˆ˜ $$f$$ëŠ” ê°ê° mê°œì˜ ì¶œë ¥ì„ ìƒì„±í•˜ëŠ” $$f_1$$ì—ì„œ  $$f_m$$ê¹Œì§€ì˜ ì„œë¡œ ë‹¤ë¥¸ **í•˜ìœ„ í•¨ìˆ˜ë¡œ ë¶„í• **ë¨      
      * ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” $$x_1$$ì— ëŒ€í•œ $$f_1$$ì˜ í¸ë„í•¨ìˆ˜ë¥¼, $$x_n$$ì— ëŒ€í•œ $$f_1$$ì˜ í¸ë„í•¨ìˆ˜ë¥¼ í†µí•´ ì·¨í•œë‹¤.    
   * ì…ë ¥ë³€ìˆ˜ ì¤‘ í•˜ë‚˜ì— ëŒ€í•´ **ì¶œë ¥ë³€ìˆ˜ì˜** **ê°€ëŠ¥í•œ ëª¨ë“  í¸ë¯¸ë¶„**ì„ ê°–ëŠ”ë‹¤.    
   ![image](https://user-images.githubusercontent.com/76824611/180621565-5b97d03d-e016-4400-bc76-edecfa1425b2.png)

   * ê¸°ìš¸ê¸°ëŠ” ê° ì…ë ¥ì— ëŒ€í•œ í¸ë„í•¨ìˆ˜ì˜ ë²¡í„°ì´ë‹¤      
   * ìš°ë¦¬ëŠ” $$x_1$$ì—ì„œ $$x_n$$ê¹Œì§€ nê°œì˜ ì…ë ¥ì„ ì–»ì—ˆê³ ,       
   $$x_1$$ì— ëŒ€í•œ $$f$$ì˜ í¸ë„í•¨ìˆ˜, $$x_2$$ì— ëŒ€í•œ $$f$$ì˜ í¸ë„í•¨ìˆ˜ ë“±ì„ ê³„ì‚°í•œ ë‹¤ìŒ í¸ë„í•¨ìˆ˜ì˜ ë²¡í„°ë¥¼ ì–»ëŠ”ë‹¤.        
   * ì´ ë²¡í„°ì˜ ê° ìš”ì†ŒëŠ” í•˜ë‚˜ì˜ ë³€ìˆ˜ì— ëŒ€í•œ ë‹¨ìˆœ ë„ìˆ˜ì™€ ê°™ë‹¤.    



â• ì´í•´ê°€ í˜ë“¤ë‹¤ë©´ ì´ ë§í¬ë¥¼ ëˆŒëŸ¬ [Jacobian Matrix](https://angeloyeo.github.io/2020/07/24/Jacobian.html)ì„ ì´í•´í•´ë³´ê³  ì˜¤ëŠ”ê±¸ ì¶”ì²œí•œë‹¤     






<details>
<summary>ğŸ“œ Chain Rule</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180621756-3aa44c8b-d5a9-4f28-a8dc-936bb01f972a.png)
 
 
</div>
</details> 


<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180621682-965e5681-acb6-4c09-87ca-b8053aa8d0b3.png)
![image](https://user-images.githubusercontent.com/76824611/180621761-6c40e412-51cc-4e1d-814d-49352dc12b78.png)

  
</div>
</details>

------

## Example Jacobian
ìš”ì†Œë³„ activation í•¨ìˆ˜ì— ì ìš©í•´ ë³¼ ê²ƒì´ë‹¤.     

**[ëª©í‘œ]**      
* $$h = f(z)$$ ì¼ ë•Œ, $$ \frac{âˆ‚h}{âˆ‚z} $$ êµ¬í•˜ê¸°    
  * $$h,z âˆˆ â„^n$$: $$h,z$$ëŠ” ëª¨ë‘ ì‹¤ìˆ˜ì´ë‹¤     
  * $$f(z)$$: ë¹„ì„ í˜•ë²¡í„°    
  * ì´ í•¨ìˆ˜ëŠ” n outputs and n inputs â¡ **n by n Jacobian**      


**[ê³„ì‚°]**    
* ë¨¼ì € Jacobianì˜ ì •ì˜ë¥¼ ë³´ì.    
  * ê° ì…ë ¥ì— ê°œí•´ ê° ì¶œë ¥ì˜ í¸ë„í•¨ìˆ˜ë¥¼ ì¶”ì •í•˜ëŠ” ê²ƒì´ë‹¤.      
  ![image](https://user-images.githubusercontent.com/76824611/180627481-74e3d85c-e80d-4f0a-8696-db5afe19bd3a.png)
* regular 1-variable derivative    
  * i=jê°€ ì•„ë‹Œ ì…ë ¥ì€ ì¶œë ¥ì— ì•„ë¬´ëŸ° ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤.     
  ![image](https://user-images.githubusercontent.com/76824611/180627484-9a9d9613-7f5e-4c8b-b5fc-6116fbabf54d.png)
* ê·¸ë ‡ë‹¤ë©´ $$ \frac{âˆ‚h}{âˆ‚z} $$ëŠ”,     
  * ëŒ€ê°ì„ ì´ i=jì´ë¯€ë¡œ ì´ ì™¸ì˜ ë‚˜ë¨¸ì§€ëŠ” ë‹¤ 0ì´ë‹¤.    
  * ì´ëŠ” ë‹¨ìœ„í–‰ë ¬ì˜ í˜•íƒœì´ë‹¤.       
  ![image](https://user-images.githubusercontent.com/76824611/180627515-88851021-a446-40cd-8a0b-f64043cfc930.png)







<details>
<summary>ğŸ“œ ë‹¨ìœ„í–‰ë ¬? </summary>
<div markdown="1">
  
ì„ í˜•ëŒ€ìˆ˜í•™ì—ì„œ, ë‹¨ìœ„ í–‰ë ¬(ì˜ì–´: unit matrix) ë˜ëŠ” í•­ë“± í–‰ë ¬(ì˜ì–´: identity matrix)ì€ ì£¼ëŒ€ê°ì„ ì˜ ì›ì†Œê°€ ëª¨ë‘ 1ì´ë©° ë‚˜ë¨¸ì§€ ì›ì†ŒëŠ” ëª¨ë‘ 0ì¸ ì •ì‚¬ê° í–‰ë ¬ì´ë‹¤.
 
 
 ![image](https://user-images.githubusercontent.com/76824611/180627971-1275e2b8-1406-47df-a8ce-76a52742ea36.png)
![image](https://user-images.githubusercontent.com/76824611/180627972-de3c099f-8aa2-4f05-a1fd-560f95f5509e.png)

 
 ì¶œì²˜: [ìœ„í‚¤ë°±ê³¼](https://ko.wikipedia.org/wiki/%EB%8B%A8%EC%9C%84%ED%96%89%EB%A0%AC#:~:text=%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%EC%97%90%EC%84%9C%2C%20%EB%8B%A8%EC%9C%84%20%ED%96%89%EB%A0%AC,0%EC%9D%B8%20%EC%A0%95%EC%82%AC%EA%B0%81%20%ED%96%89%EB%A0%AC%EC%9D%B4%EB%8B%A4.)
 
</div>
</details> 

**[Other Jacobians]**     
* ê·¸ëŸ¼ ìœ„ì˜ ì‹ì„ ì ìš©í•´ì„œ ì•„ë˜ì˜ ì‹ì„ ë³´ì   
  * ì•„ë˜ì˜ ì‹ì—ë‹¤ê°€ Jacobian í–‰ë ¬ì‹ì„ ì ìš©í•  ê²ƒì´ë‹¤.       
  ![image](https://user-images.githubusercontent.com/76824611/180627910-df53ed7a-f0ff-47b0-8290-c0cfe6e453ab.png)
  * ì•„ë˜ì™€ ê°™ì´ ì ìš©í•œ ê²°ê³¼, ë‹¨ìœ„í–‰ë ¬ì´ ë‚˜ì˜¨ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤(ìœ„ì—ì„œ ì„¤ëª…í–ˆë‹¤)   
  ![image](https://user-images.githubusercontent.com/76824611/180627930-7acb3575-7964-4627-9c57-f9830dbd7a13.png)
  * hì˜ ì…ë ¥ì°¨ì›ì´ ìˆê³  í•˜ë‚˜ì˜ ì¶œì—­ì´ìˆìœ¼ë¯€ë¡œ í–‰ë²¡í„°ë¥¼ ìœ„í•´ uë¥¼ transposeí•œë‹¤(ì¶”í›„ ìì„¸íˆ ì„¤ëª…)
  ![image](https://user-images.githubusercontent.com/76824611/180627951-740a5b8e-f3e6-49b1-ad0a-156907adf6ab.png)




<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180628007-341d986d-e62b-4c5d-bcf4-d21e0712c9fe.png)
![image](https://user-images.githubusercontent.com/76824611/180628014-c8a7b3af-1c47-4aaa-977c-f0d5b826c27a.png)
![image](https://user-images.githubusercontent.com/76824611/180628020-e2067ce1-38b7-42fd-a264-9d1bfcc5f5a4.png)
![image](https://user-images.githubusercontent.com/76824611/180628025-f14284ea-7f16-4301-a34b-7eb5245ed98f.png)
![image](https://user-images.githubusercontent.com/76824611/180628028-09fce1c3-6900-4833-9cf7-19cc7dbdd79f.png)

  
</div>
</details>



-------
-------


# **Matrix calculus** 
ê·¸ëŸ¼ ìœ„ì— ë°°ìš´ ë‚´ìš©ë“¤ì„ ì•„ê¹Œ ë°°ìš´ Neural Netì— ì ìš©í•´ë³´ì    


---


## Back to our Neural Net

**[ëª©í‘œ]**    
* ë³€ìˆ˜ê°€ W, b, uê°€ ë˜ëŠ” ì´ ëª¨ë¸ì˜ ë‹¤ë¥¸ ë§¤ê°œë³€ìˆ˜ì— ëŒ€í•œ ì‹¤ìˆ˜ì¸ ì ìˆ˜ sì˜ í¸ë„í•¨ìˆ˜ë¥¼ ê³„ì‚°í•  ê²ƒì´ë‹¤.     
* ë¨¼ì € **í¸í–¥ bì˜ gradient**ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ê³„ì‚°í•  ê²ƒì´ë‹¤.     
* ì´ ì ìˆ˜ë¥¼ ë„ì¶œí•˜ëŠ” ì‹ë“¤ì„ ê³„ì‚°í•˜ê¸° ì „ì— **ê³„ì‚°ì„ ê°„ë‹¨í•˜ê²Œ í•˜ëŠ” ë°©ë²•**ì„ ì‚´í´ë³¼ ê²ƒì´ë‹¤.      
* ê³„ì‚°ì„ ê°„ë‹¨í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„  ì‹ë“¤ì„ ë¶„í•´í•´ì•¼ í•œë‹¤.    
![image](https://user-images.githubusercontent.com/76824611/180639046-2e8e949e-abe8-430f-ba50-62eb7cc9495c.png)



1ï¸âƒ£ **Break up equations into simple pieces**
* ì•„ë˜ì™€ ê°™ì´ ì‹ì„ ì¡°ê·¸ë§Œ ì¡°ê°ìœ¼ë¡œ ì¡°ê°ë‚´ê³  ê° ì°¨ì›ì´ ë­”ì§€ ê³„ì‚°í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.      
![image](https://user-images.githubusercontent.com/76824611/180639365-bea316ea-ea12-470f-8762-3979cde07ebf.png)


2ï¸âƒ£ **Apply the chain rule**      
* ê·¸ ë‹¤ìŒ ìœ„ì—ì„œ ë°°ìš´ chain ruleì„ ì ìš©í•˜ì—¬ ì‹ì„ ë” ì‘ê²Œ ë¶„í• í•œë‹¤.       
* ê° ë¶„í• ëœ ì‹ì€ ê°™ì€ ìƒ‰ì˜ ë„¤ëª¨ë¡œ í‘œì‹œí–ˆë‹¤.     
![image](https://user-images.githubusercontent.com/76824611/180640088-fd5a0ae2-c1d7-4c4a-914c-ee7a29993ade.png)


3ï¸âƒ£ **Write out the Jacobians**     
* **Jacobians ì‚¬ìš©**     
  * ê·¸ëŸ¼ ìœ„ì—ì„œ ë°°ìš´ì‹ì„ ê·¸ëŒ€ë¡œ ì ìš©í•˜ì—¬ ë¶„í• í•œ ì‹ì„ ì¹˜í™˜í•œë‹¤.    
  * ì—¬ê¸°ì„œ [diag()](https://kr.mathworks.com/help/matlab/ref/diag.html)ëŠ” **ëŒ€ê°í–‰ë ¬**ìœ¼ë¡œ ë‹¨ìœ„í–‰ë ¬ê³¼ ê°™ì´ ëŒ€ê°ì„ ì—ë§Œ 0ì´ ì•„ë‹Œ ê°’ë“¤ì´ ìˆì§€ë§Œ ë‹¨ìœ„í–‰ë ¬ê³¼ ë‹¬ë¦¬ ëŒ€ê° ì„±ë¶„ë“¤ì´ 1ì´ ì•„ë‹Œ ë‹¤ë¥¸ ìˆ˜ì´ë‹¤.       
  ![image](https://user-images.githubusercontent.com/76824611/180640297-13b38c92-7070-4be3-83f9-6e05713c1f75.png)
* **ë³€í˜•**   
  * **â‘ ** $$diag(f'(z))I = f'(z)$$ê°€ ì„±ë¦½í•œë‹¤. ì´ìœ ëŠ” ë°‘ì— ìì„¸íˆ ì„¤ëª…í•´ë‘ì—ˆë‹¤.      
  * **â‘¡** ë˜í•œ âŠ™ëŠ” ì•„ë‹¤ë§ˆë¥´ê³±(Hadamard product)ìœ¼ë¡œ ì´ ë˜í•œ ë°‘ì— ìì„¸íˆ ì„¤ëª…ì„ í•´ë‘ì—ˆë‹¤.     
  * ìœ„ì˜ ë‘ ê³µì‹ì´ ì ìš©ë˜ì–´ ì¹˜í™˜í•œ ì‹ì„ ì•„ë˜ì™€ ê°™ì´ ë³€í˜•ì‹œí‚¬ ìˆ˜ ìˆë‹¤.     
  ![image](https://user-images.githubusercontent.com/76824611/181449725-04761e44-fa0f-446e-b0f8-8ac3b70271dd.png)
 



<details>
<summary>ğŸ“œ â‘  $$diag(f'(z))I = f'(z)$$</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180640619-5677ba23-f36d-4769-ab82-1bd225d39b16.png)
[ì¶œì²˜](https://mathbang.net/565)
 
 
</div>
</details> 



<details>
<summary>ğŸ“œ â‘¡  ì•„ë‹¤ë§ˆë¥´ê³±(Hadamard product) </summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180640670-195ece9b-a1f8-4ef9-8d76-13abb0558122.png)
[ì¶œì²˜]([https://mathbang.net/565](https://namu.wiki/w/%ED%96%89%EB%A0%AC%EA%B3%B1))
 
 
</div>
</details> 





<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180640848-0b0ef210-9c0a-40f2-987f-25ebed3293cc.png)
![image](https://user-images.githubusercontent.com/76824611/180640852-12c8ac12-84f0-4eff-a115-0ff862e9dbdb.png)
![image](https://user-images.githubusercontent.com/76824611/180640854-15546387-d8d2-4561-840a-e5dc47bcafc4.png)
![image](https://user-images.githubusercontent.com/76824611/180640857-c240406e-415d-451a-bf91-573b9976f775.png)
![image](https://user-images.githubusercontent.com/76824611/180640865-6029671a-4b31-4bd3-9de0-c5c2b0eddc89.png)
![image](https://user-images.githubusercontent.com/76824611/180640869-2eec3eae-5e72-4b76-adc6-adf851cba854.png)
![image](https://user-images.githubusercontent.com/76824611/180640880-25f9b7ff-c9f0-442b-9c74-18f22d8a73f7.png)
![image](https://user-images.githubusercontent.com/76824611/180640891-4eee696e-c00d-46a0-b923-63abb93f5d74.png)
![image](https://user-images.githubusercontent.com/76824611/180640895-ea25ff56-8a2a-4883-92b5-c4def2e27b6f.png)

  
</div>
</details>



------


## Re-using Computation

**[ê°€ì¤‘ì¹˜ W ê³„ì‚°]**      
* **ì‹ ì •ì˜**    
  * ìœ„ì—ì„œëŠ” í¸í–¥ bë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì´ì—ˆë‹¤.    
  * ê·¸ëŸ¼ ê°€ì¤‘ì¹˜ Wë„ ë§ˆì°¬ê°€ì§€ë¡œ ê³„ì‚°í•˜ë©´ ëœë‹¤.   
  * ì¦‰ ëª©í‘œëŠ” $$ \frac{âˆ‚s}{âˆ‚W} $$ ë¡œ ì ìˆ˜ì— ê°€ì¤‘ì¹˜ê°€ ë¯¸ì¹˜ëŠ” ì˜í–¥ì˜ ì •ë„ ê³„ì‚°ì´ë¼ê³  ë³´ë©´ ëœë‹¤.     
  â¡ ëª©í‘œ ì‹ì˜ ë¶„ëª¨ê°€ $$âˆ‚W$$ì´ë¯€ë¡œ ë§ˆì§€ë§‰ í•­ë§Œ ë‹¤ë¥´ë‹¤.    
  * **íŒŒë€ìƒ‰ ë¶€ë¶„ì€ ê³µí†µ**ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.       
  â¡ ì¦‰ ì´ íŒŒë€ìƒ‰ ë¶€ë¶„ì„ ì¬ì‚¬ìš©í•˜ê¸° ìœ„í•´ ìœ„ì—ì„œ ë°°ìš´ ì •ë³´ë¥¼ í†µí•´ ì¼ë°˜í™” í•  ê²ƒì´ë‹¤.      
  ![image](https://user-images.githubusercontent.com/76824611/181446441-78e88d33-68c5-416f-819b-a29acb583661.png)
* **$$ğ›¿$$ ì¹˜í™˜**
  * $$ğ›¿$$: ì´ ê¸°í˜¸ì˜ ì˜ë¯¸ëŠ”  local error signalì´ë‹¤.       
  * ìœ„ì˜ ê³µí†µëœ íŒŒë€ìƒ‰ ë¶€ë¶„ì„ $$ğ›¿$$ë¡œ ì¹˜í™˜í•˜ë©´ ì´ ì¹˜í™˜í•œ ë¶€ë¶„ì€ [Back to our Neural Net](#back-to-our-neural-net)ì— ì˜í•´ ì•„ë˜ì™€ ê°™ì´ ì¹˜í™˜ëœë‹¤.       
  * ì¦‰ Wì™€ b ëª¨ë‘ ê°™ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.      
  â¡ ë§ˆì§€ë§‰ ë‹¤ë¥¸ í•­ì€ ë‹¨ìœ„ í–‰ë ¬ì´ë¼ ê³„ì‚°ì— ì˜í–¥ì„ ì£¼ì§€ ëª»í•˜ë¯€ë¡œ    
  ![image](https://user-images.githubusercontent.com/76824611/181446277-4804d002-4015-4d4e-a482-25e22ff38295.png)


<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180641894-103d87b1-74f9-4905-b686-b47d08be209d.png)
![image](https://user-images.githubusercontent.com/76824611/180641903-7c426201-3fb2-40cf-9b7d-6a43f85bba25.png)
![image](https://user-images.githubusercontent.com/76824611/180641909-13117b48-c495-4597-ab3f-1fbc571f5d77.png)

  
</div>
</details>



------


## Output shape
ìœ„ì˜ ê³„ì‚° ê³¼ì •ì—ì„œ output shapeë¥¼ ì¡°ì •í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.    


í˜„ì¬ ì•„ë˜ ì‹ì— ë”°ë¥´ë©´ 1 output, nm inputsì´ë¯€ë¡œ,    
$$âˆ‡_{ğœƒ}J(ğœƒ)$$ëŠ” ```1 x n x m ```ì˜  shapeì„ ê°–ì€ ë§¤ìš° ê¸´ ë°€ë„ê°€ ë‚®ì€ ë²¡í„°ê°€ ì¶œë ¥ë  ê²ƒì´ë‹¤.     
ì´ë ‡ê²Œ **Jacobian í˜•ì‹ì€ chain ruleì„ ì‰½ê²Œ ë§Œë“¤ì§€ë§Œ ì´ëŠ” ê¸°ìš¸ê¸° ê³„ì‚°ì„ ìœ„í•œ SGDì˜ shape convention**ì— ìœ„ë°°ëœë‹¤.      
![image](https://user-images.githubusercontent.com/76824611/181445789-6cb11e31-2139-4e66-a163-dbda74655d21.png)


ê·¸ëŸ°ë°, $$ \frac{ds}{dW} $$ëŠ” ì ìˆ˜ë¼ëŠ” ì •ìˆ˜ í•˜ë‚˜ê°€ ì¶œë ¥ë˜ë¯€ë¡œ ìœ„ì˜ $$âˆ‡_{ğœƒ}J(ğœƒ)$$ì™€ ì—°ì‚°í•˜ì§€ ëª»í•œë‹¤.     
ì™œëƒí•˜ë©´ ê°™ì€ shapeì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.     
â¡ ê·¸ëŸ¬ë¯€ë¡œ ê³„ì‚°ì„ ìœ„í•´ **shape convention**ì— ë”°ë¼ **shapeì„ ë§ì¶°ì£¼ëŠ” ê²ƒ**ì´ ì¤‘ìš”í•˜ë‹¤.     

ì¦‰ ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ **shape convention**ì„ ì‚¬ìš©í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´  ```1 x n x m ``` shapeìœ¼ë¡œ ë°”ê¿”ì•¼ í•œë‹¤.   
â¡ ê·¸ ê²°ê³¼, ```shape of the gradient=  shape of the parameters```ê°€ ëœë‹¤.      
![image](https://user-images.githubusercontent.com/76824611/181445958-7abd5f16-860d-4f81-972c-8f50db98b272.png)



ê·¸ëŸ¼ ìœ„ì˜ ì‹ì„ ì•ì—ì„œ ë°°ì› ë˜ $$ğ›¿$$ë¡œ ë‚˜íƒ€ë‚´ì–´ ì ìš©í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.     
![image](https://user-images.githubusercontent.com/76824611/181446043-14607c7d-5bf2-42dc-ad0f-ae01015be1f8.png)



**[Deriving local input gradient in backprop]**      
* ì´ ì‹ì—ì„œ ì¤‘ìš”í•œ ê²ƒì€ $$W_{ij}$$ëŠ” ì˜¤ì§ $$z_i$$ì—ë§Œ ì˜í•­ì„ ì¤€ë‹¤ëŠ” ê²ƒì´ë‹¤.     
   * ex)  $$W_{23}$$ is only used to compute $$z_2$$ not $$z_1$$     
   ![image](https://user-images.githubusercontent.com/76824611/181445546-cff6915f-9ccf-4e19-ad3e-3da0befb24c4.png)
* ê·¸ëŸ¬ë¯€ë¡œ ì•„ë˜ ì‹ì—ì„œ ì˜í–¥ì„ ì£¼ëŠ” ì‹ë“¤ë§Œ ë‚¨ê¸°ê³ ,   
$$ \frac{âˆ‚}{âˆ‚W_{ij}} $$ëŠ” $$âˆ‚W_{ik}$$ ì™€ ìƒì‡„ë˜ì–´ 0ì´ë˜ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì€ ì‹ì´ ì„±ë¦½ëœë‹¤.    
![image](https://user-images.githubusercontent.com/76824611/180642579-8984606e-2906-482d-b8e9-819176272a0b.png)



**[derivativesë¥¼ ìœ„í•´ ì–´ë–¤ shapeì´ì–´ì•¼ í• ê¹Œ?]**    
* $$ \frac{âˆ‚s}{âˆ‚b} $$ = $$h^T$$ $$âŠ™  f'(z)$$ëŠ” í–‰(row)ë²¡í„°ì´ë‹¤.        
â¡ ê·¸ëŸ¬ë‚˜ **shape convention**ì— ì˜í•˜ë©´, bê°€ ì—´(column) ë²¡í„°ì´ê¸° ë•Œë¬¸ì— gradientë„ ì—´(column) ë²¡í„°ì—¬ì•¼ í•œë‹¤     
* Jacobian í˜•ì‹(ì²´ì¸ ê·œì¹™ì„ ì‰½ê²Œ ë§Œë“œëŠ” ê²ƒ)ê³¼ **shape convention**(SGDë¥¼ ì‰½ê²Œ êµ¬í˜„í•˜ëŠ” ê²ƒ) ê°„ì˜ ë¶ˆì¼ì¹˜       
â¡ ì¦‰ Jacobian formì€ ë‹µì„ ê³„ì‚°í•˜ëŠ” ë° ìœ ìš©í•˜ì§€ë§Œ **SGDë¥¼ ìœ„í•´** **shape convention**ì— ë§ì¶°ì¤˜ì•¼ í•œë‹¤.     
* **ë‘ ê°€ì§€ ì˜µì…˜:**     
   * **1.** Jacobian í˜•ì‹ì„ ìµœëŒ€í•œ ì‚¬ìš©í•˜ê³ , ë§ˆì§€ë§‰ì— shape conventionì„ ë”°ë¥´ë„ë¡ ëª¨ì–‘ì„ ë°”ê¿ˆ      
      * ìš°ë¦¬ê°€ ë°©ê¸ˆ í•œ ê²ƒì„. $$ğ›¿$$ ê¹Œì§„ Jacobian í˜•ì‹ì„ ì‚¬ìš©í•˜ë‹¤ê°€ ë§ˆì§€ë§‰ì— ë„í•¨ìˆ˜ë¥¼ ì—´ ë²¡í„°ë¡œ ë§Œë“¤ê¸° ìœ„í•´ ì „ì¹˜í•œë‹¤.    
      * ì¦‰ ê²°ê³¼ëŠ” $$ğ›¿^T$$ì´ë‹¤.     
   * $$ğ›¿$$ í•­ìƒ shape conventionì„ ë”°ë¦„      
      * ì°¨ì›ì„ ê²€í† í•˜ì—¬ í•­ì„ ì „í™˜ ë°/ë˜ëŠ” ì¬ì •ë ¬í•  ì‹œê¸°ë¥¼ íŒŒì•…í•œë‹¤.      
      * hidden layerì— ë„ì°©í•˜ëŠ” ì˜¤ë¥˜ ë©”ì‹œì§€ $$ğ›¿$$ì€ í•´ë‹¹ hidden layerê³¼ shapeì´ ê°™ìŒ.         




<details>
<summary>ğŸ“œ Why the Transposes?</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180642624-10ab5d97-6066-4c9a-9eb0-3da9223fd793.png)
![image](https://user-images.githubusercontent.com/76824611/180643254-6cdfa798-0cca-43c2-a002-c1b4c4651a8f.png)
![image](https://user-images.githubusercontent.com/76824611/180643259-d96d7697-ffaf-47c1-badc-b9b786e6597c.png)
![image](https://user-images.githubusercontent.com/76824611/180643263-12c4db47-c9b9-4be6-bdb9-e976744b7ae1.png)
![image](https://user-images.githubusercontent.com/76824611/180643266-32df660f-b9d6-4d4f-a2e4-3e7dd6790ff3.png)
![image](https://user-images.githubusercontent.com/76824611/180643271-d81e11b8-daa2-4249-8a6e-15c8e029f4bc.png)
 
 
</div>
</details>  


<details>
<summary>ğŸ‘€ ê°•ì˜ ìŠ¬ë¼ì´ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
![image](https://user-images.githubusercontent.com/76824611/180643248-34fb7db9-4922-4804-bc1f-044b0b1f5b66.png)

  
</div>
</details>

-----
-----

# **Backpropagation** 
Backpropagation ì¦‰ ì—­ì „íŒŒëŠ” ì•„ë˜ CS231nì—ì„œ í•´ì¤€ ê°•ì˜ê°€ ë” ì •í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ì›Œì„œ ì •ë¦¬í•´ë‘” [ë§í¬](https://yerimoh.github.io/DL203/)ë¥¼ ì²¨ë¶€í–ˆë‹¤.       
ë§í¬ë¡œ ê±¸ì–´ë‘” í¬ìŠ¤íŠ¸ë¥¼ ì½ê³  ì²¨ë¶€í•œ ìŠ¬ë¼ì´ë“œë¥¼ í™•ì¸í•˜ë©´ ì´í•´ê°€ ì •ë§ ì˜ë  ê²ƒì´ë‹¤      








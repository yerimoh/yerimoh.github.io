---
title: "[08] Deep learning 1: í•©ì„±ê³± ì‹ ê²½ë§(convolutional neural network, CNN)"
date:   2020-03-5
excerpt: "í•©ì„±ê³± ì‹ ê²½ë§(convolutional neural network, CNN) ì „ì²´ ê³¼ì • ì„¸ì„¸í•˜ê²Œ ì„¤ëª…/ í•©ì„±ê³± ê³„ì¸µ,íŠ¹ì§• ë§µ (feature map),í•©ì„± ê³± ì—°ì‚°,í•©ì„±ê³± ê³„ì¸µ êµ¬í˜„, í’€ë§(pooling) ê³„ì¸µ, í’€ë§ê³„ì¸µ êµ¬í˜„, CNN êµ¬í˜„, CNN ì‹œê°í™”í•˜ê¸° "
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---

# CNN ëª©ì°¨
- [í•©ì„±ê³± ì‹ ê²½ë§(convolutional neural network, CNN)](#í•©ì„±ê³±-ì‹ ê²½ë§-convolutional-neural-network--cnn-)
- [ì „ì²´ êµ¬ì¡°](#ì „ì²´-êµ¬ì¡°)
    + [CNNì˜ êµ¬ì¡°](#cnnì˜-êµ¬ì¡°)
- [í•©ì„±ê³± ê³„ì¸µ](#í•©ì„±ê³±-ê³„ì¸µ)
  * [íŠ¹ì§• ë§µ (feature map)](#íŠ¹ì§•-ë§µ--feature-map-)
  * [í•©ì„± ê³± ì—°ì‚°](#í•©ì„±-ê³±-ì—°ì‚°)
  * [3ì°¨ì› ë°ì´í„°ì˜ í•©ì„±ê³± ì—°ì‚°](#3ì°¨ì›-ë°ì´í„°ì˜-í•©ì„±ê³±-ì—°ì‚°)
- [í’€ë§(pooling) ê³„ì¸µ](#í’€ë§-pooling--ê³„ì¸µ)
  * [í’€ë§ì˜ ì˜ë¯¸](#í’€ë§ì˜-ì˜ë¯¸)
  * [í’€ë§ì˜ ì¢…ë¥˜](#í’€ë§ì˜-ì¢…ë¥˜)
  * [í’€ë§ ê³„ì¸µì˜ íŠ¹ì§•](#í’€ë§-ê³„ì¸µì˜-íŠ¹ì§•)
- [í•©ì„±ê³±/í’€ë§ ê³„ì¸µ êµ¬í˜„í•˜ê¸°](#í•©ì„±ê³±-í’€ë§-ê³„ì¸µ-êµ¬í˜„í•˜ê¸°)
  * [im2colë¡œ ë°ì´í„° ì „ê°œ](#im2colë¡œ-ë°ì´í„°-ì „ê°œ)
  * [í•©ì„±ê³± ê³„ì¸µì˜ êµ¬í˜„ íë¦„](#í•©ì„±ê³±-ê³„ì¸µì˜-êµ¬í˜„-íë¦„)
  * [í’€ë§ ê³„ì¸µ êµ¬í˜„](#í’€ë§-ê³„ì¸µ-êµ¬í˜„)
- [CNN êµ¬í˜„í•˜ê¸°](#cnn-êµ¬í˜„í•˜ê¸°)
- [CNN ì‹œê°í™”í•˜ê¸°](#cnn-ì‹œê°í™”í•˜ê¸°)
- [ì •ë¦¬](#ì •ë¦¬)



---


# í•©ì„±ê³± ì‹ ê²½ë§
* ì´ë¯¸ì§€ ì¸ì‹ ë¶„ì•¼ì—ì„œ ì´ìš©     
* ë‘ í•¨ìˆ˜ ì¤‘ í•˜ë‚˜ë¥¼ ë°˜ì „(reverse), ì´ë™(shift)ì‹œì¼œê°€ë©° ë‚˜ë¨¸ì§€ í•¨ìˆ˜ì™€ì˜ ê³±ì„ ì—°ì´ì–´ ì ë¶„    
* = ì»¨ë²Œë£¨ì…˜ ì‹ ê²½ë§

----


## ì „ì²´ êµ¬ì¡°
* CNNë„ ë ˆê³  ë¸”ë¡ì²˜ëŸ¼ ê³„ì¸µì„ ì¡°í•©í•˜ì—¬ ë§Œë“¦  
  * ì§€ê¸ˆê¹Œì§€ ë³¸ ê³„ì¸µ + ```Convê³„ì¸µ(í•©ì„±ê³± ê³„ì¸µ)``` + ```pooling ê³„ì¸µ```   

* ì™„ì „ì—°ê²°(ì „ê²°í•©, fully-connected)     
  * ì§€ê¸ˆê¹Œì§€ ë³¸ ê³„ì¸µ      
  * ì¸ì ‘í•˜ëŠ” ê³„ì¸µì˜ **ëª¨ë“  ë‰´ëŸ°**ê³¼ ê²°í•©            
  * ```Affine ê³„ì¸µ``` ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ êµ¬í˜„      
      
**[ex]**     
Affine ê³„ì¸µì„ ì‚¬ìš©   
ê°€ë ¹ ì¸µì´ 5ê°œì¸ ì™„ì „ì—°ê²° ì‹ ê²½ë§ êµ¬í˜„    
![image](https://user-images.githubusercontent.com/76824611/128828646-d196b6a5-4da1-4064-a7fb-2040e909e039.png)

**[CNNì˜ êµ¬ì¡°]**    
**í•©ì„±ê³± ê³„ì¸µ Conv** ê³¼ **í’€ë§ ê³„ì¸µ Pooling** ì´ ìƒˆë¡œ ì¶”ê°€(íšŒìƒ‰)      
![image](https://user-images.githubusercontent.com/76824611/128828949-cbcd7449-c86c-46df-a657-14a3b0954d3a.png)
* CNNì˜ ê³„ì¸µì€ â€˜Conv-ReLU-(Pooling )â€™ íë¦„ìœ¼ë¡œ ì—°ê²°      
* ì¶œë ¥ì— ê°€ê¹Œìš´ ì¸µì—ì„œ ì§€ê¸ˆê¹Œì§€ì˜ â€˜AffineReLUâ€™ êµ¬ì„±ì„ ì‚¬ìš© ê°€ëŠ¥     
* ë§ˆì§€ë§‰ ì¶œë ¥ ê³„ì¸µì—ì„œëŠ” â€˜Affine-Softmaxâ€™ ì¡°í•©ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©      

(ë” ìì„¸íˆ ë“¤ì—¬ë‹¤ ë³´ë©´)   
![image](https://user-images.githubusercontent.com/76824611/128985604-4b277f79-266a-440c-b7ef-b3744cf73b33.png)


---
---



# í•©ì„±ê³± ê³„ì¸µ
ì–´íŒŒì¸ê³¼ ë‹¬ë¦¬ **ê° ê³„ì¸µ ì‚¬ì´ì— 3ì°¨ì› ë°ì´í„°**ê°™ì´ **ì…ì²´ì ì¸ ë°ì´í„°ê°€ íë¦„**         

**[CNN ê³ ìœ ì˜ ìš©ì–´]**        
íŒ¨ë”© padding , ìŠ¤íŠ¸ë¼ì´ë“œ stride       

**[ì™„ì „ì—°ê²° ê³„ì¸µì˜ ë¬¸ì œì ]**      
âœ” **íŠ¹ì§•**    
* ì™„ì „ì—°ê²° ê³„ì¸µ(Affine ê³„ì¸µ)ì„ ì‚¬ìš©     
* ì¸ì ‘í•˜ëŠ” ê³„ì¸µì˜ ë‰´ëŸ°ì´ ëª¨ë‘ ì—°ê²°     
* ì¶œë ¥ì˜ ìˆ˜ ì„ì˜ë¡œ ì •í•˜ê¸° ê°€ëŠ¥         

âœ” **ë¬¸ì œì **      
ë°ì´í„°ì˜ í˜•ìƒì´ ë¬´ì‹œë‹¹í•¨        
ex)      
ì…ë ¥ ë°ì´í„°ê°€ ì´ë¯¸ì§€ (ì„¸ë¡œÂ·ê°€ë¡œÂ·ì±„ë„(ìƒ‰ìƒ)ë¡œ êµ¬ì„±ëœ 3ì°¨ì› ë°ì´í„°) ì¸ ê²½ìš°     
* ì™„ì „ì—°ê²° ê³„ì¸µì— ì…ë ¥í•  ë•ŒëŠ” 3ì°¨ì› ë°ì´í„°ë¥¼ í‰í‰í•œ 1ì°¨ì› ë°ì´í„°ë¡œ í‰íƒ„í™”í•´ì¤˜ì•¼ í•¨       
* ê³µê°„ì  ì •ë³´ í”½ì…€ì˜ ê±°ë¦¬ì— ë”°ë¥¸ ê°’ ë“± ì˜ë¯¸ë¥¼ ê°–ëŠ” ë³¸ì§ˆì ì¸ íŒ¨í„´ ë¬´ì‹œ     
* [ë” ìì„¸í•œ ì˜ˆ](https://yerimoh.github.io/DL6/#1-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8F%89%ED%83%84%ED%99%94)

ğŸš« ì™„ì „ì—°ê²° ê³„ì¸µì€ ëª¨ë“  ì…ë ¥ ë°ì´í„°ë¥¼ ë™ë“±í•œ ë‰´ëŸ°(ê°™ì€ ì°¨ì›ì˜ ë‰´ëŸ°)ìœ¼ë¡œ ì·¨ê¸‰í•˜ì—¬ **í˜•ìƒì— ë‹´ê¸´ ì •ë³´ë¥¼ ì‚´ë¦´ ìˆ˜ ì—†ìŒ.**     

â¤ í•œí¸, **í•©ì„±ê³± ê³„ì¸µ**ì€ í˜•ìƒì„ ìœ ì§€ ì´ë¯¸ì§€ë„ 3ì°¨ì› ë°ì´í„°ë¡œ ì…ë ¥ë°›ìœ¼ë©°,    
ë§ˆì°¬ê°€ì§€ë¡œ ë‹¤ìŒ ê³„ì¸µì—ë„ 3ì°¨ì› ë°ì´í„°ë¡œ ì „ë‹¬ 

## íŠ¹ì§• ë§µ (feature map)
CNNì—ì„œ í•©ì„±ê³± ê³„ì¸µì˜ ì…ì¶œë ¥ ë°ì´í„°     
ë‹¤ì°¨ì›ì˜ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ë°›ê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ì°¨ì›ì„ ë³´ì—¬ì£¼ëŠ” ê²ƒì„ ë§µì´ë¼ê³  ì§€ì¹­    
**ì…ë ¥ íŠ¹ì§• ë§µ input feature map**: í•©ì„±ê³± ê³„ì¸µì˜ ì…ë ¥ ë°ì´í„°       
**ì¶œë ¥ íŠ¹ì§• ë§µ output feature map**: ì¶œë ¥ ë°ì´í„°        
â¡ â€˜ì…ì¶œë ¥ ë°ì´í„°â€™= â€˜íŠ¹ì§• ë§µâ€™      

---

## í•©ì„± ê³± ì—°ì‚°
ì´ë¯¸ì§€ ì²˜ë¦¬ì—ì„œ ë§í•˜ëŠ” í•„í„° ì—°ì‚°     
í•©ì„±ê³± ì—°ì‚°ì€ ì…ë ¥ ë°ì´í„°ì— í•„í„°(=ì»¤ë„)ë¥¼ ì ìš©       
![image](https://user-images.githubusercontent.com/76824611/128830261-5d054532-17fa-4aa4-999c-d6c250bfe7b9.png)
* ì´ ì˜ˆì—ì„œ ì…ë ¥ ë°ì´í„°ëŠ” ì„¸ë¡œÂ·ê°€ë¡œ ë°©í–¥ì˜ í˜•ìƒì„ ê°€ì§    
* í•„í„° ì—­ì‹œ ì„¸ë¡œÂ·ê°€ë¡œ ë°©í–¥ì˜ ì°¨ì›ì„ ê°–ìŒ.    
* ë°ì´í„°ì™€ í•„í„°ì˜ í˜•ìƒì„ (ë†’ì´ height , ë„ˆë¹„ width )ë¡œ í‘œê¸°     

**[ê³¼ì •]**     
**1)** í•©ì„±ê³± ì—°ì‚°ì€ í•„í„°ì˜ ìœˆë„ìš° window(íšŒìƒ‰ 3Ã—3 ë¶€ë¶„)ë¥¼ ì¼ì • ê°„ê²©ìœ¼ë¡œ ì´ë™í•´ê°€ë©° ì…ë ¥ ë°ì´í„°ì— ì ìš©.      
**2)** ê³„ì‚°ì„ ë‹¨ì¼ ê³±ì…ˆ-ëˆ„ì‚° (fused multiply-add, FMA) ì ìš©: ì…ë ¥ê³¼ í•„í„°ì—ì„œ ëŒ€ì‘í•˜ëŠ” ì›ì†Œë¼ë¦¬ ê³±í•œ í›„ ê·¸ ì´í•©ì„ êµ¬í•¨      
**3)** ê²°ê³¼ë¥¼ ì¶œë ¥ì˜ í•´ë‹¹ ì¥ì†Œì— ì €ì¥
![image](https://user-images.githubusercontent.com/76824611/128830923-13a523fc-5d7f-4de7-8475-e225f52169b3.png)
![image](https://user-images.githubusercontent.com/76824611/128830937-79a22dd6-d7c8-49fb-8e91-49f400ff157f.png)

ğŸš§**ì£¼ì˜**ğŸš§        
ê³¼í•™, ê³µí•™ìš© íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ì´ì¸ ```SciPy```ì˜ 2ì°¨ì› í•©ì„±ê³± í•¨ìˆ˜(```scipy.signal.convolve2d```)ë¡œ ì´ ì˜ˆë¥¼ ë”°ë¼ í•´ë³´ë©´ ê²°ê³¼ê°€ ë‹¤ë¦„     

â¡ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ìœ¼ë ¤ë©´ í•©ì„±ê³±ì´ ì•„ë‹ˆë¼ **êµì°¨ìƒê´€(cross-correlation) í•¨ìˆ˜**ì¸ ```scipy.signal.correlate2d```ë¥¼ ì‚¬ìš©í•´ì•¼ í•¨

**ì´ìœ :**       
ì£¼ì–´ì§„ í•„í„°ë¥¼ í”Œë¦¬í•‘(flipping_í–‰ë ¬ì˜ í”Œë¦¬í•‘ì´ë€ ì›ì†Œë“¤ì„ ì¢Œìš°, ìƒí•˜ë¡œ ê° í•œ ë²ˆì”© ë’¤ì§‘ëŠ” ê²ƒ)í•˜ë©´ í•©ì„±ê³±ì´ê³ (ì›ë˜ í•©ì„± ê³±),    
ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ êµì°¨ìƒê´€(ìœ„ì˜ ì˜ˆ)  

â¡ SciPyëŠ” ë‘˜ì„ ëª…í™•íˆ êµ¬ë¶„    
* ë”¥ëŸ¬ë‹ ìª½ì—ì„œëŠ” ì˜ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ” ê²½í–¥.        
* ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì˜ í•©ì„±ê³± í•¨ìˆ˜ë“¤ì€ í”Œë¦¬í•‘í•˜ì§€ ì•Šê±°ë‚˜, í”Œë¦¬í•‘ ì—¬ë¶€ë¥¼ ì¸ìˆ˜ë¡œ ë°›ê¸°ë„ í•¨       



**[í•„í„°]**     
ì™„ì „ì—°ê²° ì‹ ê²½ë§ì—ëŠ” **ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜**ì™€ **í¸í–¥**ì´ ì¡´ì¬        
CNNì˜ **í•„í„°ì˜ ë§¤ê°œë³€ìˆ˜**: ê·¸ë™ì•ˆì˜ â€˜ê°€ì¤‘ì¹˜â€™ì— í•´ë‹¹.     

**[í¸í–¥]**        
ìœ„ëŠ” í•„í„°ë¥¼ ì ìš©í•˜ëŠ” ë‹¨ê³„ê¹Œì§€ë§Œ ë³´ì—¬ì¤€ ê²ƒ      
â¡ í¸í–¥ê¹Œì§€ í¬í•¨í•œ ê·¸ë¦¼ì€ ì´ê²ƒ     
![image](https://user-images.githubusercontent.com/76824611/128834675-add5d5e7-809d-46e7-b4fb-252b7b2176da.png)
* í¸í–¥ì€ í•„í„°ë¥¼ ì ìš©í•œ í›„ì˜ ë°ì´í„°ì— ë”í•´ì§    
* í¸í–¥ì€ í•­ìƒ í•˜ë‚˜(1Ã—1 )ë§Œ ì¡´ì¬       
* ê·¸ í•˜ë‚˜ì˜ ê°’ì„ í•„í„°ë¥¼ ì ìš©í•œ ëª¨ë“  ì›ì†Œì— ë”í•˜ëŠ” ê²ƒ      


**[íŒ¨ë”©(padding)]**     
í•©ì„±ê³± ì—°ì‚°ì„ ìˆ˜í–‰í•˜ê¸° ì „ì— ì…ë ¥ ë°ì´í„° ì£¼ë³€ì„ íŠ¹ì • ê°’(ì˜ˆì»¨ëŒ€ 0)ìœ¼ë¡œ ì±„ìš°ê¸°ë„ í•¨ 
![image](https://user-images.githubusercontent.com/76824611/128835288-e55bc798-b00b-4e1f-b44e-e435039e29cd.png)
â¡ í­ 1ì§œë¦¬ íŒ¨ë”©_ ì…ë ¥ ë°ì´í„° ì‚¬ë°© 1í”½ì…€ì„ íŠ¹ì • ê°’ìœ¼ë¡œ ì±„ìš°ëŠ” ê²ƒ

**ì‚¬ìš© ì´ìœ **       
* íŒ¨ë”©ì€ ì£¼ë¡œ **ì¶œë ¥ í¬ê¸°ë¥¼ ì¡°ì •**í•  ëª©ì ìœ¼ë¡œ ì‚¬ìš©.      
* í•©ì„±ê³± ì—°ì‚°ì„ ëª‡ ë²ˆì´ë‚˜ ë˜í’€ì´í•˜ëŠ” ì‹¬ì¸µ ì‹ ê²½ë§ì—ì„œëŠ” ë¬¸ì œ:     
    *  í•©ì„±ê³± ì—°ì‚°ì„ ê±°ì¹  ë•Œë§ˆë‹¤ í¬ê¸°ê°€ ì‘ì•„ì§€ë©´ ì–´ëŠ ì‹œì ì—ì„œëŠ” ì¶œë ¥ í¬ê¸° 1 (ë” ì´ìƒì€ í•©ì„±ê³± ì—°ì‚°ì„ ì ìš©í•  ìˆ˜ ì—†ë‹¤ëŠ” ëœ»)         
â¡ ì´ëŸ¬í•œ ì‚¬íƒœë¥¼ ë§‰ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì‚¬ìš©        
â¡ ì…ë ¥ ë°ì´í„°ì˜ **ê³µê°„ì  í¬ê¸°ë¥¼ ê³ ì •**í•œ ì±„ë¡œ ë‹¤ìŒ ê³„ì¸µì— ì „ë‹¬ ê°€ëŠ¥     

**[ìŠ¤íŠ¸ë¼ì´ë“œ(stride ë³´í­)]**         
í•„í„°ë¥¼ ì ìš©í•˜ëŠ” ìœ„ì¹˜ì˜ ê°„ê²©       
* ì§€ê¸ˆê¹Œì§€ ë³¸ ì˜ˆëŠ” ëª¨ë‘ ìŠ¤íŠ¸ë¼ì´ë“œê°€ 1        
* ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ **í‚¤ìš°ë©´** ì¶œë ¥ í¬ê¸°ëŠ” **ì‘ì•„ì§**       

ğŸ“œ**ì¶œë ¥ í¬ê¸° ê³„ì‚° ê³µì‹**         
![image](https://user-images.githubusercontent.com/76824611/128835811-23d05cb8-cfc8-4c1a-aaf1-d72d8c7345ba.png)
* ì…ë ¥ í¬ê¸°: (H, W )      
* í•„í„° í¬ê¸°: (FH, FW )   
* ì¶œë ¥ í¬ê¸°: (OH, OW )    
* íŒ¨ë”©: P    
* ìŠ¤íŠ¸ë¼ì´ë“œ: S     
â¡ **ì •ìˆ˜**ë¡œ ë‚˜ëˆ ë–¨ì–´ì§€ëŠ” ê°’ì´ì–´ì•¼ í•¨        
â¡ ì¶œë ¥ í¬ê¸°ê°€ ì •ìˆ˜ê°€ ì•„ë‹ˆë©´ ì˜¤ë¥˜ë¥¼ ë‚´ëŠ” ë“±ì˜ ëŒ€ì‘ í•„ìš”          
â¡ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ ì¤‘ì—ëŠ” ê°’ì´ ë”± ë‚˜ëˆ ë–¨ì–´ì§€ì§€ ì•Šì„ ë•ŒëŠ” ê°€ì¥ ê°€ê¹Œìš´ ì •ìˆ˜ë¡œ ë°˜ì˜¬ë¦¼í•˜ëŠ” ë“±, íŠ¹ë³„íˆ ì—ëŸ¬ë¥¼ ë‚´ì§€ ì•Šê³  ì§„í–‰í•˜ë„ë¡ êµ¬í˜„í•˜ëŠ” ê²½ìš°ë„ ìˆìŒ 

---

## 3ì°¨ì› ë°ì´í„°ì˜ í•©ì„±ê³± ì—°ì‚°
2ì°¨ì›ì¼ ë•Œì™€ ë¹„êµí•˜ë©´, **ê¸¸ì´ ë°©í–¥(ì±„ë„ ë°©í–¥)ìœ¼ë¡œ** íŠ¹ì§• ë§µì´ **ëŠ˜ì–´ ë‚¨**       
**1)** ì…ë ¥ ë°ì´í„°ì™€ í•„í„°ì˜ í•©ì„±ê³± ì—°ì‚°ì„ ì±„ë„ë§ˆë‹¤ ìˆ˜í–‰         
**2)** ê·¸ê²°ê³¼ë¥¼ ë”í•´ì„œ í•˜ë‚˜ì˜ ì¶œë ¥ì„ ì–»ìŒ      
![image](https://user-images.githubusercontent.com/76824611/128837948-84bc724e-5730-4b11-875a-0058e2944f72.png)
![image](https://user-images.githubusercontent.com/76824611/128837958-dcdae85f-aab6-4841-8ae5-97909f430768.png)
ğŸ“ **ì£¼ì˜ì **: ì…ë ¥ ë°ì´í„°ì˜ ì±„ë„ ìˆ˜ = í•„í„°ì˜ ì±„ë„    

1ï¸âƒ£ **ë¸”ë¡ìœ¼ë¡œ ìƒê°í•˜ê¸°**       
* **ì…ë ¥ ë°ì´í„°**: (ì±„ë„ channel , ë†’ì´ height , ë„ˆë¹„ width ) (C, H, W )      
* **í•„í„°**: (C, FH, FW )   

![image](https://user-images.githubusercontent.com/76824611/128842812-4b2dc568-214f-4da8-b1e5-f062b6589e7e.png)
â¡ ì¶œë ¥ ë°ì´í„°ëŠ” í•œ ì¥ì˜ íŠ¹ì§• ë§µ(= ì±„ë„ì´ 1ê°œì¸ íŠ¹ì§• ë§µ)   

â” ê·¸ëŸ¼ í•©ì„±ê³± ì—°ì‚°ì˜ ì¶œë ¥ìœ¼ë¡œ ë‹¤ìˆ˜ì˜ ì±„ë„ì„ ë‚´ë³´ë‚´ë ¤ë©´ â”         
* ê·¸ ë‹µì€ **í•„í„°(ê°€ì¤‘ì¹˜)** ë¥¼ ë‹¤ìˆ˜ ì‚¬ìš©í•˜ëŠ” ê²ƒ           
*  ì—°ì‚°ì—ì„œëŠ” í•„í„°ì˜ ìˆ˜ë„ ê³ ë ¤ í•„ìš”    

![image](https://user-images.githubusercontent.com/76824611/128843250-488e78d0-e395-420f-a345-98327330edce.png)
* ì´ ê·¸ë¦¼ê³¼ ê°™ì´ í•„í„°ë¥¼ FNê°œ ì ìš©í•˜ë©´ ì¶œë ¥ ë§µë„ FNê°œê°€ ìƒì„±ë©ë‹ˆë‹¤.      
* ê·¸ FNê°œì˜ ë§µì„ ëª¨ìœ¼ë©´ í˜•ìƒì´ (FN, OH, OW )ì¸ ë¸”ë¡ì´ ì™„ì„±     
* ì´ ì™„ì„±ëœ ë¸”ë¡ì„ ë‹¤ìŒ ê³„ì¸µìœ¼ë¡œ ë„˜ê¸° ê² ë‹¤ëŠ” ê²ƒì´ CNNì˜ ì²˜ë¦¬ íë¦„    
**í•„í„°ì˜ ê°€ì¤‘ì¹˜ ë°ì´í„°**: 4ì°¨ì› ë°ì´í„° (ì¶œë ¥ ì±„ë„ ìˆ˜, ì…ë ¥ ì±„ë„ ìˆ˜, ë†’ì´, ë„ˆë¹„)       
       

2ï¸âƒ£ **í¸í–¥ì„ ë”í•œ ëª¨ìŠµ**    
![image](https://user-images.githubusercontent.com/76824611/128844246-780c5014-25a3-4628-b58b-0c33f5ea5e21.png)  
â¡ í¸í–¥ì€ ì±„ë„ í•˜ë‚˜ì— ê°’ í•˜ë‚˜ì”©ìœ¼ë¡œ êµ¬ì„±

3ï¸âƒ£ **ë°°ì¹˜ ì²˜ë¦¬**      
ì‹ ê²½ë§ ì²˜ë¦¬ì—ì„œëŠ” ì…ë ¥ ë°ì´í„°ë¥¼ í•œ ë©ì–´ë¦¬ë¡œ ë¬¶ì–´ ë°°ì¹˜ë¡œ ì²˜ë¦¬      
â¡ ì´ ë°©ì‹ì„ ì§€ì›í•˜ì—¬ ì²˜ë¦¬ íš¨ìœ¨ì„ ë†’ì´ê³ , ë¯¸ë‹ˆë°°ì¹˜ ë°©ì‹ì˜ í•™ìŠµë„ ì§€ì›

í•©ì„±ê³± ì—°ì‚°ë„ ë§ˆì°¬ê°€ì§€ë¡œ **ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ì§€ì›**í•˜ê³ ì í•¨.     
**1)** ê° ê³„ì¸µì„ íë¥´ëŠ” ë°ì´í„°ì˜ ì°¨ì›ì„ í•˜ë‚˜ ëŠ˜ë ¤ 4ì°¨ì› ë°ì´í„°ë¡œ ì €ì¥     
â¡ (ë°ì´í„° ìˆ˜, ì±„ë„ ìˆ˜, ë†’ì´, ë„ˆë¹„)    
![image](https://user-images.githubusercontent.com/76824611/128844845-b319c272-e33f-4ff9-b146-0cb2244e9114.png)

 
**2)** ê° ë°ì´í„°ì˜ ì„ ë‘ì— ë°°ì¹˜ìš© ì°¨ì›ì„ ì¶”ê°€     
* ì´ì²˜ëŸ¼ ë°ì´í„°ëŠ” **4ì°¨ì› í˜•ìƒ**ì„ ê°€ì§„ ì±„ ê° ê³„ì¸µì„ íƒ€ê³  íë¦„    
* **ì£¼ì˜**: ì‹ ê²½ë§ì— 4ì°¨ì› ë°ì´í„°ê°€ í•˜ë‚˜ íë¥¼ ë•Œë§ˆë‹¤ ë°ì´í„° Nê°œì— ëŒ€í•œ í•©ì„±ê³± ì—°ì‚°ì´ ì´ë¤„ì§    
  * ì¦‰, NíšŒ ë¶„ì˜ ì²˜ë¦¬ë¥¼ í•œ ë²ˆì— ìˆ˜í–‰í•˜ëŠ” ê²ƒ    

---
---

# í’€ë§(pooling) ê³„ì¸µ 
## í’€ë§ì˜ ì˜ë¯¸
ì„¸ë¡œÂ·ê°€ë¡œ ë°©í–¥ì˜ **ê³µê°„ì„ ì¤„ì´ëŠ” ì—°ì‚°**         
![image](https://user-images.githubusercontent.com/76824611/128845585-1e3a4501-e3b5-463b-8c59-ea14a334bbbe.png)
â¡ ìµœëŒ€ í’€ë§(max pooling)ì˜ **ìŠ¤íŠ¸ë¼ì´ë“œ 2**ë¡œ ì²˜ë¦¬    

## í’€ë§ì˜ ì¢…ë¥˜
**[ìµœëŒ€ í’€ë§ max pooling]**       
ìœ„ì˜ íšŒìƒ‰ì¹¸ ì¤‘ ìˆ«ì í•˜ë‚˜ë¥¼ ë½‘ëŠ” ê¸°ì¤€      
ìµœëŒ“ê°’ max ì„ êµ¬í•˜ëŠ” ì—°ì‚°        
* â€˜2Ã—2â€™ëŠ” ëŒ€ìƒ ì˜ì—­ì˜ í¬ê¸°ë¥¼ ëœ»í•¨.      
ì¦‰ 2Ã—2 ìµœëŒ€ í’€ë§ì€ ê·¸ë¦¼ê³¼ ê°™ì´ 2Ã—2 í¬ê¸°ì˜ ì˜ì—­ì—ì„œ ê°€ì¥ í° ì›ì†Œ í•˜ë‚˜ë¥¼ êº¼ë‚´ëŠ” ê²ƒ


**[í‰ê·  í’€ë§(average pooling)]**    
í‰ê·  í’€ë§ì€ ëŒ€ìƒ ì˜ì—­ì˜ í‰ê· ì„ ê³„ì‚°.      
**ì´ë¯¸ì§€ ì¸ì‹ ë¶„ì•¼**ì—ì„œëŠ” ì£¼ë¡œ ìµœëŒ€ í’€ë§ì„ ì‚¬ìš©.      

â• **í’€ë§ì˜ ìœˆë„ìš° í¬ê¸°**ì™€ **ìŠ¤íŠ¸ë¼ì´ë“œ**ëŠ” **ê°™ì€ ê°’**ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ë³´í†µ


## í’€ë§ ê³„ì¸µì˜ íŠ¹ì§•
1ï¸âƒ£ **í•™ìŠµí•´ì•¼ í•  ë§¤ê°œë³€ìˆ˜ê°€ ì—†ë‹¤**      
* í’€ë§ ê³„ì¸µì€ í•©ì„±ê³± ê³„ì¸µ(ì±„ë„, ê°€ì¤‘ì¹˜)ê³¼ ë‹¬ë¦¬ í•™ìŠµí•´ì•¼ í•  ë§¤ê°œë³€ìˆ˜ê°€ ì—†ìŒ     
* í’€ë§ì€ ëŒ€ìƒ ì˜ì—­ì—ì„œ ìµœëŒ“ê°’ì´ë‚˜ í‰ê· ì„ ì·¨í•˜ëŠ” ëª…í™•í•œ ì²˜ë¦¬ì´ë¯€ë¡œ íŠ¹ë³„íˆ í•™ìŠµí•  ê²ƒì´ ì—†ìŒ      

2ï¸âƒ£ **ì±„ë„ ìˆ˜ê°€ ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤**      
* ì±„ë„ë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ê³„ì‚°í•˜ê¸° ë•Œë¬¸    

3ï¸âƒ£ **ì…ë ¥ì˜ ë³€í™”ì— ì˜í–¥ì„ ì ê²Œ ë°›ëŠ”ë‹¤ (ê°•ê±´í•˜ë‹¤)**   
* ì…ë ¥ ë°ì´í„°ê°€ ì¡°ê¸ˆ ë³€í•´ë„ í’€ë§ì˜ ê²°ê³¼ëŠ” ì˜ ë³€í•˜ì§€ ì•ŠìŒ    

----

# í•©ì„±ê³±/í’€ë§ ê³„ì¸µ êµ¬í˜„í•˜ê¸°

**[4ì°¨ì› ë°°ì—´ ë°ì´í„° ì ‘ê·¼ë²•]**      
ì•ì—ì„œ ì„¤ëª…í•œ ëŒ€ë¡œ CNNì—ì„œ ê³„ì¸µ ì‚¬ì´ë¥¼ íë¥´ëŠ” ë°ì´í„°ëŠ” 4ì°¨ì›ì„.       
```python
#ë†’ì´ 28, ë„ˆë¹„ 28, ì±„ë„ 1ê°œì¸ ë°ì´í„°ê°€ 10ê°œ
# ë¬´ì‘ìœ„ë¡œ ë°ì´í„° ìƒì„±
>>> x = np.random.rand(10, 1, 28, 28) 
>>> x.shape 
(10, 1, 28, 28)
```

ì—¬ê¸°ì—ì„œ (10ê°œ ì¤‘) ì²« ë²ˆì§¸ ë°ì´í„°ì— ì ‘ê·¼í•˜ë ¤ë©´ ë‹¨ìˆœíˆ x[0]
```python
>>> x[0].shape # (1, 28, 28) 
>>> x[1].shape # (1, 28, 28)
```

ì²« ë²ˆì§¸ ë°ì´í„°ì˜ ì²« ì±„ë„ì˜ ê³µê°„ ë°ì´í„°ì— ì ‘ê·¼
```python
>>> x[0, 0] # ë˜ëŠ” x[0][0]
```

## im2colë¡œ ë°ì´í„° ì „ê°œ
**[ì´ë¦„ì˜ ì˜ë¯¸]**    
* im2colì€ â€˜image to columnâ€™    
* â€˜ì´ë¯¸ì§€ì—ì„œ í–‰ë ¬ë¡œâ€™ë¼ëŠ” ëœ»      
â¡ im2colì´ë¼ëŠ” ì´ë¦„ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ í•©ì„±ê³± ê³„ì¸µì„ êµ¬í˜„ ì‹œ ì´ìš©     


**í•©ì„±ê³± ì—°ì‚°ì˜ êµ¬í˜„**ì„  im2colì´ë¼ëŠ” â€˜íŠ¸ë¦­â€™ì´ ë¬¸ì œë¥¼ **ë‹¨ìˆœí™”** ì‹œí‚´     
* ë„˜íŒŒì´ì— í•©ì„±ê³± ì—°ì‚°ì„ ê³§ì´ê³§ëŒ€ë¡œ êµ¬í˜„í•˜ê¸° ìœ„í•´ for ë¬¸ì„ ì‚¬ìš©í•˜ë©´ ì„±ëŠ¥ì´ ë–¨ì–´ì§    
* for ë¬¸ ëŒ€ì‹  im2col ì´ë¼ëŠ” í¸ì˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„      


**[ì¡´ì¬ ëª©ì ]**
im2colì€ **ì…ë ¥ ë°ì´í„°** í•„í„°ë§(ê°€ì¤‘ì¹˜ ê³„ì‚°)í•˜ê¸° ì¢‹ê²Œ **ì „ê°œ**í•˜ëŠ”(í¼ì¹˜ëŠ”) í•¨ìˆ˜ 
![image](https://user-images.githubusercontent.com/76824611/128848905-87a19c41-7398-466d-a79f-c88da41e7055.png)
ë°°ì¹˜ ì•ˆì˜ ë°ì´í„° ìˆ˜ê¹Œì§€ í¬í•¨í•œ **4ì°¨ì› ë°ì´í„° â¡ 2ì°¨ì›**


im2colì€ í•„í„°ë§í•˜ê¸° ì¢‹ê²Œ ì…ë ¥ ë°ì´í„°ë¥¼ ì „ê°œ      
â¡ êµ¬ì²´ì ìœ¼ë¡œ, ì…ë ¥ ë°ì´í„°ì—ì„œ í•„í„°ë¥¼ ì ìš©í•˜ëŠ” ì˜ì—­(3ì°¨ì› ë¸”ë¡)ì—ì„œì„ í•œ ì¤„ë¡œ ëŠ˜ì–´ë†“ìŒ.     
â¡ ì´ ì „ê°œë¥¼ í•„í„°ë¥¼ ì ìš©í•˜ëŠ” ëª¨ë“  ì˜ì—­ì—ì„œ ìˆ˜í–‰í•˜ëŠ” ê²Œ im2col
![image](https://user-images.githubusercontent.com/76824611/128849262-bcc84661-7788-4eaa-a96c-80954d0bc120.png)

**[Problem]**     
ì˜ì—­ ê²¹ì¹¨      
* ì‹¤ì œ ìƒí™©ì—ì„œëŠ” ìœ„ì™€ ë‹¬ë¦¬ ì˜ì—­ì´ ê²¹ì¹˜ëŠ” ê²½ìš°ê°€ ëŒ€ë¶€ë¶„    
* í•„í„° ì ìš© ì˜ì—­ì´ ê²¹ì¹˜ê²Œ ë˜ë©´        
    * im2colë¡œ ì „ê°œí•œ í›„ì˜ ì›ì†Œ ìˆ˜ > ì›ë˜ ë¸”ë¡ì˜ ì›ì†Œ ìˆ˜     
    * im2colì„ ì‚¬ìš©í•´ êµ¬í˜„í•˜ë©´ ë©”ëª¨ë¦¬ë¥¼ ë” ë§ì´ ì†Œë¹„í•˜ëŠ” ë‹¨ì  ë°œìƒ    

**í•˜ì§€ë§Œ** ì»´í“¨í„°ëŠ” í° í–‰ë ¬ì„ ë¬¶ì–´ì„œ ê³„ì‚°í•˜ëŠ” ë° íƒì›”       
* ì˜ˆë¥¼ ë“¤ì–´, í–‰ë ¬ ê³„ì‚° ë¼ì´ë¸ŒëŸ¬ë¦¬(ì„ í˜• ëŒ€ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬) ë“±ì€ í–‰ë ¬            

---


## í•©ì„±ê³± ê³„ì¸µì˜ êµ¬í˜„ 
**1)** im2colë¡œ ì…ë ¥ ë°ì´í„°ë¥¼ ì „ê°œ     
**2)** í•©ì„±ê³± ê³„ì¸µì˜ í•„í„°(ê°€ì¤‘ì¹˜)ë¥¼ 1ì—´ë¡œ ì „ê°œ      
**3)** ë‘í–‰ë ¬ì˜ ê³±ì„ ê³„ì‚° â¡ ì™„ì „ì—°ê²° ê³„ì¸µì˜ Affine ê³„ì¸µì—ì„œ í•œ ê²ƒê³¼ ê±°ì˜ ê°™ìŒ      
**4)** ë§ˆì§€ë§‰ìœ¼ë¡œ ì¶œë ¥ ë°ì´í„°ë¥¼ ë³€í˜•(reshape)í•¨     
![image](https://user-images.githubusercontent.com/76824611/128849993-8a61497c-1c2b-41cd-9fde-cddcb83162d0.png)
 
**[êµ¬í˜„]**     
base   
<details>
<summary>ğŸ‘€ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# coding: utf-8
import numpy as np

def smooth_curve(x):
    """ì†ì‹¤ í•¨ìˆ˜ì˜ ê·¸ë˜í”„ë¥¼ ë§¤ë„ëŸ½ê²Œ í•˜ê¸° ìœ„í•´ ì‚¬ìš©"""
    window_len = 11
    s = np.r_[x[window_len-1:0:-1], x, x[-1:-window_len:-1]]
    w = np.kaiser(window_len, 2)
    y = np.convolve(w/w.sum(), s, mode='valid')
    return y[5:len(y)-5]

def shuffle_dataset(x, t):
    """ë°ì´í„°ì…‹ì„ ë’¤ì„ëŠ”ë‹¤.
    Parameters
    ----------
    x : í›ˆë ¨ ë°ì´í„°
    t : ì •ë‹µ ë ˆì´ë¸”
    Returns
    -------
    x, t : ë’¤ì„ì€ í›ˆë ¨ ë°ì´í„°ì™€ ì •ë‹µ ë ˆì´ë¸”
    """
    permutation = np.random.permutation(x.shape[0])
    x = x[permutation,:] if x.ndim == 2 else x[permutation,:,:,:]
    t = t[permutation]

    return x, t

def conv_output_size(input_size, filter_size, stride=1, pad=0):
    return (input_size + 2*pad - filter_size) / stride + 1


def im2col(input_data, filter_h, filter_w, stride=1, pad=0):
    """ë‹¤ìˆ˜ì˜ ì´ë¯¸ì§€ë¥¼ ì…ë ¥ë°›ì•„ 2ì°¨ì› ë°°ì—´ë¡œ ë³€í™˜í•œë‹¤(í‰íƒ„í™”).
    Parameters
    ----------
    input_data : 4ì°¨ì› ë°°ì—´ í˜•íƒœì˜ ì…ë ¥ ë°ì´í„°(ì´ë¯¸ì§€ ìˆ˜, ì±„ë„ ìˆ˜, ë†’ì´, ë„ˆë¹„)
    filter_h : í•„í„°ì˜ ë†’ì´
    filter_w : í•„í„°ì˜ ë„ˆë¹„
    stride : ìŠ¤íŠ¸ë¼ì´ë“œ
    pad : íŒ¨ë”©
    
    Returns
    -------
    col : 2ì°¨ì› ë°°ì—´
    """
    N, C, H, W = input_data.shape
    out_h = (H + 2*pad - filter_h)//stride + 1
    out_w = (W + 2*pad - filter_w)//stride + 1

    img = np.pad(input_data, [(0,0), (0,0), (pad, pad), (pad, pad)], 'constant')
    col = np.zeros((N, C, filter_h, filter_w, out_h, out_w))

    for y in range(filter_h):
        y_max = y + stride*out_h
        for x in range(filter_w):
            x_max = x + stride*out_w
            col[:, :, y, x, :, :] = img[:, :, y:y_max:stride, x:x_max:stride]

    col = col.transpose(0, 4, 5, 1, 2, 3).reshape(N*out_h*out_w, -1)
    return col


def col2im(col, input_shape, filter_h, filter_w, stride=1, pad=0):
    """(im2colê³¼ ë°˜ëŒ€) 2ì°¨ì› ë°°ì—´ì„ ì…ë ¥ë°›ì•„ ë‹¤ìˆ˜ì˜ ì´ë¯¸ì§€ ë¬¶ìŒìœ¼ë¡œ ë³€í™˜í•œë‹¤.
    Parameters
    ----------
    col : 2ì°¨ì› ë°°ì—´(ì…ë ¥ ë°ì´í„°)
    input_shape : ì›ë˜ ì´ë¯¸ì§€ ë°ì´í„°ì˜ í˜•ìƒï¼ˆì˜ˆï¼š(10, 1, 28, 28)ï¼‰
    filter_h : í•„í„°ì˜ ë†’ì´
    filter_w : í•„í„°ì˜ ë„ˆë¹„
    stride : ìŠ¤íŠ¸ë¼ì´ë“œ
    pad : íŒ¨ë”©
    
    Returns
    -------
    img : ë³€í™˜ëœ ì´ë¯¸ì§€ë“¤
    """
    N, C, H, W = input_shape
    out_h = (H + 2*pad - filter_h)//stride + 1
    out_w = (W + 2*pad - filter_w)//stride + 1
    col = col.reshape(N, out_h, out_w, C, filter_h, filter_w).transpose(0, 3, 4, 5, 1, 2)

    img = np.zeros((N, C, H + 2*pad + stride - 1, W + 2*pad + stride - 1))
    for y in range(filter_h):
        y_max = y + stride*out_h
        for x in range(filter_w):
            x_max = x + stride*out_w
            img[:, :, y:y_max:stride, x:x_max:stride] += col[:, :, y, x, :, :]

    return img[:, :, pad:H + pad, pad:W + pad]
```
	
</div>
</details>







1ï¸âƒ£ **im2col í•¨ìˆ˜ì˜ ì¸í„°í˜ì´ìŠ¤**              
**input_data**: (ë°ì´í„° ìˆ˜, ì±„ë„ ìˆ˜, ë†’ì´, ë„ˆë¹„)ì˜ 4ì°¨ì› ë°°ì—´ë¡œ ì´ë¤„ì§„ ì…ë ¥ ë°ì´í„°  
```python
#filter_h - í•„í„°ì˜ ë†’ì´
#filter_w - í•„í„°ì˜ ë„ˆë¹„
# stride - ìŠ¤íŠ¸ë¼ì´ë“œ
# pad - íŒ¨ë”©
im2col(input _data, filter _h, filter _w, stride = 1, pad = 0)
```
â¡ im2colì€ â€˜í•„í„° í¬ê¸°â€™, â€˜ìŠ¤íŠ¸ë¼ì´ë“œâ€™, â€˜íŒ¨ë”©â€™ì„ ê³ ë ¤í•˜ì—¬ ì…ë ¥      
â¡ ë°ì´í„°ë¥¼ 2ì°¨ì› ë°°ì—´ë¡œ ì „ê°œ


2ï¸âƒ£ **im2colì„ ì‹¤ì œë¡œ ì‚¬ìš©**     
<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
import sys, os 
sys.path.append(os.pardir) 
from common.util import im2col

# ë°°ì¹˜ í¬ê¸° 1 (ë°ì´í„° 1ê°œ), ì±„ë„ 3 ê°œ, ë†’ì´Â·ë„ˆë¹„ê°€ 7Ã—7ì˜ ë°ì´í„°
x1 = np.random.rand(1, 3, 7, 7) # (ë°ì´í„° ìˆ˜, ì±„ë„ ìˆ˜, ë†’ì´, ë„ˆë¹„)
col1 = im2col(x1, 5, 5, stride = 1, pad = 0) 
print(col1.shape) # (9, 75)

# ë°°ì¹˜ í¬ê¸°ë§Œ 10ì´ê³  ë‚˜ë¨¸ì§€ëŠ” ì²« ë²ˆì§¸ì™€ ê°™ìŒ
x2 = np.random.rand(10, 3, 7, 7) # ë°ì´í„° 10 ê°œ
col2 = im2col(x2, 5, 5, stride = 1, pad = 0) 
print(col2.shape) # (90, 75)
```
	
</div>
</details>
â¡ im2col í•¨ìˆ˜ë¥¼ ì ìš©í•œ ë‘ ê²½ìš° ëª¨ë‘ 2ë²ˆì§¸ ì°¨ì›ì˜ ì›ì†ŒëŠ” 75      
  * ì´ ê°’ì€ í•„í„°ì˜ ì›ì†Œ ìˆ˜ì™€ ê°™ìŒ(ì±„ë„ 3ê°œ, 5Ã—5 ë°ì´í„°)   
   
â¡ ë˜í•œ, ë°°ì¹˜ í¬ê¸°ê°€ 1ì¼ ë•ŒëŠ” im2colì˜ ê²°ê³¼ì˜ í¬ê¸°ê°€ (9, 75 )ì´ê³ ,      
â¡ 10ì¼ ë•ŒëŠ” ê·¸ 10ë°°ì¸ (90, 75 ) í¬ê¸°ì˜ ë°ì´í„°ê°€ ì €ì¥        

3ï¸âƒ£ **im2colì„ ì‚¬ìš©í•˜ì—¬ í•©ì„±ê³± ê³„ì¸µì„ êµ¬í˜„**       
ì—¬ê¸°ì—ì„œëŠ” í•©ì„±ê³± ê³„ì¸µì„ ```Convolution```ì´ë¼ëŠ” í´ë˜ìŠ¤ë¡œ êµ¬í˜„     
<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# í•©ì„±ê³± ê³„ì¸µì€ í•„í„°(ê°€ì¤‘ì¹˜), í¸í–¥, ìŠ¤íŠ¸ë¼ì´ë“œ, íŒ¨ë”©ì„ ì¸ìˆ˜ë¡œ ë°›ì•„ ì´ˆê¸°í™”
class Convolution:
	def __init __(self, W, b, stride = 1, pad = 0):
		self.W = W 
		self.b = b 
		self.stride = stride 
		self.pad = pad

	# í•„í„°ëŠ” (FN, C, FH, FW )ì˜ 4ì°¨ì› í˜•ìƒ
	#ì—¬ê¸°ì„œ FN í•„í„° ê°œìˆ˜, C ì±„ë„, FHëŠ” í•„í„° ë†’ì´, FW í•„í„° ë„ˆë¹„
	def forward(self, x):
		FN, C, FH, FW = self.W.shape 
		N, C, H, W = x.shape 
		out _h = int(1 + (H + 2*self.pad - FH) / self.stride) 
		out _w = int(1 + (W + 2*self.pad - FW) / self.stride)

		# ì…ë ¥ ë°ì´í„°ë¥¼ im2colë¡œ ì „ê°œ
		# í•„í„°ë„ reshapeì„ ì‚¬ìš©í•´ 2ì°¨ì› ë°°ì—´ë¡œ ì „ê°œ
		# ê·¸ë¦¬ê³  ì´ë ‡ê²Œ ì „ê°œí•œ ë‘ í–‰ë ¬ì˜ ê³±ì„ êµ¬í•©ë‹ˆë‹¤
		col = im2col(x, FH, FW, self.stride, self.pad) 
		col_W = self.W.reshape(FN, -1).T # í•„í„° ì „ê°œ ğŸ“Œ-1 
		out = np.dot(col, col_W) + self.b

		# ì¶œë ¥ ë°ì´í„°ë¥¼ ì ì ˆí•œ í˜•ìƒìœ¼ë¡œ ë°”ê¿”ì¤Œ
		# ì´ë•Œ ë„˜íŒŒì´ì˜ transpose í•¨ìˆ˜ë¥¼ ì‚¬ìš©->  ë‹¤ì°¨ì› ë°°ì—´ì˜ ì¶• ìˆœì„œë¥¼ ë°”ê¿”ì£¼ëŠ” í•¨ìˆ˜
		out=out.reshape(N,out_h,out_w,1).transpose(0,3,1,2) # ğŸ“Œtranspose(0,3,1,2)

		return out
```

	
ğŸ“Œ **-1**       
* í•„í„° ë¸”ë¡ì„ 1ì¤„ë¡œ í¼ì³ ì„¸ì›€.     
* ì´ë•Œ reshapeì˜ ë‘ ë²ˆì§¸ ì¸ìˆ˜ë¥¼ -1ë¡œ ì§€ì •-> ì´ëŠ” reshapeì´ ì œê³µí•˜ëŠ” í¸ì˜ ê¸°ëŠ¥       
* reshapeì— -1ì„ ì§€ì •í•˜ë©´ ë‹¤ì°¨ì› ë°°ì—´ì˜ ì›ì†Œ ìˆ˜ê°€ ë³€í™˜ í›„ì—ë„ ë˜‘ê°™ì´ ìœ ì§€ ë˜ë„ë¡ ì ì ˆíˆ ë¬¶ì–´ì¤Œ        

**ex]**     
ì•ì˜ ì½”ë“œì—ì„œ (10, 3, 5, 5 ) í˜•ìƒì„ í•œ ë‹¤ì°¨ì› ë°°ì—´ Wì˜ ì›ì†Œìˆ˜ëŠ” ì´ 750ê°œ            
-> ì´ ë°°ì—´ì— reshape (10, -1 )ì„ í˜¸ì¶œí•˜ë©´ 750ê°œì˜ ì›ì†Œë¥¼ 10ë¬¶ìŒìœ¼ë¡œ, ì¦‰ í˜•ìƒì´ (10, 75)ì¸ ë°°ì—´ë¡œ ë§Œë“¤ì–´ì¤Œ       
â¡ **í•„í„°ì˜ í˜•ìƒ**ì„ ì…ë ¥ë°ì´í„°ì™€ ë§ì¶”ê¸° ìœ„í•´    


ğŸ“Œ **transpose(0,3,1,2)**         
* ì¸ë±ìŠ¤(0ë¶€í„° ì‹œì‘)ë¥¼ ì§€ì •í•˜ì—¬ ì¶•ì˜ ìˆœì„œë¥¼ ë³€ê²½      
* ì¸ë±ìŠ¤(ë²ˆí˜¸)ë¡œ ì¶•ì˜ ìˆœì„œ ë³€í˜•       

</div>
</details>
â¡ im2colë¡œ ì „ê°œí•œ ë•ë¶„ì— ì™„ì „ì—°ê²° ê³„ì¸µì˜ Affine ê³„ì¸µê³¼ ê±°ì˜ ë˜‘ê°™ì´ êµ¬í˜„ ê°€ëŠ¥ 
![image](https://user-images.githubusercontent.com/76824611/128851454-614d777c-320a-4893-bef4-a69bb873d7ec.png)

---


## í’€ë§ ê³„ì¸µ êµ¬í˜„
í’€ë§ ê³„ì¸µ êµ¬í˜„ë„ í•©ì„±ê³± ê³„ì¸µê³¼ ë§ˆì°¬ê°€ì§€ë¡œ **im2colì„ ì‚¬ìš©í•´ ì…ë ¥ ë°ì´í„°ë¥¼ ì „ê°œ**        
* í’€ë§ì˜ ê²½ìš°ì—” **ì±„ë„ ìª½ì´ ë…ë¦½ì **ì´ë¼ëŠ” ì ì´ í•©ì„±ê³± ê³„ì¸µ ë•Œì™€ ë‹¤ë¦„.      
* êµ¬ì²´ì ìœ¼ë¡œëŠ” í’€ë§ ì ìš© ì˜ì—­ì„ **ì±„ë„ë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ì „ê°œ**      
![image](https://user-images.githubusercontent.com/76824611/128851910-75434b3d-86c5-4f7e-9a48-f305516af3b1.png)
 

**[í’€ë§ ê³„ì¸µì˜ forward ì²˜ë¦¬ íë¦„]**      

**1)** ì¼ë‹¨ ì´ë ‡ê²Œ **ì „ê°œ**í•œ í›„    
**2)** ì „ê°œí•œ í–‰ë ¬ì—ì„œ í–‰ë³„ **ìµœëŒ“ê°’**ì„ êµ¬í•¨    
**3)** ì ì ˆí•œ í˜•ìƒìœ¼ë¡œ **ì„±í˜•**   
![image](https://user-images.githubusercontent.com/76824611/128852131-f15fa160-fbac-4d11-ad8d-d395f2396092.png)



**[í’€ë§ ê³„ì¸µ êµ¬í˜„ì€ ì„¸ ë‹¨ê³„ë¡œ ì§„í–‰]**           
**1)** ì…ë ¥ ë°ì´í„°ë¥¼ ì „ê°œí•œë‹¤.     
**2)** í–‰ë³„ ìµœëŒ“ê°’ì„ êµ¬í•œë‹¤.     
**3)** ì ì ˆí•œ ëª¨ì–‘ìœ¼ë¡œ ì„±í˜•í•œë‹¤.    

* ìµœëŒ“ê°’ ê³„ì‚°ì—ëŠ” ë„˜íŒŒì´ì˜ ```np.max``` ë©”ì„œë“œë¥¼ ì‚¬ìš© ê°€ëŠ¥    
   * **np.max**ì˜ ì¸ìˆ˜ ì¤‘ **ì¶•(axis)**: ì´ ì¸ìˆ˜ë¡œ ì§€ì •í•œ ì¶•ë§ˆë‹¤ **ìµœëŒ“ê°’**ì„ êµ¬í•  ìˆ˜ ìˆìŒ     
   * ex) ```np.max (x, axis=1 )```ê³¼ ê°™ì´ ì“°ë©´ ì…ë ¥ xì˜ 1ë²ˆì§¸ ì°¨ì›ì˜ ì¶•ë§ˆë‹¤ ìµœëŒ“ê°’ì„ êµ¬í•¨         
   * â¡ 2ì°¨ì› ë°°ì—´, ì¦‰ í–‰ë ¬ì´ë¼ë©´ axis=0ì€ ì—´ ë°©í–¥, axis=1ì€ í–‰ ë°©í–¥


**[í’€ë§ ê³„ì¸µ êµ¬í˜„]**
<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
class Pooling:
	def __init __(self, pool_h, pool_w, stride = 1, pad = 0):
		self.pool_h = pool_h 
		self.pool_w = pool_w 
		self.stride = stride 
		self.pad = pad

	def forward(self, x):
		N, C, H, W = x.shape 
		out_h = int(1 + (H - self.pool_h) / self.stride) 
		out_w = int(1 + (W - self.pool_w) / self.stride)

		# ì „ê°œ (1)
		col = im2col(x, self.pool_h, self.pool_w, self.stride, self.pad) 
		col = col.reshape(-1, self.pool_h*self.pool_w)

		# ìµœëŒ“ê°’ (2)
		out = np.max(col, axis = 1)

		# ì„±í˜• (3)
		out = out.reshape(N, out_h, out_w, C).transpose(0, 3, 1, 2)

		return out
```

</div>
</details>


----

# CNN êµ¬í˜„í•˜ê¸°

í•©ì„±ê³± ê³„ì¸µ(ê³„ì‚°)ê³¼ í’€ë§ ê³„ì¸µ(í¬ê¸° ì¡°ì •)ì„ êµ¬í˜„í–ˆìœ¼ë‹ˆ, ì´ ê³„ì¸µë“¤ì„ ì¡°í•©í•˜ì—¬ CNN ì„ ì¡°ë¦½           
  
**[ë‹¨ìˆœí•œ CNNì˜ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±]**
CNN ë„¤íŠ¸ì›Œí¬ ```Convolution```-```ReLU```-```Pooling```â¡```Affine```-```ReLU```â¡```AffineSoftmax```     
* ì´ë¥¼ ```SimpleConvNet```ì´ë¼ëŠ” ì´ë¦„ì˜ í´ë˜ìŠ¤ë¡œ êµ¬í˜„     

 ![image](https://user-images.githubusercontent.com/76824611/128852987-b3c8e5ea-ebcf-4d46-a0ef-1576ffff0092.png)

## ì´ˆê¸°í™”
```SimpleConvNet```ì˜ ì´ˆê¸°í™”(__init__ )     

**[ì´ˆê¸°í™” ë•Œ ë°›ëŠ” ì¸ìˆ˜]**    
* ```input_dim```: ì…ë ¥ ë°ì´í„°(ì±„ë„ ìˆ˜, ë†’ì´, ë„ˆë¹„)ì˜ ì°¨ì›     
* ```conv_param```: í•©ì„±ê³± ê³„ì¸µì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°(ë”•ì…”ë„ˆë¦¬).      
	* **ë”•ì…”ë„ˆë¦¬ì˜ í‚¤ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤**     
	* ```filter_num```:  í•„í„° ìˆ˜       
	* ```filter_size```:  í•„í„° í¬ê¸°      
	* ```stride```:  ìŠ¤íŠ¸ë¼ì´ë“œ     
	* ```pad```: íŒ¨ë”©     
* ```hidden_size```: ì€ë‹‰ì¸µ(ì™„ì „ì—°ê²°)ì˜ ë‰´ëŸ° ìˆ˜     
* ```output_size```: ì¶œë ¥ì¸µ(ì™„ì „ì—°ê²°)ì˜ ë‰´ëŸ° ìˆ˜     
* ```weight_init_std```: ì´ˆê¸°í™” ë•Œì˜ ê°€ì¤‘ì¹˜ í‘œì¤€í¸ì°¨       

â• ```conv_param ```ì˜ ë”•ì…”ë„ˆë¦¬í˜• í•˜ì´í¼ íŒŒë¼ë¯¸í„° ì˜ˆì‹œ        
ì´ê²ƒì€ í•„ìš”í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ì˜ ê°’ì´, ```{'filter_num':30, 'filter_size':5, 'pad':0, 'stride':1}```ì²˜ëŸ¼ ì €ì¥.    
<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# ì´ˆê¸°í™” ì¸ìˆ˜ë¡œ ì£¼ì–´ì§„ í•©ì„±ê³± ê³„ì¸µì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ë”•ì…”ë„ˆë¦¬ì—ì„œ êº¼ëƒ„ (ë‚˜ì¤‘ì— ì“°ê¸° ì‰½ë„ë¡)
class SimpleConvNet:
	def __init __(self, input _dim = (1, 28, 28), 
			conv _param = {'filter_num':30, 'filter_size':5, 'pad':0, 'stride':1},
 			hidden_size = 100, output_size = 10,weight_init_std = 0.01):
		filter_num = conv_param['filter_num'] 
		filter_size = conv_param['filter_size'] 
		filter_pad = conv_param['pad'] 
		filter_stride = conv_param['stride'] 
		input_size = input_dim[1] 
		# í•©ì„±ê³± ê³„ì¸µì˜ ì¶œë ¥ í¬ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤
		Conv_output_size = (input_size - filter_size + 2*filter_pad) / filter_stride + 1
		pool_output_size = int(filter_num * (conv_output_size/2) * (conv _output _size/2))
.            
		# ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. 
		# í•™ìŠµì— í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜ëŠ” 1ë²ˆì§¸ ì¸µì˜ í•©ì„±ê³± ê³„ì¸µê³¼ ë‚˜ë¨¸ì§€ ë‘ ì™„ì „ì—°ê²° ê³„ì¸µì˜ ê°€ì¤‘ì¹˜ì™€ í¸í–¥

		# ì´ ë§¤ê°œë³€ìˆ˜ë“¤ì„ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ params ë”•ì…”ë„ˆë¦¬ì— ì €ì¥
		#1ë²ˆì§¸ ì¸µì˜ í•©ì„±ê³± ê³„ì¸µì˜ ê°€ì¤‘ì¹˜ë¥¼ W1, í¸í–¥ì„ b1
		# ë§ˆì°¬ê°€ì§€ë¡œ 2ë²ˆì§¸ ì¸µì˜ ì™„ì „ì—°ê²° ê³„ì¸µì˜ ê°€ì¤‘ì¹˜ì™€ í¸í–¥ì„ W2ì™€ b2
		# ë§ˆì§€ë§‰ 3ë²ˆì§¸ ì¸µì˜ ì™„ì „ì—°ê²° ê³„ì¸µì˜ ê°€ì¤‘ì¹˜ì™€ í¸í–¥ì„ W3 ì™€ 
		# b3ë¼ëŠ” í‚¤ë¡œ ê°ê° ì €ì¥

		self.params = {} 
		self.params['W1'] = weight_init_std * np.random.randn(filter_num,input_dim[0],filter_size, filter_size) 
		self.params['b1'] = np.zeros(filter_num) 
		self.params['W2'] = weight_init_std * np.random.randn(pool_output_size, hidden_size) 
		self.params['b2'] = np.zeros(hidden _size)
		self.params['W3'] = weight_init_std * np.random.randn(hidden_size, output_size)
		self.params['b3'] = np.zeros(output_size)

		# CNNì„ êµ¬ì„±í•˜ëŠ” ê³„ì¸µë“¤ì„ ìƒì„±í•©ë‹ˆë‹¤.
		# ìˆœì„œê°€ ìˆëŠ” ë”•ì…”ë„ˆë¦¬ OrderedDict ì¸ layers ì— ê³„ì¸µë“¤ì„ ì°¨ë¡€ë¡œ ì¶”ê°€
		# ë§ˆì§€ë§‰ SoftmaxWithLoss ê³„ì¸µë§Œí¼ì€ last_layerë¼ëŠ” ë³„ë„ ë³€ìˆ˜ì— ì €ì¥-> SimpleConvNetì˜ ì´ˆê¸°í™”
		self.layers = OrderedDict() 
		self.layers['Conv1'] = Convolution(self.params['W1'], 
							self.params['b1'], 
							conv_param['stride'],
							conv_param['pad']) 
		self.layers['Relu1'] = Relu() 
		self.layers['Pool1'] = Pooling(pool _h = 2, pool _w = 2, stride = 2) 
		self.layers['Affine1'] = Affine(self.params['W2'], self.params['b2']) 
		self.layers['Relu2'] = Relu() 
		self.layers['Affine2'] = Affine(self.params['W3'], self.params['b3'])
		
		self.last _layer = SoftmaxWithLoss()

		# ì¶”ë¡ ì„ ìˆ˜í–‰í•˜ëŠ” predict ë©”ì„œë“œì™€ ì†ì‹¤ í•¨ìˆ˜ì˜ ê°’ì„ êµ¬í•˜ëŠ” loss ë©”ì„œë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„
	def predict(self, x):
		for layer in self.layers.values():
			x = layer.forward(x) 
		return x

	def gradient(self, x, t):
		# ìˆœì „íŒŒ
		self.loss(x, t)
		
		# ì—­ì „íŒŒ 
		# ë§¤ê°œë³€ìˆ˜ì˜ ê¸°ìš¸ê¸°ëŠ” ì˜¤ì°¨ì—­ì „íŒŒë²•ìœ¼ë¡œ êµ¬í•©ë‹ˆë‹¤
		dout = 1
		dout = self.last _layer.backward(dout)

		layers = list(self.layers.values()) 
		layers.reverse() 
		for layer in layers:
			dout = layer.backward(dout)

		# ê²°ê³¼ ì €ì¥
		grads = {} 
		grads['W1'] = self.layers['Conv1'].dW 
		grads['b1'] = self.layers['Conv1'].db 
		grads['W2'] = self.layers['Affine1'].dW 
		grads['b2'] = self.layers['Affine1'].db 
		grads['W3'] = self.layers['Affine2'].dW 
		grads['b3'] = self.layers['Affine2'].db

		return grads
		# ì´ ê³¼ì •ì€ ìˆœì „íŒŒì™€ ì—­ì „íŒŒë¥¼ ë°˜ë³µí•©ë‹ˆë‹¤.
```

</div>
</details>
ì§€ê¸ˆê¹Œì§€ ê° ê³„ì¸µì˜ ìˆœì „íŒŒì™€ ì—­ì „íŒŒ ê¸°ëŠ¥ì„ ì œëŒ€ë¡œ êµ¬í˜„í–ˆë‹¤ë©´,         
ì—¬ê¸°ì—ì„œëŠ” ë‹¨ì§€ ê·¸ê²ƒë“¤ì„ **ì ì ˆí•œ ìˆœì„œë¡œ í˜¸ì¶œ**ë§Œ í•´ì£¼ë©´ ë¨.    
ë§ˆì§€ë§‰ìœ¼ë¡œ gradsë¼ëŠ” ë”•ì…”ë„ˆë¦¬ ë³€ìˆ˜ì— ê° ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜ ê¸°ìš¸ê¸° ì €ì¥    

---
---

# CNN ì‹œê°í™”í•˜ê¸°

## 1ë²ˆì§¸ ì¸µì˜ ê°€ì¤‘ì¹˜ ì‹œê°í™”
í•©ì„±ê³± ê³„ì¸µì˜ ê°€ì¤‘ì¹˜ëŠ” ê·¸ í˜•ìƒì´ (30, 1, 5, 5 )        
â¡ (í•„í„° 30ê°œ, ì±„ë„ 1ê°œ, 5Ã—5 í¬ê¸°) í•„í„°ì˜ í¬ê¸°ê°€ 5Ã—5ì´ê³  ì±„ë„ì´ 1ê°œ    
â¡ ì´ í•„í„°ë¥¼ 1ì±„ë„ì˜ íšŒìƒ‰ì¡° ì´ë¯¸ì§€ë¡œ ì‹œê°í™” ê°€ëŠ¥í•˜ë‹¤ëŠ” ëœ»       
ê·¸ëŸ¼ í•©ì„±ê³± ê³„ì¸µ(1ì¸µì§¸) í•„í„°ë¥¼ ì´ë¯¸ì§€ë¡œ ë‚˜íƒ€ë‚´ ë³´ì     


ê°€ì¤‘ì¹˜ì˜ ì›ì†ŒëŠ” ì‹¤ìˆ˜ì´ì§€ë§Œ,  ì´ë¯¸ì§€ì—ì„œëŠ”     
* ê°€ì¥ ì‘ì€ ê°’(0): ê²€ì€ìƒ‰              
* ê°€ì¥ í° ê°’(255): í°ìƒ‰ìœ¼ë¡œ **ì •ê·œí™”**í•˜ì—¬ í‘œì‹œ          
![image](https://user-images.githubusercontent.com/76824611/128857075-f4b8ac4b-5d6a-4331-9a44-442d361ad7b7.png)

í•™ìŠµì„ ë§ˆì¹œ í•„í„°: **ê·œì¹™ì„± ìˆëŠ” ì´ë¯¸ì§€**ê°€ ë¨     
* í°ìƒ‰ì—ì„œ ê²€ì€ìƒ‰ìœ¼ë¡œ ì ì°¨ ë³€í™”í•˜ëŠ” í•„í„°, ë©ì–´ë¦¬(ë¸”ë¡­ blob)ê°€ ì§„ í•„í„° ë“±, **ê·œì¹™ì„ ë„ëŠ” í•„í„°ë¡œ ë°”ë€œ**  
   
**[ê·œì¹™ì„± ìˆëŠ” í•„í„°ê°€ ë³´ëŠ” ê²ƒ]**     
* ì—ì§€(ìƒ‰ìƒì´ ë°”ë€ ê²½ê³„ì„ )     
* ë¸”ë¡­(êµ­ì†Œì ìœ¼ë¡œ ë©ì–´ë¦¬ì§„ ì˜ì—­) ë“±      
â¡ ì›ì‹œì ì¸ ì •ë³´ ì¶”ì¶œê°€ëŠ¥       
**ex)**   
ê°€ë ¹ ì™¼ìª½ ì ˆë°˜ì´ í°ìƒ‰ì´ê³  ì˜¤ë¥¸ìª½ ì ˆë°˜ì´ ê²€ì€ìƒ‰ì¸ í•„í„°ëŠ” ì„¸ë¡œ ë°©í–¥ì˜ ì—ì§€ì— ë°˜ì‘í•˜ëŠ” í•„í„°.
â¡ ì´ëŸ° ì›ì‹œì ì¸ ì •ë³´ê°€ ë’·ë‹¨ ê³„ì¸µì— ì „ë‹¬ëœë‹¤ëŠ” ê²ƒì´ ì•ì—ì„œ êµ¬í˜„í•œ CNNì—ì„œ ì¼ì–´ë‚˜ëŠ” ì¼
![image](https://user-images.githubusercontent.com/76824611/128857470-54605487-33f6-4cd9-bd0e-6243377acca0.png)





## ì¸µ ê¹Šì´ì— ë”°ë¥¸ ì¶”ì¶œ ì •ë³´ ë³€í™”
ì• ì ˆì˜ ê²°ê³¼ëŠ” 1ë²ˆì§¸ ì¸µì˜ í•©ì„±ê³± ê³„ì¸µì„ ëŒ€ìƒìœ¼ë¡œ í•œ ê²ƒ           
â¡ 1 ì¸µì˜ í•©ì„±ê³± ê³„ì¸µ ì—ì„œëŠ” ì—ì§€ë‚˜ ë¸”ë¡­ ë“±ì˜ ì €ìˆ˜ì¤€ ì •ë³´ê°€ ì¶”ì¶œ   

â” ê²¹ê²¹ì´ ìŒ“ì¸ CNNì˜ ê° ê³„ì¸µì—ì„œ ì¶”ì¶œ ë˜ëŠ” ì •ë³´ëŠ” â”           
**ê³„ì¸µì´ ê¹Šì–´**ì§ˆìˆ˜ë¡ ì¶”ì¶œë˜ëŠ” ì •ë³´(ì •í™•íˆëŠ” ê°•í•˜ê²Œ ë°˜ì‘í•˜ëŠ” ë‰´ëŸ°)ëŠ” **ë” ì¶”ìƒí™”**ëœë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŒ
![image](https://user-images.githubusercontent.com/76824611/128858139-eb7acba2-b134-4413-8fb8-2ce3771432a1.png)
* ì´ì™€ ê°™ì´ í•©ì„±ê³± ê³„ì¸µì„ ì—¬ëŸ¬ ê²¹ ìŒ“ìœ¼ë©´, ì¸µì´ ê¹Šì–´ì§€ë©´ì„œë” ë³µì¡í•˜ê³  ì¶”ìƒí™”ëœ ì •ë³´ê°€ ì¶”ì¶œ               
  * ì²˜ìŒ ì¸µì€ **ë‹¨ìˆœí•œ ì—ì§€**ì— ë°˜ì‘í•˜ê³ , ì´ì–´ì„œ **í…ìŠ¤ì²˜**ì— ë°˜ì‘í•˜ê³ , **ë” ë³µì¡í•œ ì‚¬ë¬¼ì˜ ì¼ë¶€**ì— ë°˜ì‘í•˜ë„ë¡ ë³€í™”.      
* ì¦‰, ì¸µì´ ê¹Šì–´ì§€ë©´ì„œ ë‰´ëŸ°ì´ ë°˜ì‘í•˜ëŠ” ëŒ€ìƒì´ ë‹¨ìˆœí•œ ëª¨ì–‘ì—ì„œ **â€˜ê³ ê¸‰â€™ ì •ë³´**ë¡œ ë³€í™”.
â¡ ë‹¤ì‹œ ë§í•˜ë©´ **ì‚¬ë¬¼ì˜ â€˜ì˜ë¯¸â€™ë¥¼ ì´í•´**í•˜ë„ë¡ ë³€í™”í•˜ëŠ” ê²ƒ     


---

## ëŒ€í‘œì ì¸ CNN
íŠ¹íˆ ì¤‘ìš”í•œ ë„¤íŠ¸ì›Œí¬ë¥¼ ë‘ ê°œ ì†Œê°œ     
* **LeNet**: CNNì˜ ì›ì¡°      
* **AlexNet**: ë”¥ëŸ¬ë‹ì´ ì£¼ëª©ë°›ë„ë¡ ì´ëˆ AlexNet 

1ï¸âƒ£ **LeNet**      
ì†ê¸€ì”¨ ìˆ«ìë¥¼ ì¸ì‹í•˜ëŠ” ë„¤íŠ¸ì›Œí¬     
**1)** **í•©ì„±ê³± ê³„ì¸µ**ê³¼ **í’€ë§ ê³„ì¸µ**(ì •í™•íˆëŠ” ë‹¨ìˆœíˆ â€˜ì›ì†Œë¥¼ ì¤„ì´ê¸°â€™ë§Œ í•˜ëŠ” ì„œë¸Œìƒ˜í”Œë§ ê³„ì¸µ)ì„ ë°˜ë³µ      
**2)** ë§ˆì§€ë§‰ìœ¼ë¡œ **ì™„ì „ì—°ê²° ê³„ì¸µ**ì„ ê±°ì¹˜ë©´ì„œ ê²°ê³¼ë¥¼ ì¶œë ¥     

**[LeNetê³¼ â€˜í˜„ì¬ì˜ CNNâ€™ì°¨ì´ì ]**   
* **í™œì„±í™” í•¨ìˆ˜**     
   * **LeNet**: ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©     
   * **í˜„ì¬**: ì£¼ë¡œ ReLUë¥¼ ì‚¬ìš©    
* **ë°ì´í„° í¬ê¸° ì¤„ì´ëŠ” ë°©ë²•**        
   * **ì›ë˜ì˜ LeNet**" ì„œë¸Œìƒ˜í”Œë§ì„ í•˜ì—¬ ì¤‘ê°„ ë°ì´í„°ì˜ í¬ê¸°ë¥¼ ì¤„ì„     
   * **í˜„ì¬**: ìµœëŒ€ í’€ë§ì´ ì£¼ë¥˜     


2ï¸âƒ£ **AlexNet**
![image](https://user-images.githubusercontent.com/76824611/128859042-eb5851ff-8ad4-406e-ab32-5e336b00d2a1.png)
**1)** AlexNetì€ **í•©ì„±ê³± ê³„ì¸µ**ê³¼ **í’€ë§ ê³„ì¸µ**ì„ ê±°ë“­í•˜ë©°    
**2)** ë§ˆì§€ë§‰ìœ¼ë¡œ **ì™„ì „ì—°ê²° ê³„ì¸µ**ì„ ê±°ì³     
**3)** ê²°ê³¼ë¥¼ ì¶œë ¥    
LeNetì—ì„œ í° êµ¬ì¡°ëŠ” ë°”ë€Œì§€ ì•ŠìŒ      

**[AlexNetì˜ ì°¨ì´ì ]**     
* **í™œì„±í™” í•¨ìˆ˜**: ReLUë¥¼ ì´ìš©.     
* **LRN** Local Response Normalization: êµ­ì†Œì  ì •ê·œí™”ë¥¼ ì‹¤ì‹œí•˜ëŠ” ê³„ì¸µì„ ì´ìš©.    
* **ë“œë¡­ì•„ì›ƒ**ì„ ì‚¬ìš©  
  * ë¹…ë°ì´í„°ì™€ GPU, ì´ê²ƒì´ ë”¥ëŸ¬ë‹ ë°œì „ì˜ í° ì›ë™ë ¥.     

â• ë”¥ëŸ¬ë‹(ì‹¬ì¸µ ì‹ ê²½ë§)ì—ëŠ” ëŒ€ë¶€ë¶„ ìˆ˜ë§ì€ ë§¤ê°œë³€ìˆ˜ê°€ ì“°ì„.        
* í•™ìŠµí•˜ë ¤ë©´ ì—„ì²­ë‚œ ì–‘ì˜ ê³„ì‚° í•„ìš”.       
* ë˜í•œ, ê·¸ ë§¤ê°œë³€ìˆ˜ë¥¼ â€˜í”¼íŒ… fitting, ì í•© â€™ì‹œí‚¤ëŠ” ë°ì´í„°ë„ ëŒ€ëŸ‰ í•„ìš”     
â¡ GPUì™€ ë¹…ë°ì´í„°ë¡œ í•´ê²°  


---

# ì •ë¦¬
â— CNNì€ ì§€ê¸ˆê¹Œì§€ì˜ ì™„ì „ì—°ê²° ê³„ì¸µ ë„¤íŠ¸ì›Œí¬ì— í•©ì„±ê³± ê³„ì¸µê³¼ í’€ë§ ê³„ì¸µì„ ìƒˆë¡œ ì¶”ê°€í•œë‹¤.    
â— í•©ì„±ê³± ê³„ì¸µê³¼ í’€ë§ ê³„ì¸µì€ im2col (ì´ë¯¸ì§€ë¥¼ í–‰ë ¬ë¡œ ì „ê°œí•˜ëŠ” í•¨ìˆ˜)ì„ ì´ìš©í•˜ë©´ ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.     
â— CNNì„ ì‹œê°í™”í•´ë³´ë©´ ê³„ì¸µì´ ê¹Šì–´ì§ˆìˆ˜ë¡ ê³ ê¸‰ ì •ë³´ê°€ ì¶”ì¶œë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.     
â— ëŒ€í‘œì ì¸ CNNì—ëŠ” LeNetê³¼ AlexNetì´ ìˆë‹¤.    
â— ë”¥ëŸ¬ë‹ì˜ ë°œì „ì—ëŠ” ë¹…ë°ì´í„°ì™€ GPUê°€ í¬ê²Œê¸°ì—¬

---
title: "Deep learning: BERT êµ¬í˜„, ì½”ë“œ ì„¤ëª…"
date:   2020-01-17
excerpt: ""
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---


# ëª©ì°¨



----
---

ğŸ‘€, ğŸ¤·â€â™€ï¸ , ğŸ“œ    
ì´ ì•„ì´ì½˜ë“¤ì„ ëˆ„ë¥´ì‹œë©´ ì½”ë“œ, ê°œë… ë¶€ê°€ ì„¤ëª…ì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:)

---
----


# INRTO
ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„  NVIDIAì˜ NeMoë¥¼ ì¨ì„œ bertë¥¼ ì‚¬ìš©í•´ ë³¼ ê²ƒì´ë‹¤

**[ëª©í‘œ]**              
ì‚¬ì „ íŠ¸ë ˆì´ë‹ëœ ëŒ€ê·œëª¨ ê³ ì„±ëŠ¥ Transformer ê¸°ë°˜ ì–¸ì–´ ëª¨ë¸í˜ ì‚¬ìš©í•˜ì—¬ NLP ì‘ì—…,   
* **0) ë°ì´í„° ì‚´í´ë³´ê¸°**: NCBI ì§ˆë³‘ ì–¸ì–´ ìë£Œì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ì„¸íŠ¸ë¥¼ ì‚¬ìš©     
* **1) pretraining:** í…ìŠ¤íŠ¸ ë¶„ë¥˜        
* **2) fine tuning:** NER(ëª…ëª…ëœ ì—”í„°í‹° ì¸ì‹)êµ¬ì¶•   





**[ì½ê¸° ìœ„í•´ í•„ìš”í•œ ì§€ì‹]**    
* [attention](https://yerimoh.github.io/DL19/)             
* [transformer](https://yerimoh.github.io/Lan/): ì •ë§ ë¬´ì¡°ê±´ë¬´ì¡°ê±´ ì •ë…í•˜ì ì´ê±° ì½ê³ ì˜¤ë©´ ì´ë²ˆ í¬ìŠ¤íŠ¸ëŠ” ê»Œì´ë‹¤.            
* [bert](https://yerimoh.github.io/Lan2/)    

**[ì› ë…¼ë¬¸]**          
[Attention is All You Need](https://arxiv.org/abs/1706.03762)              
[bert](https://arxiv.org/pdf/1810.04805.pdf)              
  
      



---
---

# **0) ë°ì´í„° ì‚´í´ë³´ê¸°**
**[Corpus Annotated Data]**     
14ëª…ì˜ ì£¼ì„ìê°€ ì–´ë…¸í…Œì´ì…˜ì„ ì§„í–‰ í•œ ë‹¨ 793ê°œì˜ PubMed Abstract      
ëª…í™•í•˜ê²Œ ì •ì˜ëœ ê·œì¹™ì„ ì‚¬ìš©í•´ Abstract í…ìŠ¤íŠ¸ì— ì‚½ì…ë˜ëŠ” HTML ìŠ¤íƒ€ì¼ íƒœê·¸ì˜ í˜•ì‹ì„ ì§€ë‹˜     

**ë‹¤ë¥¸ ë°ì´í„°ì— ì ìš©ì„í•´ë³´ë ¤ë©´ ê·¸ ë°ì´í„°ë¥¼ ë¡œë“œí•˜ë©´ ëœë‹¤**

-----



## 1) pretraining: í…ŒìŠ¤íŠ¸ ë¶„ë¥˜ ë°ì´í„° ì„¸íŠ¸
í…ìŠ¤íŠ¸ì˜ ë‚´ìš©ì— ë”°ë¼ í…ìŠ¤íŠ¸ë¥¼ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.       
í…ìŠ¤íŠ¸ ë¶„ë¥˜ ì ìš© ì˜ˆ    
* ê°ì •ë¶„ì„: 2ê°œì˜ í´ë˜ìŠ¤      
* ì£¼ì œ ë ˆì´ë¸” ì§€ì •: ì—¬ëŸ¬í´ë˜ìŠ¤     
í•„ìš”í•œ ë°ì´í„° ì„¸íŠ¸ë¥¼ ì´í•´í•˜ë ¤ë©´ í•˜ê³ ì‹¶ì€ ì§ˆë¬¸ì´ ë­”ì§€ë¶€í„° ì •í•´ì•¼í•œë‹¤.        



<details>
<summary>ğŸ“œ ê°ì •ë¶„ì„ </summary>
<div markdown="1">

ì´ì§„ë¶„ë¥˜ì„(2ê°œì˜ í´ë˜ìŠ¤)    
* ê°ì •ì´ ê¸ì •ì ì¸ê°€      
* ê°ì •ì´ ë¶€ì •ì ì¸ê°€ 
  
ì¦‰ ê° ë¬¸ì¥ì— ì´ ë‘ê°€ì§€ ì¤‘ í•˜ë‚˜ë¡œ ë ˆì´ë¸”ì„ ì§€ì •í•´ì•¼í•œë‹¤.        
  
â¡ ê¸°ì—…ë“¤ì´ ì˜¨ë¼ì¸ ëŒ€í™”ì™€ í”¼ë“œë°±ì—ì„œ ì œí’ˆ, ë¸Œëœë“œ ë˜ëŠ” ì„œë¹„ìŠ¤ì— ëŒ€í•œ ê³ ê°ì˜ ê°ì •ì„ íŒŒì•…í•˜ëŠ” ë° ë„ë¦¬ ì‚¬ìš©ë¨    
  
</div>
</details> 

<details>
<summary>ğŸ“œ ì£¼ì œë ˆì´ë¸” ì§€ì • </summary>
<div markdown="1">

ë‹¤ì¤‘ë¶„ë¥˜ì„(Multi-Class Analysis)    
* ex) ì£¼ì–´ì§„ ì˜í•™ ì§ˆë³‘ Abstractì€ ì•” ë˜ëŠ” ì‹ ê²½ê³„ ì§ˆí™˜, ì•„ë‹ˆë©´ ê·¸ ë°–ì˜ ë‹¤ë¥¸ ì§ˆë³‘ì— ëŒ€í•œ Abstractì¸ê°€?    

ë°ì´í„° í˜•ì‹     
* ```.tsv```í˜•ì‹ìœ¼ë¡œ ì €ì¥: ```.csv``` ì‰¼í‘œë¡œ êµ¬ë¶„ëœ í˜•ì‹ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ~~ì‰¼í‘œ~~ ëŒ€ì‹  **íƒ­**ì„ ì‚¬ìš©í•´ ì—´ì„ êµ¬ë¶„    
  
  
  
</div>
</details> 




**[ë°ì´í„° ê°€ì ¸ì˜¤ê¸°]**
ë¨¼ì € [pandas](https://yerimoh.github.io/PD/)ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ë³´ì    

<details>
<summary>ğŸ‘€ ë°ì´í„° í™•ì¸ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

ì“°ê³ ì‹¶ì€ ë°ì´í„°ë¥¼ ê°ì ê°€ì ¸ì˜¤ë©´ ëœë‹¤
```python
import pandas as pd
pd.options.display.max_colwidth = None
```
  
```python
train_df = pd.read_csv(TC_DATA_DIR + 'train.tsv', sep='\t')
train_df.head()
```


ê²°ê³¼
```
Identification of APC2, a homologue of the adenomatous polyposis coli tumour suppressor . The adenomatous polyposis coli ( APC ) tumour-suppressor protein controls the Wnt signalling pathway by forming a complex with glycogen synthase kinase 3beta ( GSK-3beta ) , axin / conductin and betacatenin . Complex formation induces the rapid degradation of betacatenin . In colon carcinoma cells , loss of APC leads to the accumulation of betacatenin in the nucleus , where it binds to and activates the Tcf-4 transcription factor ( reviewed in [ 1 ] [ 2 ] ) . Here , we report the identification and genomic structure of APC homologues . Mammalian APC2 , which closely resembles APC in overall domain structure , was functionally analyzed and shown to contain two SAMP domains , both of which are required for binding to conductin . Like APC , APC2 regulates the formation of active betacatenin-Tcf complexes , as demonstrated using transient transcriptional activation assays in APC - / - colon carcinoma cells . Human APC2 maps to chromosome 19p13 . 3 . APC and APC2 may therefore have comparable functions in development and cancer .	0

...
  
```
  
  
</div>
</details>



-----


## 2) fine tuning: NER ë°ì´í„° ì„¸íŠ¸
NER ì‘ì—…ì—ì„œëŠ” ìƒˆë¡œìš´ ì§ˆë¬¸ì„ í•  ê²ƒì…ë‹ˆë‹¤.    
â¡ ì˜í•™ Abstractì˜ ì£¼ì–´ì§„ ë¬¸ì¥ì—ì„œ **ì–´ë–¤ ì§ˆë³‘**ì´ ì–¸ê¸‰ë˜ì—ˆë‚˜ìš”?     
â¡ ì´ ê²½ìš° ë°ì´í„° ì…ë ¥ì€ Abstractì˜ ë¬¸ì¥ì´ë©° ë ˆì´ë¸”ì€ ëª…ëª…ëœ ì§ˆë³‘ ì—”í„°í‹°ì˜ ìœ„ì¹˜ì´ë‹¤.     

ë°ì´í„°ì„¸íŠ¸ì— ëŒ€í•´ ì œê³µëœ ì •ë³´ë¥¼ ì‚´í´ë³´ì.   


<details>
<summary>ğŸ‘€ ë°ì´í„° í™•ì¸ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

ì“°ê³ ì‹¶ì€ ë°ì´í„°ë¥¼ ê°ì ê°€ì ¸ì˜¤ë©´ ëœë‹¤
  
```python
NER_DATA_DIR = '/dli/task/data/NCBI_ner-3/'
!ls -lh $NER_DATA_DIR
```
  
ê²°ê³¼
```
total 4.0M
-rw-r--r-- 1 702112 10513  181K Jul 13  2020 dev.tsv
-rw-r--r-- 1 702112 10513     5 Jul 13  2020 label_ids.csv
-rw-r--r-- 1 702112 10513    52 Jul 13  2020 label_stats.tsv
-rw-r--r-- 1 702112 10513   48K Jul 13  2020 labels_dev.txt
-rw-r--r-- 1 702112 10513   49K Jul 13  2020 labels_test.txt
-rw-r--r-- 1 702112 10513  271K Jul 13  2020 labels_train.txt
-rw-r--r-- 1 702112 10513  185K Jul 13  2020 test.tsv
-rw-r--r-- 1 702112 10513  135K Jul 13  2020 text_dev.txt
-rw-r--r-- 1 702112 10513  138K Jul 13  2020 text_test.txt
-rw-r--r-- 1 702112 10513  758K Jul 13  2020 text_train.txt
-rw-r--r-- 1 702112 10513 1023K Jul 13  2020 train.tsv
-rw-r--r-- 1 702112 10513  1.2M Jul 13  2020 train_dev.tsv
```
 

NER ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ë©´ ë‘ ê°œì˜ íŒŒì¼ì´ í•„ìš”í•¨    
â¡ í…ìŠ¤íŠ¸ ë¬¸ì¥ê³¼ ë ˆì´ë¸” íŒŒì¼. ë‹¤ìŒ 2ê°œì˜ ì…€ì„ ì‹¤í–‰í•˜ì—¬ ì´ ë‘ íŒŒì¼ì˜ ìƒ˜í”Œì„ í™•ì¸í•¨    
```python
!head $NER_DATA_DIR/text_train.txt
```
  
ê²°ê³¼
```

Identification of APC2 , a homologue of the adenomatous polyposis coli tumour suppressor . 
The adenomatous polyposis coli ( APC ) tumour - suppressor protein controls the Wnt signalling pathway by forming a complex with glycogen synthase kinase 3beta ( GSK - 3beta ) , axin / conductin and betacatenin . 
Complex formation induces the rapid degradation of betacatenin . 
In colon carcinoma cells , loss of APC leads to the accumulation of betacatenin in the nucleus , where it binds to and activates the Tcf - 4 transcription factor ( reviewed in [ 1 ] [ 2 ] ) . 
Here , we report the identification and genomic structure of APC homologues . 
Mammalian APC2 , which closely resembles APC in overall domain structure , was functionally analyzed and shown to contain two SAMP domains , both of which are required for binding to conductin . 
Like APC , APC2 regulates the formation of active betacatenin - Tcf complexes , as demonstrated using transient transcriptional activation assays in APC - / - colon carcinoma cells . 
Human APC2 maps to chromosome 19p13 . 
3 . 
APC and APC2 may therefore have comparable functions in development and cancer . 
```

  
</div>
</details>


**[IOB íƒœê·¸ ì§€ì •]**    
Abstractì´ ë¬¸ì¥ë“¤ë¡œ ë‚˜ë‰˜ì–´ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ê° ë¬¸ì¥ì´ ì½”í¼ìŠ¤ì˜ ì›ë˜ HTML ìŠ¤íƒ€ì¼ íƒœê·¸ì— í•´ë‹¹í•˜ëŠ” ë ˆì´ë¸”ì´ ìˆëŠ” ë‹¨ì–´ë¡œ ì¶”ê°€ë¡œ êµ¬ë¬¸ ë¶„ì„ëœë‹¤     
* IOB: Inside, Outside, Beginning     
ì´í•´ê°€ ì•ˆëœë‹¤ë©´ ë„˜ì–´ê°€ë„ ê´œì°®ë‹¤

NER íŠ¸ë ˆì´ë‹ ë°ì´í„°ëŠ” ë‹¨ì–´ë¥¼ I, O, B(inside, outside, beginning)ì™€ ê°™ì€ íƒœê·¸ì— ë§¤í•‘í•˜ì—¬ ì—”í„°í‹°ë¥¼ ì‹ë³„í•˜ëŠ” ê²ƒì´ë‹¤.     

<details>
<summary>ğŸ‘€ ë°ì´í„° í™•ì¸ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

 
  
```python
!head $NER_DATA_DIR/labels_train.txt
```
ê²°ê³¼
```
O O O O O O O O B I I I O O 
O B I I I I I I O O O O O O O O O O O O O O O O O O O O O O O O O O O O O 
O O O O O O O O O 
O B I O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O 
O O O O O O O O O O O O O 
O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O 
O O O O O O O O O O O O O O O O O O O O O O O O O O B I O O 
O O O O O O O 
O O 
O O O O O O O O O O O B O 
```


ì¦‰ ì´ íƒœê·¸ë“¤ì´ ì´ëŸ°ì‹ìœ¼ë¡œ ì§€ì •ë˜ì–´ìˆë‹¤.
  

```
Identification of APC2 , a homologue of the adenomatous polyposis coli tumour suppressor .
O              O  O    O O O         O  O   B           I         I    I      O          O  
```
  
ê·¸ëŸ¬ë¯€ë¡œ ì›ë˜ ì½”í¼ìŠ¤ íƒœê·¸ë¡œ ì¬ í˜¸ì¶œí•˜ë©´,    

```html
Identification of APC2, a homologue of the <category="Modifier">adenomatous polyposis coli tumour</category> suppressor .
``

  
</div>
</details>


----
------

# **1) pretraining: í…ìŠ¤íŠ¸ ë¶„ë¥˜ êµ¬ì¶•**             
**[ëª©í‘œ]**        
ì˜í•™ì  ì§ˆë³‘ abstractë¥¼ ê°ê° ì•” ì§ˆí™˜, ì‹ ê²½ ì§ˆí™˜ ë° ì¥ì• , ê·¸ë¦¬ê³  ê¸°íƒ€ì˜ ì„¸ê°€ì§€ ë¶„ë¥˜ ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒ.       


## NeMo ê°œìš”
NeMoëŠ” ëŒ€í™”í˜• AI ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì˜¤í”Œ ì†ŒìŠ¤ íˆ´í‚·ì…ë‹ˆë‹¤.    
* NeMoëŠ” Neural Modulesì„ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì¶•ë˜ì–´, **ìœ í˜•í™”ëœ ì…ë ¥**ì„ ë°›ì•„ **ìœ í˜•í™”ëœ ì•„ì›ƒí’‹**ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ì˜ ê°œë… ë¸”ë¡(conceptual blocks)ìœ¼ë¡œ ë˜ì–´ ìˆìŒ.      
* ëª¨ë“ˆ: ë ˆì´ì–´, ì¸ì½”ë”, ë””ì½”ë”, ì–¸ì–´ ëª¨ë¸, ì†ì‹¤ í•¨ìˆ˜, ë˜ëŠ” ê²°í•©ëœ ì•¡í‹°ë² ì´ì…˜ ë°©ë²•    

NeMoëŠ” ì´ëŸ¬í•œ ë¹Œë”© ë¸”ë¡ë“¤ì„ **ê²°í•©**í•˜ê³  **ì¬ì‚¬ìš©í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ë©´**ì„œ Neural Type ì‹œìŠ¤í…œì„ í†µí•´ **ì˜ë¯¸ë¡ ì  ì •í™•ë„ ê²€ì‚¬**(a level of semantic correctness checking)ë¥¼ ì œê³µ    


[NeMo ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬]
ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ íŠ¸ë ˆì´ë‹ì„ ìœ„í•œ PyTorch ì½”ë“œë¥¼ ì •ë¦¬í•œ Pytorch wrapperì¸ Pytorch Lightningì— ê¸°ë°˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. PyTorch Lightningì€ ì‰½ê³  ê³ ì„±ëŠ¥ì˜ ë©€í‹°-GPU/ë©€í‹°-ë…¸íŠ¸ í˜¼í•© ì •ë°€ íŠ¸ë ˆì´ë‹(mixed precision training) ì˜µì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. ë”¥ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ í”„ë¡œì íŠ¸ ë˜ëŠ” **experiment(ì‹¤í—˜)**ì„ ë§Œë“¤ë ¤ë©´, ë‘ ê°€ì§€ ì£¼ìš” êµ¬ì„± ìš”ì†Œê°€ í•„ìš”í•©ë‹ˆë‹¤.:

LightningModule(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ)
Trainer(íŠ¸ë ˆì´ë„ˆ)
LightningModule(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ) ì€ íŠ¸ë ˆì´ë‹, ìœ íš¨ì„± ê²€ì‚¬, í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì—°ì‚°, ì˜µí‹°ë§ˆì´ì €, ë£¨í”„ ë¬¸ìœ¼ë¡œ PyTorch ì½”ë“œë¡œ êµ¬ì„±í•˜ëŠ”ë° í™œìš©í•©ë‹ˆë‹¤. ì´ ì¶”ìƒí™” ê¸°ë²•ì€ ë”¥ ëŸ¬ë‹ ì‹¤í—˜ì„ ì´í•´í•˜ê³  ì¬ìƒì‚°í•˜ê¸° ë” ì‰½ê²Œ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.

ê·¸ë¦¬ê³  Trainer(íŠ¸ë ˆì´ë„ˆ) ëŠ” LightningModule(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ)ì„ ê°€ì§€ê³  ì˜¬ ìˆ˜ ìˆìœ¼ë©° ë”¥ ëŸ¬ë‹ íŠ¸ë ˆì´ë‹ì„ ìœ„í•´ í•„ìš”í•œ ëª¨ë“  ê²ƒì„ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2.1.1 NeMo ëª¨ë¸
NeMo ëª¨ë¸ì€ íŠ¸ë ˆì´ë‹ê³¼ ì¬í˜„ì„±ì„ ìœ„í•œ ëª¨ë“  ì§€ì› ì¸í”„ë¼ë¥¼ ê°–ì¶˜ LightningModules(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ) ì…ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ë”¥ ëŸ¬ë‹ ëª¨ë¸ ì•„í‚¤í…ì²˜, ë°ì´í„° ì‚¬ì „ ì²˜ë¦¬, ì˜µí‹°ë§ˆì´ì €, ì²´í¬í¬ì¸íŠ¸ì™€ ì‹¤í—˜ ë¡œê¹… ê¸°ëŠ¥ì´ í¬í•¨ë©ë‹ˆë‹¤. NeMo ëª¨ë¸ì€ ë¼ì´íŠ¸ë‹ëª¨ë“ˆê³¼ ê°™ì´ PyTorch ëª¨ë“ˆì´ë©° ë” ë„“ì€ PyTorch ìƒíƒœê³„ì™€ ì™„ë²½í•˜ê²Œ í˜¸í™˜ë©ë‹ˆë‹¤. ì–´ë–¤ NeMo modelë„ ëª¨ë“  PyTorch ì›Œí¬í”Œë¡œìš°ì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ëª¨ë“  NeMo ëª¨ë¸ì˜ ì˜ˆì œ Configuration íŒŒì¼ê³¼ íŠ¸ë ˆì´ë‹ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒ NVIDIA NeMo GitHub Repoì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë²ˆ ìˆ˜ì—…ì„ ìœ„í•´ì„œ, NGC NeMo containerì— ê¸°ë°˜í•œ ì‹¤ìŠµ í™˜ê²½ì— í¬í•¨ëœ ë¡œì»¬ repo ë³µì‚¬ë³¸ë¥¼ ì´ìš©í•  ê³„íšì´ë©° NLP ëª¨ë¸ì— ì§‘ì¤‘í•©ë‹ˆë‹¤. ë‹¤ìŒ ì…€ì„ ì‹¤í–‰í•˜ì—¬ examples/nlp ë””ë ‰í† ë¦¬ì— ìˆëŠ” NeMo ëª¨ë¸ íŠ¸ë¦¬ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

!tree nemo/examples/nlp -L 2
í´ë˜ì‹í•œ NLP íƒœìŠ¤í¬ë¥¼ ë‹¤ë£¨ëŠ” ì—¬ëŸ¬ ëª¨ë¸ì´ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ë…¸íŠ¸ë¶ì—ì„œëŠ” í…ìŠ¤íŠ¸ ë¶„ë¥˜ì— ëŒ€í•´ ì´ˆì ì„ ë§ì¶œ ì˜ˆì •ì´ë©°, ë‹¤ìŒì— ìˆì„ ëª…ëª…ëœ ì—”í‹°í‹° ì¸ì‹(NER) ë…¸íŠ¸ë¶ì—ì„œëŠ” í† í° ë¶„ë¥˜ ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì‹¤ìŠµì„ ì§„í–‰í•  ì˜ˆì •ì…ë‹ˆë‹¤.

ê°ê°ì˜ NeMo ëª¨ë¸ íƒ€ì…ì€ í™˜ê²½ êµ¬ì„± íŒŒì¼ì— ëŒ€í•œ conf í´ë”ì™€ í•˜ë‚˜ ì´ìƒì˜ Python íŠ¸ë ˆì´ë‹ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

í…ìŠ¤íŠ¸ ë¶„ë¥˜ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ ë³´ë ¤ë©´ ë‹¤ìŒ ì…€ì„ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤:

TC_DIR = "/dli/task/nemo/examples/nlp/text_classification"
!tree $TC_DIR
í™˜ê²½ íŒŒì¼ text_classification_config.yamlì—ì„œëŠ” íŒŒì¼ ìœ„ì¹˜, ì‚¬ì „ í›ˆë ¨ëœ ëª¨ë¸, í•˜ì´í¼ íŒŒë¼ë¯¸í„°ì™€ ê°™ì€ ëª¨ë¸, íŠ¸ë ˆì´ë‹, ì‹¤í—˜ ê´€ë¦¬ë¥¼ ìœ„í•œ ì„¸ë¶€ ì •ë³´ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.

Python ìŠ¤í¬ë¦½íŠ¸ text_classification_with_bert.pyëŠ” í™˜ê²½ íŒŒì¼ì—ì„œ ì •ì˜ëœ í…ìŠ¤íŠ¸ ë¶„ë¥˜ ì‹¤í—˜ì„ ì§„í–‰í•˜ëŠ”ë° í•„ìš”í•œ ëª¨ë“  ê²ƒì„ ìº¡ìŠí™”í•˜ê³  ìˆìŠµë‹ˆë‹¤. Configuration(í™˜ê²½ ì„¤ì •) ê´€ë¦¬ë¥¼ ìœ„í•´ í˜ì´ìŠ¤ë¶ì˜ Hydra ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¤ë§¨ë“œ ë¼ì¸ ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ êµ¬ì„± ê°’ì„ ì¬ì •ì˜í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜ ì „ì²´ ì‹¤í—˜ì„ ì§„í–‰í• ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤!

ì‹¤í—˜ì„ ì‹ ì†í•˜ê²Œ êµ¬ì¶•í•˜ëŠ” ë¹„ê²°ì€ ê¸°ë³¸ êµ¬ì„± íŒŒì¼ì— í¬í•¨ëœ ë‚´ìš©ê³¼ ì—¬ëŸ¬ë¶„ì˜ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•´ ë³€ê²½í•´ì•¼í•˜ëŠ” ë‚´ìš©ì„ ì •í™•íˆ ì´í•´í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.































---
title: "Deep learning: NeMoë¥¼ í†µí•œ BERT êµ¬í˜„, ì½”ë“œ ì„¤ëª…"
date:   2020-01-17
excerpt: "LightningModules(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ)"
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---


# ëª©ì°¨



----
---

ğŸ‘€, ğŸ¤·â€â™€ï¸ , ğŸ“œ    
ì´ ì•„ì´ì½˜ë“¤ì„ ëˆ„ë¥´ì‹œë©´ ì½”ë“œ, ê°œë… ë¶€ê°€ ì„¤ëª…ì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:)

---
----


# INRTO
ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„  NVIDIAì˜ NeMoë¥¼ ì¨ì„œ bertë¥¼ ì‚¬ìš©í•´ ë³¼ ê²ƒì´ë‹¤

**[ëª©í‘œ]**              
ì‚¬ì „ íŠ¸ë ˆì´ë‹ëœ ëŒ€ê·œëª¨ ê³ ì„±ëŠ¥ Transformer ê¸°ë°˜ ì–¸ì–´ ëª¨ë¸í˜ ì‚¬ìš©í•˜ì—¬ NLP ì‘ì—…,   
* **0) ë°ì´í„° ì‚´í´ë³´ê¸°**: NCBI ì§ˆë³‘ ì–¸ì–´ ìë£Œì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ì„¸íŠ¸ë¥¼ ì‚¬ìš©     
* **1) pretraining:** í…ìŠ¤íŠ¸ ë¶„ë¥˜        
* **2) fine tuning:** NER(ëª…ëª…ëœ ì—”í„°í‹° ì¸ì‹)êµ¬ì¶•   





**[ì½ê¸° ìœ„í•´ í•„ìš”í•œ ì§€ì‹]**    
* [attention](https://yerimoh.github.io/DL19/)             
* [transformer](https://yerimoh.github.io/Lan/): ì •ë§ ë¬´ì¡°ê±´ë¬´ì¡°ê±´ ì •ë…í•˜ì ì´ê±° ì½ê³ ì˜¤ë©´ ì´ë²ˆ í¬ìŠ¤íŠ¸ëŠ” ê»Œì´ë‹¤.            
* [bert](https://yerimoh.github.io/Lan2/)    

**[ì› ë…¼ë¬¸]**          
[Attention is All You Need](https://arxiv.org/abs/1706.03762)              
[bert](https://arxiv.org/pdf/1810.04805.pdf)              
  
      
**[ì°¸ê³ ìë£Œ]**     
[NEMO github](https://colab.research.google.com/github/NVIDIA/NeMo/blob/stable/tutorials/nlp/Text_Classification_Sentiment_Analysis.ipynb)


---
---

# **0) ë°ì´í„° ì‚´í´ë³´ê¸°**
**[Corpus Annotated Data]**     
14ëª…ì˜ ì£¼ì„ìê°€ ì–´ë…¸í…Œì´ì…˜ì„ ì§„í–‰ í•œ ë‹¨ 793ê°œì˜ PubMed Abstract      
ëª…í™•í•˜ê²Œ ì •ì˜ëœ ê·œì¹™ì„ ì‚¬ìš©í•´ Abstract í…ìŠ¤íŠ¸ì— ì‚½ì…ë˜ëŠ” HTML ìŠ¤íƒ€ì¼ íƒœê·¸ì˜ í˜•ì‹ì„ ì§€ë‹˜     

**ë‹¤ë¥¸ ë°ì´í„°ì— ì ìš©ì„í•´ë³´ë ¤ë©´ ê·¸ ë°ì´í„°ë¥¼ ë¡œë“œí•˜ë©´ ëœë‹¤**

-----



## 1) pretraining: í…ŒìŠ¤íŠ¸ ë¶„ë¥˜ ë°ì´í„° ì„¸íŠ¸
í…ìŠ¤íŠ¸ì˜ ë‚´ìš©ì— ë”°ë¼ í…ìŠ¤íŠ¸ë¥¼ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.       
í…ìŠ¤íŠ¸ ë¶„ë¥˜ ì ìš© ì˜ˆ    
* ê°ì •ë¶„ì„: 2ê°œì˜ í´ë˜ìŠ¤      
* ì£¼ì œ ë ˆì´ë¸” ì§€ì •: ì—¬ëŸ¬í´ë˜ìŠ¤     
í•„ìš”í•œ ë°ì´í„° ì„¸íŠ¸ë¥¼ ì´í•´í•˜ë ¤ë©´ í•˜ê³ ì‹¶ì€ ì§ˆë¬¸ì´ ë­”ì§€ë¶€í„° ì •í•´ì•¼í•œë‹¤.        



<details>
<summary>ğŸ“œ ê°ì •ë¶„ì„ </summary>
<div markdown="1">

ì´ì§„ë¶„ë¥˜ì„(2ê°œì˜ í´ë˜ìŠ¤)    
* ê°ì •ì´ ê¸ì •ì ì¸ê°€      
* ê°ì •ì´ ë¶€ì •ì ì¸ê°€ 
  
ì¦‰ ê° ë¬¸ì¥ì— ì´ ë‘ê°€ì§€ ì¤‘ í•˜ë‚˜ë¡œ ë ˆì´ë¸”ì„ ì§€ì •í•´ì•¼í•œë‹¤.        
  
â¡ ê¸°ì—…ë“¤ì´ ì˜¨ë¼ì¸ ëŒ€í™”ì™€ í”¼ë“œë°±ì—ì„œ ì œí’ˆ, ë¸Œëœë“œ ë˜ëŠ” ì„œë¹„ìŠ¤ì— ëŒ€í•œ ê³ ê°ì˜ ê°ì •ì„ íŒŒì•…í•˜ëŠ” ë° ë„ë¦¬ ì‚¬ìš©ë¨    
  
</div>
</details> 

<details>
<summary>ğŸ“œ ì£¼ì œë ˆì´ë¸” ì§€ì • </summary>
<div markdown="1">

ë‹¤ì¤‘ë¶„ë¥˜ì„(Multi-Class Analysis)    
* ex) ì£¼ì–´ì§„ ì˜í•™ ì§ˆë³‘ Abstractì€ ì•” ë˜ëŠ” ì‹ ê²½ê³„ ì§ˆí™˜, ì•„ë‹ˆë©´ ê·¸ ë°–ì˜ ë‹¤ë¥¸ ì§ˆë³‘ì— ëŒ€í•œ Abstractì¸ê°€?    

ë°ì´í„° í˜•ì‹     
* ```.tsv```í˜•ì‹ìœ¼ë¡œ ì €ì¥: ```.csv``` ì‰¼í‘œë¡œ êµ¬ë¶„ëœ í˜•ì‹ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ~~ì‰¼í‘œ~~ ëŒ€ì‹  **íƒ­**ì„ ì‚¬ìš©í•´ ì—´ì„ êµ¬ë¶„    
  
  
  
</div>
</details> 




**[ë°ì´í„° ê°€ì ¸ì˜¤ê¸°]**
ë¨¼ì € [pandas](https://yerimoh.github.io/PD/)ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ë³´ì    

<details>
<summary>ğŸ‘€ ë°ì´í„° í™•ì¸ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

ì“°ê³ ì‹¶ì€ ë°ì´í„°ë¥¼ ê°ì ê°€ì ¸ì˜¤ë©´ ëœë‹¤
```python
import pandas as pd
pd.options.display.max_colwidth = None
```
  
```python
train_df = pd.read_csv(TC_DATA_DIR + 'train.tsv', sep='\t')
train_df.head()
```


ê²°ê³¼
```
Identification of APC2, a homologue of the adenomatous polyposis coli tumour suppressor . The adenomatous polyposis coli ( APC ) tumour-suppressor protein controls the Wnt signalling pathway by forming a complex with glycogen synthase kinase 3beta ( GSK-3beta ) , axin / conductin and betacatenin . Complex formation induces the rapid degradation of betacatenin . In colon carcinoma cells , loss of APC leads to the accumulation of betacatenin in the nucleus , where it binds to and activates the Tcf-4 transcription factor ( reviewed in [ 1 ] [ 2 ] ) . Here , we report the identification and genomic structure of APC homologues . Mammalian APC2 , which closely resembles APC in overall domain structure , was functionally analyzed and shown to contain two SAMP domains , both of which are required for binding to conductin . Like APC , APC2 regulates the formation of active betacatenin-Tcf complexes , as demonstrated using transient transcriptional activation assays in APC - / - colon carcinoma cells . Human APC2 maps to chromosome 19p13 . 3 . APC and APC2 may therefore have comparable functions in development and cancer .	0

...
  
```
  
  
</div>
</details>



-----


## 2) fine tuning: NER ë°ì´í„° ì„¸íŠ¸
NER ì‘ì—…ì—ì„œëŠ” ìƒˆë¡œìš´ ì§ˆë¬¸ì„ í•  ê²ƒì…ë‹ˆë‹¤.    
â¡ ì˜í•™ Abstractì˜ ì£¼ì–´ì§„ ë¬¸ì¥ì—ì„œ **ì–´ë–¤ ì§ˆë³‘**ì´ ì–¸ê¸‰ë˜ì—ˆë‚˜ìš”?     
â¡ ì´ ê²½ìš° ë°ì´í„° ì…ë ¥ì€ Abstractì˜ ë¬¸ì¥ì´ë©° ë ˆì´ë¸”ì€ ëª…ëª…ëœ ì§ˆë³‘ ì—”í„°í‹°ì˜ ìœ„ì¹˜ì´ë‹¤.     

ë°ì´í„°ì„¸íŠ¸ì— ëŒ€í•´ ì œê³µëœ ì •ë³´ë¥¼ ì‚´í´ë³´ì.   


<details>
<summary>ğŸ‘€ ë°ì´í„° í™•ì¸ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

ì“°ê³ ì‹¶ì€ ë°ì´í„°ë¥¼ ê°ì ê°€ì ¸ì˜¤ë©´ ëœë‹¤
  
```python
NER_DATA_DIR = '/dli/task/data/NCBI_ner-3/'
!ls -lh $NER_DATA_DIR
```
  
ê²°ê³¼
```
total 4.0M
-rw-r--r-- 1 702112 10513  181K Jul 13  2020 dev.tsv
-rw-r--r-- 1 702112 10513     5 Jul 13  2020 label_ids.csv
-rw-r--r-- 1 702112 10513    52 Jul 13  2020 label_stats.tsv
-rw-r--r-- 1 702112 10513   48K Jul 13  2020 labels_dev.txt
-rw-r--r-- 1 702112 10513   49K Jul 13  2020 labels_test.txt
-rw-r--r-- 1 702112 10513  271K Jul 13  2020 labels_train.txt
-rw-r--r-- 1 702112 10513  185K Jul 13  2020 test.tsv
-rw-r--r-- 1 702112 10513  135K Jul 13  2020 text_dev.txt
-rw-r--r-- 1 702112 10513  138K Jul 13  2020 text_test.txt
-rw-r--r-- 1 702112 10513  758K Jul 13  2020 text_train.txt
-rw-r--r-- 1 702112 10513 1023K Jul 13  2020 train.tsv
-rw-r--r-- 1 702112 10513  1.2M Jul 13  2020 train_dev.tsv
```
 

NER ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ë©´ ë‘ ê°œì˜ íŒŒì¼ì´ í•„ìš”í•¨    
â¡ í…ìŠ¤íŠ¸ ë¬¸ì¥ê³¼ ë ˆì´ë¸” íŒŒì¼. ë‹¤ìŒ 2ê°œì˜ ì…€ì„ ì‹¤í–‰í•˜ì—¬ ì´ ë‘ íŒŒì¼ì˜ ìƒ˜í”Œì„ í™•ì¸í•¨    
```python
!head $NER_DATA_DIR/text_train.txt
```
  
ê²°ê³¼
```

Identification of APC2 , a homologue of the adenomatous polyposis coli tumour suppressor . 
The adenomatous polyposis coli ( APC ) tumour - suppressor protein controls the Wnt signalling pathway by forming a complex with glycogen synthase kinase 3beta ( GSK - 3beta ) , axin / conductin and betacatenin . 
Complex formation induces the rapid degradation of betacatenin . 
In colon carcinoma cells , loss of APC leads to the accumulation of betacatenin in the nucleus , where it binds to and activates the Tcf - 4 transcription factor ( reviewed in [ 1 ] [ 2 ] ) . 
Here , we report the identification and genomic structure of APC homologues . 
Mammalian APC2 , which closely resembles APC in overall domain structure , was functionally analyzed and shown to contain two SAMP domains , both of which are required for binding to conductin . 
Like APC , APC2 regulates the formation of active betacatenin - Tcf complexes , as demonstrated using transient transcriptional activation assays in APC - / - colon carcinoma cells . 
Human APC2 maps to chromosome 19p13 . 
3 . 
APC and APC2 may therefore have comparable functions in development and cancer . 
```

  
</div>
</details>


**[IOB íƒœê·¸ ì§€ì •]**    
Abstractì´ ë¬¸ì¥ë“¤ë¡œ ë‚˜ë‰˜ì–´ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ê° ë¬¸ì¥ì´ ì½”í¼ìŠ¤ì˜ ì›ë˜ HTML ìŠ¤íƒ€ì¼ íƒœê·¸ì— í•´ë‹¹í•˜ëŠ” ë ˆì´ë¸”ì´ ìˆëŠ” ë‹¨ì–´ë¡œ ì¶”ê°€ë¡œ êµ¬ë¬¸ ë¶„ì„ëœë‹¤     
* IOB: Inside, Outside, Beginning     
ì´í•´ê°€ ì•ˆëœë‹¤ë©´ ë„˜ì–´ê°€ë„ ê´œì°®ë‹¤

NER íŠ¸ë ˆì´ë‹ ë°ì´í„°ëŠ” ë‹¨ì–´ë¥¼ I, O, B(inside, outside, beginning)ì™€ ê°™ì€ íƒœê·¸ì— ë§¤í•‘í•˜ì—¬ ì—”í„°í‹°ë¥¼ ì‹ë³„í•˜ëŠ” ê²ƒì´ë‹¤.     

<details>
<summary>ğŸ‘€ ë°ì´í„° í™•ì¸ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

 
  
```python
!head $NER_DATA_DIR/labels_train.txt
```
ê²°ê³¼
```
O O O O O O O O B I I I O O 
O B I I I I I I O O O O O O O O O O O O O O O O O O O O O O O O O O O O O 
O O O O O O O O O 
O B I O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O 
O O O O O O O O O O O O O 
O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O 
O O O O O O O O O O O O O O O O O O O O O O O O O O B I O O 
O O O O O O O 
O O 
O O O O O O O O O O O B O 
```


ì¦‰ ì´ íƒœê·¸ë“¤ì´ ì´ëŸ°ì‹ìœ¼ë¡œ ì§€ì •ë˜ì–´ìˆë‹¤.
  

```
Identification of APC2 , a homologue of the adenomatous polyposis coli tumour suppressor .
O              O  O    O O O         O  O   B           I         I    I      O          O  
```
  
ê·¸ëŸ¬ë¯€ë¡œ ì›ë˜ ì½”í¼ìŠ¤ íƒœê·¸ë¡œ ì¬ í˜¸ì¶œí•˜ë©´,    

```html
Identification of APC2, a homologue of the <category="Modifier">adenomatous polyposis coli tumour</category> suppressor .
``

  
</div>
</details>


----
------

# **1) pretraining: í…ìŠ¤íŠ¸ ë¶„ë¥˜ êµ¬ì¶•**             
**[ëª©í‘œ]**        
ì˜í•™ì  ì§ˆë³‘ abstractë¥¼ ê°ê° ì•” ì§ˆí™˜, ì‹ ê²½ ì§ˆí™˜ ë° ì¥ì• , ê·¸ë¦¬ê³  ê¸°íƒ€ì˜ ì„¸ê°€ì§€ ë¶„ë¥˜ ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒ.       


## NeMo ê°œìš”
NeMoëŠ” ëŒ€í™”í˜• AI ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì˜¤í”Œ ì†ŒìŠ¤ íˆ´í‚·ì…ë‹ˆë‹¤.    
* NeMoëŠ” Neural Modulesì„ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì¶•ë˜ì–´, **ìœ í˜•í™”ëœ ì…ë ¥**ì„ ë°›ì•„ **ìœ í˜•í™”ëœ ì•„ì›ƒí’‹**ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ì˜ ê°œë… ë¸”ë¡(conceptual blocks)ìœ¼ë¡œ ë˜ì–´ ìˆìŒ.      
* ëª¨ë“ˆ: ë ˆì´ì–´, ì¸ì½”ë”, ë””ì½”ë”, ì–¸ì–´ ëª¨ë¸, ì†ì‹¤ í•¨ìˆ˜, ë˜ëŠ” ê²°í•©ëœ ì•¡í‹°ë² ì´ì…˜ ë°©ë²•    

NeMoëŠ” ì´ëŸ¬í•œ ë¹Œë”© ë¸”ë¡ë“¤ì„ **ê²°í•©**í•˜ê³  **ì¬ì‚¬ìš©í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ë©´**ì„œ Neural Type ì‹œìŠ¤í…œì„ í†µí•´ **ì˜ë¯¸ë¡ ì  ì •í™•ë„ ê²€ì‚¬**(a level of semantic correctness checking)ë¥¼ ì œê³µ    


**[NeMo ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬]**    
[í”„ë ˆì„ ì›Œí¬ë€?](https://yerimoh.github.io/DL108/#%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC)     
* [PyTorch Lightning](https://github.com/PyTorchLightning/pytorch-lightning): ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ íŠ¸ë ˆì´ë‹ì„ ìœ„í•œ PyTorch ì½”ë“œë¥¼ ì •ë¦¬í•œ Pytorch wrapper
     * ì‰½ê³  ê³ ì„±ëŠ¥ì˜ ë©€í‹°-GPU/ë©€í‹°-ë…¸íŠ¸ í˜¼í•© ì •ë°€ íŠ¸ë ˆì´ë‹(mixed precision training) ì˜µì…˜ì„ ì œê³µ.      
     * [LightningModule(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ)](https://github.com/PyTorchLightning/pytorch-lightning)          
     *  íŠ¸ë ˆì´ë‹, ìœ íš¨ì„± ê²€ì‚¬, í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì—°ì‚°, ì˜µí‹°ë§ˆì´ì €, ë£¨í”„ ë¬¸ìœ¼ë¡œ PyTorch ì½”ë“œë¡œ êµ¬ì„±í•˜ëŠ”ë° í™œìš©          
     *  ë”¥ ëŸ¬ë‹ ì‹¤í—˜ì„ ì´í•´í•˜ê³  ì¬ìƒì‚°í•˜ê¸° ë” ì‰½ê²Œ ë§Œë“¤ì–´ì¤Œ
* [Trainer(íŠ¸ë ˆì´ë„ˆ)](https://pytorch-lightning.readthedocs.io/en/stable/common/trainer.html)    
   * LightningModule(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ)ì„ ê°€ì§€ê³  ì˜¬ ìˆ˜ ìˆìœ¼ë©° ë”¥ ëŸ¬ë‹ íŠ¸ë ˆì´ë‹ì„ ìœ„í•´ í•„ìš”í•œ ëª¨ë“  ê²ƒì„ ìë™í™” ê°€ëŠ¥         


**[NeMo ëª¨ë¸]**        
NeMo ëª¨ë¸ì€ íŠ¸ë ˆì´ë‹ê³¼ ì¬í˜„ì„±ì„ ìœ„í•œ ëª¨ë“  ì§€ì› ì¸í”„ë¼ë¥¼ ê°–ì¶˜ LightningModules(ë¼ì´íŠ¸ë‹ëª¨ë“ˆ) ì…ë‹ˆë‹¤.        
(ê¸°ëŠ¥)      
* ë”¥ ëŸ¬ë‹ ëª¨ë¸ ì•„í‚¤í…ì²˜    
* ë°ì´í„° ì‚¬ì „ ì²˜ë¦¬     
* ì˜µí‹°ë§ˆì´ì €     
* ì²´í¬í¬ì¸íŠ¸      
* ì‹¤í—˜ ë¡œê¹… ê¸°ëŠ¥        

NeMo ëª¨ë¸ì€ ë¼ì´íŠ¸ë‹ëª¨ë“ˆê³¼ ê°™ì´ PyTorch ëª¨ë“ˆì´ë©° ë” ë„“ì€ PyTorch ìƒíƒœê³„ì™€ ì™„ë²½í•˜ê²Œ í˜¸í™˜ë¨.      
ì–´ë–¤ NeMo modelë„ ëª¨ë“  PyTorch ì›Œí¬í”Œë¡œìš°ì— ì—°ê²°ê°€ëŠ¥      



ì´ í¬ìŠ¤íŠ¸ì—ì„ , NGC NeMo containerì— ê¸°ë°˜í•œ ì‹¤ìŠµ í™˜ê²½ì— í¬í•¨ëœ ë¡œì»¬ repo ë³µì‚¬ë³¸ë¥¼ ì´ìš©í•  ê³„íšì´ë©° NLP ëª¨ë¸ì— ì§‘ì¤‘í•  ì˜ˆì¥ì„.       

ë‹¤ìŒ ì…€ì„ ì‹¤í–‰í•˜ì—¬ examples/nlp ë””ë ‰í† ë¦¬ì— ìˆëŠ” NeMo ëª¨ë¸ íŠ¸ë¦¬ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

í™•ì¸ì´ ì•ˆë˜ë©´ ê·¸ëƒ¥ ë„˜ì–´ê°€ë„ ìƒê´€ ì—†ë‹¤
```python
!tree nemo/examples/nlp -L 2
```
ê²°ê³¼
```python
nemo/examples/nlp
â”œâ”€â”€ dialogue_state_tracking
â”‚   â”œâ”€â”€ conf
â”‚   â””â”€â”€ sgd_qa.py
â”œâ”€â”€ entity_linking
â”‚   â”œâ”€â”€ build_index.py
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ data
â”‚   â”œâ”€â”€ query_index.py
â”‚   â””â”€â”€ self_alignment_pretraining.py
â”œâ”€â”€ glue_benchmark
â”‚   â”œâ”€â”€ glue_benchmark.py
â”‚   â””â”€â”€ glue_benchmark_config.yaml
â”œâ”€â”€ information_retrieval
â”‚   â”œâ”€â”€ bert_dpr.py
â”‚   â”œâ”€â”€ bert_joint_ir.py
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ construct_random_negatives.py
â”‚   â””â”€â”€ get_msmarco.sh
â”œâ”€â”€ intent_slot_classification
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ data
â”‚   â””â”€â”€ intent_slot_classification.py
â”œâ”€â”€ language_modeling
â”‚   â”œâ”€â”€ bert_pretraining.py
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ convert_weights_to_nemo1.0.py
â”‚   â”œâ”€â”€ get_wkt2.sh
â”‚   â””â”€â”€ transformer_lm.py
â”œâ”€â”€ machine_translation
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ create_tarred_monolingual_dataset.py
â”‚   â”œâ”€â”€ create_tarred_parallel_dataset.py
â”‚   â”œâ”€â”€ enc_dec_nmt.py
â”‚   â”œâ”€â”€ nmt_transformer_infer.py
â”‚   â”œâ”€â”€ nmt_webapp
â”‚   â”œâ”€â”€ preprocess_dataset.py
â”‚   â””â”€â”€ translate_ddp.py
â”œâ”€â”€ question_answering
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ get_squad.py
â”‚   â””â”€â”€ question_answering_squad.py
â”œâ”€â”€ text2sparql
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ data
â”‚   â”œâ”€â”€ evaluate_text2sparql.py
â”‚   â””â”€â”€ text2sparql.py
â”œâ”€â”€ text_classification
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ data
â”‚   â”œâ”€â”€ model_parallel_text_classification_evaluation.py
â”‚   â””â”€â”€ text_classification_with_bert.py
â””â”€â”€ token_classification
    â”œâ”€â”€ conf
    â”œâ”€â”€ data
    â”œâ”€â”€ punctuation_capitalization_evaluate.py
    â”œâ”€â”€ punctuation_capitalization_train.py
    â”œâ”€â”€ token_classification_evaluate.py
    â””â”€â”€ token_classification_train.py
27 directories, 31 files
```
í´ë˜ì‹í•œ NLP íƒœìŠ¤í¬ë¥¼ ë‹¤ë£¨ëŠ” ì—¬ëŸ¬ ëª¨ë¸ì„ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.       
ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” í…ìŠ¤íŠ¸ ë¶„ë¥˜ì— ëŒ€í•´ ì´ˆì ì„ ë§ì¶œ ì˜ˆì •ì´ë©°, ë‹¤ìŒì— ìˆì„ ëª…ëª…ëœ ì—”í‹°í‹° ì¸ì‹(NER) ë…¸íŠ¸ë¶ì—ì„œëŠ” í† í° ë¶„ë¥˜ ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì‹¤ìŠµì„ ì§„í–‰í•  ì˜ˆì •ì´ë‹¤.

  
  
</div>
</details>



<details>
<summary>ğŸ‘€ í…ìŠ¤íŠ¸ ë¶„ë¥˜ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš© í™•ì¸ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
í™•ì¸ì´ ì•ˆë˜ì–´ë„ ê´œì°®ë‹¤.
  
```python
TC_DIR = "/dli/task/nemo/examples/nlp/text_classification"
!tree $TC_DIR
```
```python
/dli/task/nemo/examples/nlp/text_classification
â”œâ”€â”€ conf
â”‚   â””â”€â”€ text_classification_config.yaml
â”œâ”€â”€ data
â”‚   â””â”€â”€ import_datasets.py
â”œâ”€â”€ model_parallel_text_classification_evaluation.py
â””â”€â”€ text_classification_with_bert.py
```
2 directories, 4 files  
  
í™˜ê²½ íŒŒì¼ ```text_classification_config.yaml```      
* íŒŒì¼ ìœ„ì¹˜, ì‚¬ì „ í›ˆë ¨ëœ ëª¨ë¸, í•˜ì´í¼ íŒŒë¼ë¯¸í„°ì™€ ê°™ì€ ëª¨ë¸, íŠ¸ë ˆì´ë‹, ì‹¤í—˜ ê´€ë¦¬ë¥¼ ìœ„í•œ ì„¸ë¶€ ì •ë³´ë¥¼ ì§€ì •

Python ìŠ¤í¬ë¦½íŠ¸ ```text_classification_with_bert.py```        
* í™˜ê²½ íŒŒì¼ì—ì„œ ì •ì˜ëœ í…ìŠ¤íŠ¸ ë¶„ë¥˜ ì‹¤í—˜ì„ ì§„í–‰í•˜ëŠ”ë° í•„ìš”í•œ ëª¨ë“  ê²ƒì„ ìº¡ìŠí™”í•¨       
* Configuration(í™˜ê²½ ì„¤ì •) ê´€ë¦¬ë¥¼ ìœ„í•´ í˜ì´ìŠ¤ë¶ì˜ Hydra ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¤ë§¨ë“œ ë¼ì¸ ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ êµ¬ì„± ê°’ì„ ì¬ì •ì˜í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜ ì „ì²´ ì‹¤í—˜ì„ ì§„í–‰í• ìˆ˜ ìˆë„ë¡ í•¨.
  
  
</div>
</details>


-----


## ì»¤ë§¨ë“œ ë¼ì¸ì—ì„œì˜ í…ìŠ¤íŠ¸ ë¶„ë¥˜

**[ëª©í‘œ]**
ì´ë²ˆ ì‹¤ìŠµì—ì„œ ë‹µë³€í•˜ê³ ì í•˜ëŠ” ì§ˆë¬¸ì€ 3ê°œì˜ ë“±ê¸‰ í…ìŠ¤íŠ¸ ë¶„ë¥˜ ë¬¸ì œ        
* **(0)** "cancer - ì•”" : ì£¼ì–´ì§„ ì˜í•™ì  ì§ˆë³‘ì— ëŒ€í•œ AbstractëŠ” ì•”ì— ëŒ€í•œ ê²ƒì¸ê°€ìš”?          
* **(1)** "neurological disorders - ì‹ ê²½ ì¥ì• ": ì•„ë‹ˆë©´ ì‹ ê²½ ì¥ì• ì— ê´€ë ¨ëœ ê²ƒì¸ê°€ìš”?    
* **(2)** "other -ê¸°íƒ€" : ì•„ë‹ˆë©´ ê·¸ ì™¸ì˜ ê²ƒì¸ê°€ìš”?



**[ë°ì´í„° ì¤€ë¹„í•˜ê¸°]**      
ì´ë¯¸ ì•ì—ì„œ í–ˆì§€ë§Œ ë‹¤ì‹œ ë³µìŠµ      
<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
TC3_DATA_DIR = '/dli/task/data/NCBI_tc-3'
!ls $TC3_DATA_DIR/*.tsv
```
  
ê²°ê³¼  
```python
/dli/task/data/NCBI_tc-3/dev.tsv   /dli/task/data/NCBI_tc-3/train.tsv
/dli/task/data/NCBI_tc-3/test.tsv
```
  
```python
# Take a look at the tab separated data
print("*****\ntrain.tsv sample\n*****")
!head -n 3 $TC3_DATA_DIR/train.tsv
print("\n\n*****\ndev.tsv sample\n*****")
!head -n 3 $TC3_DATA_DIR/dev.tsv
print("\n\n*****\ntest.tsv sample\n*****")
!head -n 3 $TC3_DATA_DIR/test.tsv
```
  
ê²°ê³¼  
```python
*****
train.tsv sample
*****
sentence	label
Identification of APC2, a homologue of the adenomatous polyposis coli tumour suppressor . The adenomatous polyposis coli ( APC ) tumour-suppressor protein controls the Wnt signalling pathway by forming a complex with glycogen synthase kinase 3beta ( GSK-3beta ) , axin / conductin and betacatenin . Complex formation induces the rapid degradation of betacatenin . In colon carcinoma cells , loss of APC leads to the accumulation of betacatenin in the nucleus , where it binds to and activates the Tcf-4 transcription factor ( reviewed in [ 1 ] [ 2 ] ) . Here , we report the identification and genomic structure of APC homologues . Mammalian APC2 , which closely resembles APC in overall domain structure , was functionally analyzed and shown to contain two SAMP domains , both of which are required for binding to conductin . Like APC , APC2 regulates the formation of active betacatenin-Tcf complexes , as demonstrated using transient transcriptional activation assays in APC - / - colon carcinoma cells . Human APC2 maps to chromosome 19p13 . 3 . APC and APC2 may therefore have comparable functions in development and cancer .	0
A common MSH2 mutation in English and North American HNPCC families: origin, phenotypic expression, and sex specific differences in colorectal cancer . The frequency , origin , and phenotypic expression of a germline MSH2 gene mutation previously identified in seven kindreds with hereditary non-polyposis cancer syndrome (HNPCC) was investigated . The mutation ( A-- > T at nt943 + 3 ) disrupts the 3 splice site of exon 5 leading to the deletion of this exon from MSH2 mRNA and represents the only frequent MSH2 mutation so far reported . Although this mutation was initially detected in four of 33 colorectal cancer families analysed from eastern England , more extensive analysis has reduced the frequency to four of 52 ( 8 % ) English HNPCC kindreds analysed . In contrast , the MSH2 mutation was identified in 10 of 20 ( 50 % ) separately identified colorectal families from Newfoundland . To investigate the origin of this mutation in colorectal cancer families from England ( n = 4 ) , Newfoundland ( n = 10 ) , and the United States ( n = 3 ) , haplotype analysis using microsatellite markers linked to MSH2 was performed . Within the English and US families there was little evidence for a recent common origin of the MSH2 splice site mutation in most families . In contrast , a common haplotype was identified at the two flanking markers ( CA5 and D2S288 ) in eight of the Newfoundland families . These findings suggested a founder effect within Newfoundland similar to that reported by others for two MLH1 mutations in Finnish HNPCC families . We calculated age related risks of all , colorectal , endometrial , and ovarian cancers in nt943 + 3 A-- > T MSH2 mutation carriers ( n = 76 ) for all patients and for men and women separately . For both sexes combined , the penetrances at age 60 years for all cancers  and for colorectal cancer were 0 . 86 and 0 . 57 , respectively . The risk of colorectal cancer was significantly higher ( p  0 . 01 ) in males than females ( 0 . 63 v 0 . 30 and 0 . 84 v 0 . 44 at ages 50 and 60 years , respectively ) . For females there was a high risk of endometrial cancer ( 0 . 5 at age 60 years ) and premenopausal ovarian cancer ( 0 . 2 at 50 years ) . These intersex differences in colorectal cancer risks have implications for screening programmes and for attempts to identify colorectal cancer susceptibility modifiers .	0


*****
dev.tsv sample
*****
sentence	label
BRCA1 is secreted and exhibits properties of a granin. Germline mutations in BRCA1 are responsible for most cases of inherited breast and ovarian cancer . However , the function of the BRCA1 protein has remained elusive . We now show that BRCA1 encodes a 190-kD protein with sequence homology and biochemical analogy to the granin protein family . Interestingly , BRCA2 also includes a motif similar to the granin consensus at the C terminus of the protein . Both BRCA1 and the granins localize to secretory vesicles , are secreted by a regulated pathway , are post-translationally glycosylated and are responsive to hormones . As a regulated secretory protein , BRCA1 appears to function by a mechanism not previously described for tumour suppressor gene products . . 	0
Ovarian cancer risk in BRCA1 carriers is modified by the HRAS1 variable number of tandem repeat (VNTR) locus. Women who carry a mutation in the BRCA1 gene ( on chromosome 17q21 ) , have an 80 % risk of breast cancer and a 40 % risk of ovarian cancer by the age of 70 ( ref . 1 ) . The variable penetrance of BRCA1 suggests that other genetic and non-genetic factors play a role in tumourigenesis in these individuals . The HRAS1 variable number of tandem repeats ( VNTR ) polymorphism , located 1 kilobase ( kb ) downstream of the HRAS1 proto-oncogene ( chromosome 11p15 . 5 ) is one possible genetic modifier of cancer penetrance . Individuals who have rare alleles of the VNTR have an increased risk of certain types of cancers , including breast cancer ( 2-4 ) . To investigate whether the presence of rare HRAS1 alleles increases susceptibility to hereditary breast and ovarian cancer , we have typed a panel of 307 female BRCA1 carriers at this locus using a PCR-based technique . The risk for ovarian cancer was 2 . 11 times greater for BRCA1 carriers harbouring one or two rare HRAS1 alleles , compared to carriers with only common alleles ( P = 0 . 015 ) . The magnitude of the relative risk associated with a rare HRAS1 allele was not altered by adjusting for the other known risk factors for hereditary ovarian cancer ( 5 ) . Susceptibility to breast cancer did not appear to be affected by the presence of rare HRAS1 alleles . This study is the first to show the effect of a modifying gene on the penetrance of an inherited cancer syndrome 	0


*****
test.tsv sample
*****
sentence	label
Clustering of missense mutations in the ataxia-telangiectasia gene in a sporadic T-cell leukaemia. Ataxia-telangiectasia ( A-T ) is a recessive multi-system disorder caused by mutations in the ATM gene at 11q22-q23 ( ref . 3 ) . The risk of cancer , especially lymphoid neoplasias , is substantially elevated in A-T patients and has long been associated with chromosomal instability . By analysing tumour DNA from patients with sporadic T-cell prolymphocytic leukaemia ( T-PLL ) , a rare clonal malignancy with similarities to a mature T-cell leukaemia seen in A-T , we demonstrate a high frequency of ATM mutations in T-PLL . In marked contrast to the ATM mutation pattern in A-T , the most frequent nucleotide changes in this leukaemia were missense mutations . These clustered in the region corresponding to the kinase domain , which is highly conserved in ATM-related proteins in mouse , yeast and Drosophila . The resulting amino-acid substitutions are predicted to interfere with ATP binding or substrate recognition . Two of seventeen mutated T-PLL samples had a previously reported A-T allele . In contrast , no mutations were detected in the p53 gene , suggesting that this tumour suppressor is not frequently altered in this leukaemia . Occasional missense mutations in ATM were also found in tumour DNA from patients with B-cell non-Hodgkins lymphomas ( B-NHL ) and a B-NHL cell line . The evidence of a significant proportion of loss-of-function mutations and a complete absence of the normal copy of ATM in the majority of mutated tumours establishes somatic inactivation of this gene in the pathogenesis of sporadic T-PLL and suggests that ATM acts as a tumour suppressor . As constitutional DNA was not available , a putative hereditary predisposition to T-PLL will require further investigation . . 	0
Myotonic dystrophy protein kinase is involved in the modulation of the Ca2+ homeostasis in skeletal muscle cells. Myotonic dystrophy ( DM ) , the most prevalent muscular disorder in adults , is caused by ( CTG ) n-repeat expansion in a gene encoding a protein kinase ( DM protein kinase ; DMPK ) and involves changes in cytoarchitecture and ion homeostasis . To obtain clues to the normal biological role of DMPK in cellular ion homeostasis , we have compared the resting [ Ca2 + ] i , the amplitude and shape of depolarization-induced Ca2 + transients , and the content of ATP-driven ion pumps in cultured skeletal muscle cells of wild-type and DMPK [ - / - ] knockout mice . In vitro-differentiated DMPK [ - / - ] myotubes exhibit a higher resting [ Ca2 + ] i than do wild-type myotubes because of an altered open probability of voltage-dependent l-type Ca2 + and Na + channels . The mutant myotubes exhibit smaller and slower Ca2 + responses upon triggering by acetylcholine or high external K + . In addition , we observed that these Ca2 + transients partially result from an influx of extracellular Ca2 + through the l-type Ca2 + channel . Neither the content nor the activity of Na + / K + ATPase and sarcoplasmic reticulum Ca2 + -ATPase are affected by DMPK absence . In conclusion , our data suggest that DMPK is involved in modulating the initial events of excitation-contraction coupling in skeletal muscle . . 	1
```
  
</div>
</details>



**[ë°ì´í„° ì „ì²˜ë¦¬]**     
ì‚¬ì „ ì²˜ë¦¬ëœ ë°ì´í„°ëŠ” [documentation](https://docs.nvidia.com/deeplearning/nemo/user-guide/docs/en/stable/nlp/text_classification.html)ì— ì§€ì •ëœ í˜•ì‹ê³¼ ê°™ì´ ì´ë¯¸ ì•„ë˜ì²˜ëŸ¼ ë˜ì–´ìˆë‹¤

(í—¤ë” ì „ì²˜ë¦¬)            
* [WORD][SPACE][WORD][SPACE][WORD][TAB][LABEL]       
* í—¤ë” í–‰ì—ëŠ” "ë¬¸ì¥ ë ˆì´ë¸”(sentence label)"ì´ ìˆìœ¼ë©° ì œê±°ë˜ì–´ì•¼ í•œë‹¤.          

(í…ìŠ¤íŠ¸ ê¸¸ì´ ê³ ë ¤)      
* í…ìŠ¤íŠ¸ê°€ ìƒë‹¹íˆ ê¸¸ê¸° ë•Œë¬¸ì— ```max_seq_length``` ê°’ì„ íŠ¸ë ˆì´ë‹ ì‹œ ê³ ë ¤í•´ì•¼ í•œë‹¤.       



  
<details>
<summary>ğŸ‘€ í—¤ë” í–‰ ì œê±° ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆì§€ë§Œ ê°„ë‹¨í•œ ë³€ê²½ ì‘ì—…ì´ë¯€ë¡œ ìš°ë¦¬ëŠ” bash ìŠ¤íŠ¸ë¦¼ ì—ë””í„°(sed) ëª…ë ¹ì–´ë¥¼ í™œìš©     
  
```python  
!sed 1d $TC3_DATA_DIR/train.tsv > $TC3_DATA_DIR/train_nemo_format.tsv
!sed 1d $TC3_DATA_DIR/dev.tsv > $TC3_DATA_DIR/dev_nemo_format.tsv
!sed 1d $TC3_DATA_DIR/test.tsv > $TC3_DATA_DIR/test_nemo_format.tsv
```
```python 
# Take a look at the tab separated data
# "1" is "positive" and "0" is "negative"
print("*****\ntrain_nemo_format.tsv sample\n*****")
!head -n 3 $TC3_DATA_DIR/train_nemo_format.tsv
print("\n\n*****\ndev_nemo_format.tsv sample\n*****")
!head -n 3 $TC3_DATA_DIR/dev_nemo_format.tsv
print("\n\n*****\ntest_nemo_format.tsv sample\n*****")
!head -n 3 $TC3_DATA_DIR/test_nemo_format.tsv
TC3_DATA_DIR = '/dli/task/data/NCBI_tc-3'
!ls $TC3_DATA_DIR/*.tsv  
```

ê²°ê³¼
```
*****
train_nemo_format.tsv sample
*****
Identification of APC2, a homologue of the adenomatous polyposis coli tumour suppressor . The adenomatous polyposis coli ( APC ) tumour-suppressor protein controls the Wnt signalling pathway by forming a complex with glycogen synthase kinase 3beta ( GSK-3beta ) , axin / conductin and betacatenin . Complex formation induces the rapid degradation of betacatenin . In colon carcinoma cells , loss of APC leads to the accumulation of betacatenin in the nucleus , where it binds to and activates the Tcf-4 transcription factor ( reviewed in [ 1 ] [ 2 ] ) . Here , we report the identification and genomic structure of APC homologues . Mammalian APC2 , which closely resembles APC in overall domain structure , was functionally analyzed and shown to contain two SAMP domains , both of which are required for binding to conductin . Like APC , APC2 regulates the formation of active betacatenin-Tcf complexes , as demonstrated using transient transcriptional activation assays in APC - / - colon carcinoma cells . Human APC2 maps to chromosome 19p13 . 3 . APC and APC2 may therefore have comparable functions in development and cancer .	0
A common MSH2 mutation in English and North American HNPCC families: origin, phenotypic expression, and sex specific differences in colorectal cancer . The frequency , origin , and phenotypic expression of a germline MSH2 gene mutation previously identified in seven kindreds with hereditary non-polyposis cancer syndrome (HNPCC) was investigated . The mutation ( A-- > T at nt943 + 3 ) disrupts the 3 splice site of exon 5 leading to the deletion of this exon from MSH2 mRNA and represents the only frequent MSH2 mutation so far reported . Although this mutation was initially detected in four of 33 colorectal cancer families analysed from eastern England , more extensive analysis has reduced the frequency to four of 52 ( 8 % ) English HNPCC kindreds analysed . In contrast , the MSH2 mutation was identified in 10 of 20 ( 50 % ) separately identified colorectal families from Newfoundland . To investigate the origin of this mutation in colorectal cancer families from England ( n = 4 ) , Newfoundland ( n = 10 ) , and the United States ( n = 3 ) , haplotype analysis using microsatellite markers linked to MSH2 was performed . Within the English and US families there was little evidence for a recent common origin of the MSH2 splice site mutation in most families . In contrast , a common haplotype was identified at the two flanking markers ( CA5 and D2S288 ) in eight of the Newfoundland families . These findings suggested a founder effect within Newfoundland similar to that reported by others for two MLH1 mutations in Finnish HNPCC families . We calculated age related risks of all , colorectal , endometrial , and ovarian cancers in nt943 + 3 A-- > T MSH2 mutation carriers ( n = 76 ) for all patients and for men and women separately . For both sexes combined , the penetrances at age 60 years for all cancers  and for colorectal cancer were 0 . 86 and 0 . 57 , respectively . The risk of colorectal cancer was significantly higher ( p  0 . 01 ) in males than females ( 0 . 63 v 0 . 30 and 0 . 84 v 0 . 44 at ages 50 and 60 years , respectively ) . For females there was a high risk of endometrial cancer ( 0 . 5 at age 60 years ) and premenopausal ovarian cancer ( 0 . 2 at 50 years ) . These intersex differences in colorectal cancer risks have implications for screening programmes and for attempts to identify colorectal cancer susceptibility modifiers .	0
Age of onset in Huntington disease : sex specific influence of apolipoprotein E genotype and normal CAG repeat length . Age of onset ( AO ) of Huntington disease ( HD) is known to be correlated with the length of an expanded CAG repeat in the HD gene . Apolipoprotein E ( APOE ) genotype , in turn , is known to influence AO in Alzheimer disease , rendering the APOE gene a likely candidate to affect AO in other neurological diseases too . We therefore determined APOE genotype and normal CAG repeat length in the HD gene for 138 HD patients who were previously analysed with respect to CAG repeat length . Genotyping for APOE was performed blind to clinical information . In addition to highlighting the effect of the normal repeat length upon AO in maternally inherited HD and in male patients , we show that the APOE epsilon2epsilon3 genotype is associated with significantly earlier AO in males than in females . Such a sex difference in AO was not apparent for any of the other APOE genotypes . Our findings suggest that subtle differences in the course of the neurodegeneration  in HD  may allow interacting genes to exert gender specific effects upon AO.	1


*****
dev_nemo_format.tsv sample
*****
BRCA1 is secreted and exhibits properties of a granin. Germline mutations in BRCA1 are responsible for most cases of inherited breast and ovarian cancer . However , the function of the BRCA1 protein has remained elusive . We now show that BRCA1 encodes a 190-kD protein with sequence homology and biochemical analogy to the granin protein family . Interestingly , BRCA2 also includes a motif similar to the granin consensus at the C terminus of the protein . Both BRCA1 and the granins localize to secretory vesicles , are secreted by a regulated pathway , are post-translationally glycosylated and are responsive to hormones . As a regulated secretory protein , BRCA1 appears to function by a mechanism not previously described for tumour suppressor gene products . . 	0
Ovarian cancer risk in BRCA1 carriers is modified by the HRAS1 variable number of tandem repeat (VNTR) locus. Women who carry a mutation in the BRCA1 gene ( on chromosome 17q21 ) , have an 80 % risk of breast cancer and a 40 % risk of ovarian cancer by the age of 70 ( ref . 1 ) . The variable penetrance of BRCA1 suggests that other genetic and non-genetic factors play a role in tumourigenesis in these individuals . The HRAS1 variable number of tandem repeats ( VNTR ) polymorphism , located 1 kilobase ( kb ) downstream of the HRAS1 proto-oncogene ( chromosome 11p15 . 5 ) is one possible genetic modifier of cancer penetrance . Individuals who have rare alleles of the VNTR have an increased risk of certain types of cancers , including breast cancer ( 2-4 ) . To investigate whether the presence of rare HRAS1 alleles increases susceptibility to hereditary breast and ovarian cancer , we have typed a panel of 307 female BRCA1 carriers at this locus using a PCR-based technique . The risk for ovarian cancer was 2 . 11 times greater for BRCA1 carriers harbouring one or two rare HRAS1 alleles , compared to carriers with only common alleles ( P = 0 . 015 ) . The magnitude of the relative risk associated with a rare HRAS1 allele was not altered by adjusting for the other known risk factors for hereditary ovarian cancer ( 5 ) . Susceptibility to breast cancer did not appear to be affected by the presence of rare HRAS1 alleles . This study is the first to show the effect of a modifying gene on the penetrance of an inherited cancer syndrome 	0
A novel homeodomain-encoding gene is associated with a large CpG island interrupted by the myotonic dystrophy unstable (CTG)n repeat. Myotonic dystrophy ( DM ) is associated with a ( CTG ) n trinucleotide repeat expansion in the 3-untranslated region of a protein kinase-encoding gene , DMPK , which maps to chromosome 19q13 . 3 . Characterisation of the expression of this gene in patient tissues has thus far generated conflicting data on alterations in the steady state levels of DMPK mRNA , and on the final DMPK protein levels in the presence of the expansion . The DM region of chromosome 19 is gene rich , and it is possible that the repeat expansion may lead to dysfunction of a number of transcription units in the vicinity , perhaps as a consequence of chromatin disruption . We have searched for genes associated with a CpG island at the 3 end of DMPK . Sequencing of this region shows that the island extends over 3 . 5 kb and is interrupted by the ( CTG ) n repeat . Comparison of genomic sequences downstream ( centromeric ) of the repeat in human and mouse identified regions of significant homology . These correspond to exons of a gene predicted to encode a homeodomain protein . RT-PCR analysis shows that this gene , which we have called DM locus-associated homeodomain protein ( DMAHP ) , is expressed in a number of human tissues , including skeletal muscle , heart and brain .	1


*****
test_nemo_format.tsv sample
*****
Clustering of missense mutations in the ataxia-telangiectasia gene in a sporadic T-cell leukaemia. Ataxia-telangiectasia ( A-T ) is a recessive multi-system disorder caused by mutations in the ATM gene at 11q22-q23 ( ref . 3 ) . The risk of cancer , especially lymphoid neoplasias , is substantially elevated in A-T patients and has long been associated with chromosomal instability . By analysing tumour DNA from patients with sporadic T-cell prolymphocytic leukaemia ( T-PLL ) , a rare clonal malignancy with similarities to a mature T-cell leukaemia seen in A-T , we demonstrate a high frequency of ATM mutations in T-PLL . In marked contrast to the ATM mutation pattern in A-T , the most frequent nucleotide changes in this leukaemia were missense mutations . These clustered in the region corresponding to the kinase domain , which is highly conserved in ATM-related proteins in mouse , yeast and Drosophila . The resulting amino-acid substitutions are predicted to interfere with ATP binding or substrate recognition . Two of seventeen mutated T-PLL samples had a previously reported A-T allele . In contrast , no mutations were detected in the p53 gene , suggesting that this tumour suppressor is not frequently altered in this leukaemia . Occasional missense mutations in ATM were also found in tumour DNA from patients with B-cell non-Hodgkins lymphomas ( B-NHL ) and a B-NHL cell line . The evidence of a significant proportion of loss-of-function mutations and a complete absence of the normal copy of ATM in the majority of mutated tumours establishes somatic inactivation of this gene in the pathogenesis of sporadic T-PLL and suggests that ATM acts as a tumour suppressor . As constitutional DNA was not available , a putative hereditary predisposition to T-PLL will require further investigation . . 	0
Myotonic dystrophy protein kinase is involved in the modulation of the Ca2+ homeostasis in skeletal muscle cells. Myotonic dystrophy ( DM ) , the most prevalent muscular disorder in adults , is caused by ( CTG ) n-repeat expansion in a gene encoding a protein kinase ( DM protein kinase ; DMPK ) and involves changes in cytoarchitecture and ion homeostasis . To obtain clues to the normal biological role of DMPK in cellular ion homeostasis , we have compared the resting [ Ca2 + ] i , the amplitude and shape of depolarization-induced Ca2 + transients , and the content of ATP-driven ion pumps in cultured skeletal muscle cells of wild-type and DMPK [ - / - ] knockout mice . In vitro-differentiated DMPK [ - / - ] myotubes exhibit a higher resting [ Ca2 + ] i than do wild-type myotubes because of an altered open probability of voltage-dependent l-type Ca2 + and Na + channels . The mutant myotubes exhibit smaller and slower Ca2 + responses upon triggering by acetylcholine or high external K + . In addition , we observed that these Ca2 + transients partially result from an influx of extracellular Ca2 + through the l-type Ca2 + channel . Neither the content nor the activity of Na + / K + ATPase and sarcoplasmic reticulum Ca2 + -ATPase are affected by DMPK absence . In conclusion , our data suggest that DMPK is involved in modulating the initial events of excitation-contraction coupling in skeletal muscle . . 	1
Constitutional RB1-gene mutations in patients with isolated unilateral retinoblastoma. In most patients with isolated unilateral retinoblastoma , tumor development is initiated by somatic inactivation of both alleles of the RB1 gene . However , some of these patients can transmit retinoblastoma predisposition to their offspring . To determine the frequency and nature of constitutional RB1-gene mutations in patients with isolated unilateral retinoblastoma , we analyzed DNA from peripheral blood and from tumor tissue . The analysis of tumors from 54 ( 71 % ) of 76 informative patients showed loss of constitutional heterozygosity ( LOH ) at intragenic loci . Three of 13 uninformative patients had constitutional deletions . For 39 randomly selected tumors , SSCP , hetero-duplex analysis , sequencing , and Southern blot analysis were used to identify mutations . Mutations were detected in 21 ( 91 % ) of 23 tumors with LOH . In 6 ( 38 % ) of 16 tumors without LOH , one mutation was detected , and in 9 ( 56 % ) of the tumors without LOH , both mutations were found . Thus , a total of 45 mutations were identified in tumors of 36 patients . Thirty-nine of the mutations-including 34 small mutations , 2 large structural alterations , and hypermethylation in 3 tumors-were not detected in the corresponding peripheral blood DNA . In 6 ( 17 % ) of the 36 patients , a mutation was detected in constitutional DNA , and 1 of these mutations is known to be associated with reduced expressivity . The presence of a constitutional mutation was not associated with an early age at treatment . In 1 patient , somatic mosaicism was demonstrated by molecular analysis of DNA and RNA from peripheral blood . In 2 patients without a detectable mutation in peripheral blood , mosaicism was suggested because 1 of the patients showed multifocal tumors and the other later developed bilateral retinoblastoma . In conclusion , our results emphasize that the manifestation and transmissibility of retinoblastoma depend on the nature of the first mutation , its time in development , and the number and types of cells that are affected . . 	2  
```
```python 
TC3_DATA_DIR = '/dli/task/data/NCBI_tc-3'
!ls $TC3_DATA_DIR/*.tsv
```
ê²°ê³¼
```python 
/dli/task/data/NCBI_tc-3/dev.tsv
/dli/task/data/NCBI_tc-3/dev_nemo_format.tsv
/dli/task/data/NCBI_tc-3/test.tsv
/dli/task/data/NCBI_tc-3/test_nemo_format.tsv
/dli/task/data/NCBI_tc-3/train.tsv
/dli/task/data/NCBI_tc-3/train_nemo_format.tsv
```
  
</div>
</details> 

----

## í™˜ê²½ ì„¤ì • íŒŒì¼(Configuration File)
text_classification_config.yaml config íŒŒì¼ì„ í™•ì¸í•˜ê³  í‚¤ì™€ ê¸°ë³¸ valueê°’ì„ í™•ì¸í•´ ë´…ë‹ˆë‹¤. íŠ¹íˆ, ì„¸ê°€ì§€ ìµœìƒìœ„ í‚¤ì¸ trainer, model,exp_managerì™€ í‚¤ì˜ ê³„ì¸µ êµ¬ì¡°ë¥¼ í™•ì¸í•´ ë‘ì„¸ìš”.

trainer:
  gpus:
  num_nodes:
  max_epochs:
  ...
  
model:
  nemo_path:
  tokenizer:  
  language_model:
  classifier_head:
  ...

exp_manager:
  ...
CONFIG_DIR = "/dli/task/nemo/examples/nlp/text_classification/conf"
CONFIG_FILE = "text_classification_config.yaml"
!cat $CONFIG_DIR/$CONFIG_FILE
2.2.2.1 OmegaConf ë„êµ¬
YAML config íŒŒì¼ì€ íŒŒë¼ë¯¸í„° ëŒ€ë¶€ë¶„ì˜ ê¸°ë³¸ ê°’ì„ ì œê³µí•˜ì§€ë§Œ í…ìŠ¤íŠ¸ ë¶„ë¥˜ ì‹¤í—˜ì„ ì§„í–‰í•˜ê¸° ìœ„í•´ ì§€ì •ë˜ì–´ì•¼í•˜ëŠ” ëª‡ ê°œì˜ íŒŒë¼ë¯¸í„°ê°€ ìˆìŠµë‹ˆë‹¤.

ê°ê°ì˜ YAML ì„¹ì…˜ì€ omegaconf íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ë©´ ë³´ë‹¤ ë” ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, "dot" í”„ë¡œí† ì½œì„ í™œìš©í•˜ëŠ” êµ¬ì„± í‚¤ì— ì ‘ê·¼í•˜ê³  ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Config íŒŒì¼ì—ì„œ OmegaConf ê°ì²´ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ëŠ” ê²ƒìœ¼ë¡œë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤. ê°ì²´ì— ìˆëŠ” í‚¤ëŠ” ë³€ê²½, ì¶”ê°€, ë³´ê¸°, ì €ì¥ ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, modelì„¹ì…˜ë§Œ ë³´ë ¤ê³  í•˜ëŠ” ê²½ìš°, ìš°ë¦¬ëŠ” config íŒŒì¼ì„ ë¡œë“œí•˜ì—¬ config.model ì„¹ì…˜ë§Œ ì§€ì •í•˜ì—¬ í”„ë¦°íŠ¸ë¬¸ì„ í†µí•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

from omegaconf import OmegaConf
â€‹
config = OmegaConf.load(CONFIG_DIR + "/" + CONFIG_FILE)
print(OmegaConf.to_yaml(config.model))
ëª¨ë¸ ì¸ì(argument)ì— ëŒ€í•œ ì„¸ë¶€ ì‚¬í•­ì€ ë‹¤ìŒ ë¬¸ì„œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‹¤ìŠµì—ì„œëŠ” dataset.num_classes ê°’ê³¼ train_ds.file_path, val_ds.file_path, test_ds.file_path ì— ìˆëŠ” ìœ„ì¹˜ ê°’ì´ í•„ìš”í•©ë‹ˆë‹¤.

ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ì§€ ì•Šë„ë¡ dataset.max_seq_length ê°’ì„ 128ë¡œ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. infer_samples(ì¶”ì¸¡ ìƒ˜í”Œ)ì´ ì˜í™” í‰ì ê³¼ ê´€ë ¨ì´ ìˆëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìš°ë¦¬ëŠ” ì§ˆë³‘ ë„ë©”ì¸ì—ì„œ ì˜ë¯¸ ìˆëŠ” ë¬¸ì¥ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‚˜ì¤‘ì— ë³€ê²½í•´ì•¼í•  ì—¬ëŸ¬ê°€ì§€ íŒŒë¼ë¯¸í„°ê°€ ìˆì§€ë§Œ í˜„ì¬ë¡œì„œëŠ” ìš°ë¦¬ê°€ ë°˜ë“œì‹œ ì œê³µí•´ì•¼í•˜ëŠ” ëª¨ë“  íŒŒë¼ë¯¸í„°ëŠ” ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.

ë‹¤ìŒìœ¼ë¡œ trainer(íŠ¸ë ˆì´ë„ˆ) í•˜ìœ„ ì„¹ì…˜ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

print(OmegaConf.to_yaml(config.trainer))
í˜„ì¬ GPUê°€ í•˜ë‚˜ ë¿ì´ê¸° ë•Œë¬¸ì—, ì´ ì„¤ì •ì€ ê´œì°®ê¸´ í•˜ì§€ë§Œ ìš°ì„  max_epochsë¥¼ ëª‡ ê°œë¡œ ì œí•œí•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. modelêµ¬ì„±ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ëª‡ ê°€ì§€ ë‹¤ë¥¸ íŒŒë¼ë¯¸í„°ë¥¼ ë³€ê²½í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì²˜ìŒì—ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ ê°€ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ, exp_managerëŠ” ì–´ë–»ìŠµë‹ˆê¹Œ?

print(OmegaConf.to_yaml(config.exp_manager))
ì´ë²ˆ ì„¹ì…˜ë„ ì´ëŒ€ë¡œ ê´œì°®ìŠµë‹ˆë‹¤. exp_dir ê°’ì´ nullì´ë¼ë©´ nemo_experimentsë¼ëŠ” ìƒˆ ë””ë ‰í„°ë¦¬ì— ì‹¤í—˜ ê²°ê³¼ëŠ” ê¸°ë³¸ìœ¼ë¡œ ë°°ì¹˜ë  ì˜ˆì •ì…ë‹ˆë‹¤.

2.2.3 Hydra-Enabled Python ìŠ¤í¬ë¦½íŠ¸
ì •ë¦¬ë¥¼ í•˜ë©´, ìš°ë¦¬ê°€ ë³€ê²½ ë˜ëŠ” ì¬ì •ì˜í•˜ê³ ì í•˜ëŠ” íŒŒë¼ë¯¸í„°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.:

model.dataset.num_classes: 3
model.dataset.max_seq_length: 128
model.train_ds.file_path: train_nemo_format.tsv
model.val_ds.file_path: dev_nemo_format.tsv
model.test_ds.file_path: test_nemo_format.tsv
model.infer_samples : relevent sentences
trainer.max_epochs: 3
í…ìŠ¤íŠ¸ ë¶„ë¥˜ íŠ¸ë ˆì´ë‹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì´ìš©í•´ì„œ ìš°ë¦¬ëŠ” í•˜ë‚˜ì˜ ëª…ë ¹ë¬¸ ë§Œìœ¼ë¡œ íŠ¸ë ˆì´ë‹, ì¶”ë¡ , í…ŒìŠ¤íŠ¸ë¥¼ ëª¨ë‘ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

ìŠ¤í¬ë¦½íŠ¸ëŠ” Hydraë¥¼ ì´ìš©í•˜ì—¬ config íŒŒì¼ì„ ê´€ë¦¬í•˜ë¯€ë¡œ ìš°ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ì´ ì»¤ë§¨ë“œ ë¼ì¸ì—ì„œ ì§ì ‘ ì›í•˜ëŠ” ê°’ì„ ë‹¤ìŒê³¼ ê°™ì´ ì¬ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


TC_DIR = "/dli/task/nemo/examples/nlp/text_classification"

%%time
# The training takes about 2 minutes to run
â€‹
TC_DIR = "/dli/task/nemo/examples/nlp/text_classification"
â€‹
# set the values we want to override
NUM_CLASSES = 3
MAX_SEQ_LENGTH = 128
PATH_TO_TRAIN_FILE = "/dli/task/data/NCBI_tc-3/train_nemo_format.tsv"
PATH_TO_VAL_FILE = "/dli/task/data/NCBI_tc-3/dev_nemo_format.tsv"
PATH_TO_TEST_FILE = "/dli/task/data/NCBI_tc-3/test_nemo_format.tsv"
# disease domain inference sample answers should be 0, 1, 2 
INFER_SAMPLES_0 = "In contrast no mutations were detected in the p53 gene suggesting that this tumour suppressor is not frequently altered in this leukaemia "
INFER_SAMPLES_1 = "The first predictive testing for Huntington disease  was based on analysis of linked polymorphic DNA markers to estimate the likelihood of inheriting the mutation for HD"
INFER_SAMPLES_2 = "Further studies suggested that low dilutions of C5D serum contain a factor or factors interfering at some step in the hemolytic assay of C5 rather than a true C5 inhibitor or inactivator"
MAX_EPOCHS = 3
â€‹
# Run the training script, overriding the config values in the command line
!python $TC_DIR/text_classification_with_bert.py \
        model.dataset.num_classes=$NUM_CLASSES \
        model.dataset.max_seq_length=$MAX_SEQ_LENGTH \
        model.train_ds.file_path=$PATH_TO_TRAIN_FILE \
        model.validation_ds.file_path=$PATH_TO_VAL_FILE \
        model.test_ds.file_path=$PATH_TO_TEST_FILE \
        model.infer_samples=["$INFER_SAMPLES_0","$INFER_SAMPLES_1","$INFER_SAMPLES_2"] \
        trainer.max_epochs=$MAX_EPOCHS
ê° íŠ¸ë ˆì´ë‹ ì‹¤í—˜ì´ ì‹œì‘í• ë•Œ, ì»¤ë§¨íŠ¸ ë¼ì¸ì„ í†µí•´ ì¶”ê°€ë˜ê±°ë‚˜, ì¬ì •ì˜ëœ íŒŒë¼ë¯¸í„°ë¥¼ í¬í•¨í•˜ì—¬ ì‹¤í—˜ ì‚¬ì–‘(specification)ì˜ ë¡œê·¸ê°€ í”„ë¦°íŠ¸ë©ë‹ˆë‹¤. ë˜í•œ, ì‚¬ìš© ê°€ëŠ¥í•œ GPU , ë¡œê·¸ ì €ì¥ ìœ„ì¹˜ ë° ëª¨ë¸ì— ëŒ€í•œ í•´ë‹¹ ì…ë ¥ê³¼ í•¨ê»˜ ë°ì´í„°ì„¸íŠ¸ë¡œë¶€í„° ì¼ë¶€ ìƒ˜í”Œê³¼ ê°™ì€ ì¶”ê°€ ì •ë³´ë„ í•¨ê»˜ í‘œì‹œë©ë‹ˆë‹¤. ë¡œê·¸ëŠ” ë°ì´í„°ì„¸íŠ¸ì— ìˆëŠ” ì‹œí€€ìŠ¤ ê¸¸ì´ì— ëŒ€í•œ ì¼ë¶€ í†µê³„ ê°’ë„ ì œê³µí•©ë‹ˆë‹¤.

ê° epoch í›„, ì •ë°€ë„, ë¦¬ì½œ, f1 ì ìˆ˜ë¥¼ í¬í•¨í•œ ê²€ì¦ ì„¸íŠ¸ì— ëŒ€í•œ ë©”íŠ¸ë¦­ ìš”ì•½ í…Œì´ë¸”ì´ ìˆìŠµë‹ˆë‹¤. f1 ì ìˆ˜ëŠ” ëª¨ë“  false positive(ìœ„ì–‘ì„±)ì™€ false negative(ìœ„ìŒì„±)ì„ ëª¨ë‘ ì†Œê³ ë ¤í•˜ì—¬ ë‹¨ìˆœ ì •í™•ë„ë³´ë‹¤ ë” ìœ ìš©í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.

íŠ¸ë ˆì´ë‹ì´ ëë‚˜ë©´, NeMoëŠ” model.nemo_file_pathì—ì„œ ì§€ì •í•œ ê²½ë¡œì— ë§ˆì§€ë§‰ ì²´í¬í¬ì¸íŠ¸ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì´ ê°’ì„ ê¸°ë³¸ ê°’ìœ¼ë¡œ ë‘ì—ˆê¸° ë•Œë¬¸ì— .nemo í˜•ì‹ìœ¼ë¡œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ê¸°ë¡ë  ì˜ˆì •ì…ë‹ˆë‹¤..

!ls *.nemo
ì‹¤í—˜ì—ì„œ ì–»ì€ ê²°ê³¼ê°€ ê·¸ë ‡ê²Œ ì¢‹ì§€ ì•Šìœ¼ì…¨ì„ ìˆ˜ ë„ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ëª‡ ê°€ì§€ ë³€ê²½ë§Œìœ¼ë¡œ ë‹¤ë¥¸ ì‹¤í—˜ì„ ì‹œë„í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì‰½ìŠµë‹ˆë‹¤. ë” ê¸´ íŠ¸ë ˆì´ë‹, ì¡°ì •ëœ í•™ìŠµ ì†ë„, íŠ¸ë ˆì´ë‹ì™€ ê²€ì¦ ë°ì´í„° ì„¸íŠ¸ì˜ ë°°ì¹˜ í¬ê¸°ë¥¼ ë³€ê²½í•˜ë©´ ê²°ê³¼ë¥¼ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2.2.4 ì˜ˆì œ: Experiment ìˆ˜í–‰í•˜ê¸°
ë™ì¼í•œ í…ìŠ¤íŠ¸ ë¶„ë¥˜ ë¬¸ì œë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ìœ ì‚¬í•œ ì‹¤í—˜ì„ ì§„í–‰í•´ ë´…ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ëª‡ ê°€ì§€ ê°œì„  ì‚¬í•­ì´ ì œì•ˆë˜ì—ˆìŠµë‹ˆë‹¤. :

í˜¼í•© ì •ë°€ë„ë¥¼ amp_level ë¥¼ "O1" ë¡œ 16ì˜ precision(ì •ë°€ë„) ë¡œ ì„¤ì •í•˜ì—¬ ì •í™•ë„ì— ìˆì–´ ê±°ì˜ ë˜ëŠ” ì „í˜€ ì €í•˜ë˜ì§€ ì•Šê³  ëª¨ë¸ì„ ë” ë¹ ë¥´ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
Epoch(ì—í¬í¬) ìˆ˜ë¥¼ ì•½ê°„ ìœ„ë¡œ ì¡°ì •í•˜ì—¬ ê²°ê³¼ë¥¼ ê°œì„ í•©ë‹ˆë‹¤. (ë” í° max_epochs)
í•™ìŠµ ì†ë„ë¥¼ ì•½ê°„ ë†’ì—¬ ëª¨ë¸ ê°€ì¤‘ì¹˜ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ë§ˆë‹¤ ì˜ˆìƒ ì˜¤ë¥˜ì— ëŒ€í•´ ë³´ë‹¤ ì‹ ì†í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
ì•„ë˜ ì…€ì— ì—¬ëŸ¬ë¶„ì„ ìœ„í•´ ìƒˆë¡œìš´ ê°’ì´ ì œê³µë˜ì—ˆìŠµë‹ˆë‹¤. ëª…ë ¹ì„ ì ì ˆí•œ ì¬ì •ì˜ì™€ í•¨ê»˜ ì¶”ê°€í•˜ê³  ì…€ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ë§Œì•½ì— ì‹¤ìŠµ ì§„í–‰ì— ì–´ë ¤ì›€ì´ ìˆìœ¼ì‹  ê²½ìš°, ì†”ë£¨ì…˜ì„ ì°¸ê³  í•©ë‹ˆë‹¤.

%%time
# The training takes about 2 minutes to run
â€‹
TC_DIR = "/dli/task/nemo/examples/nlp/text_classification"
â€‹
# set the values we want to override
NUM_CLASSES = 3
MAX_SEQ_LENGTH = 128
PATH_TO_TRAIN_FILE = "/dli/task/data/NCBI_tc-3/train_nemo_format.tsv"
PATH_TO_VAL_FILE = "/dli/task/data/NCBI_tc-3/dev_nemo_format.tsv"
PATH_TO_TEST_FILE = "/dli/task/data/NCBI_tc-3/test_nemo_format.tsv"
# disease domain inference sample answers should be 0, 1, 2 
INFER_SAMPLES_0 = "In contrast no mutations were detected in the p53 gene suggesting that this tumour suppressor is not frequently altered in this leukaemia "
INFER_SAMPLES_1 = "The first predictive testing for Huntington disease  was based on analysis of linked polymorphic DNA markers to estimate the likelihood of inheriting the mutation for HD"
INFER_SAMPLES_2 = "Further studies suggested that low dilutions of C5D serum contain a factor or factors interfering at some step in the hemolytic assay of C5 rather than a true C5 inhibitor or inactivator"
MAX_EPOCHS = 5
AMP_LEVEL = 'O1'
PRECISION = 16
LR = 5.0e-05
â€‹
# Override the config values in the command line
# FIXME
ì´ë²ˆ ì‹¤í—˜ ê²°ê³¼ê°€ ì´ì „ ì‹¤í—˜ê³¼ ë¹„êµ í–ˆì„ ë•Œ ì–´ë– ì…¨ë‚˜ìš”? ì¶œë ¥ ê°’ì—ì„œ F1 ì ìˆ˜ì™€ ì¶”ë¡  ê²°ê³¼ë¥¼ í™•ì¸í•´ ë´…ë‹ˆë‹¤.

2.2.5 TensorBoardë¡œ ê²°ê³¼ ì‹œê°í™”í•˜ê¸°
experiment manager ëŠ” í…ì„œë³´ë“œë¡œ ë³¼ ìˆ˜ ìˆëŠ” ê²°ê³¼ë“¤ì„ ì €ì¥í•©ë‹ˆë‹¤. ë‹¤ìŒ ì…€ì„ ì‹¤í–‰í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ í…ì„œë³´ë“œ ë§í¬ë¥¼ ë§Œë“  ë‹¤ìŒ ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ ë¸Œë¼ìš°ì €ì˜ íƒ­ì—ì„œ í…ì„œë³´ë“œë¥¼ ì—½ë‹ˆë‹¤.

%%js
const href = window.location.hostname +'/tensorboard/';
let a = document.createElement('a');
let link = document.createTextNode('Open Tensorboard!');
a.appendChild(link);
a.href = "http://" + href;
a.style.color = "navy"
a.target = "_blank"
element.append(a);
ì‹¤í–‰í•œ ëª¨ë¸ë“¤ì˜ ì„±ëŠ¥ì„ ë¹„ê³ í•˜ë ¤ë©´ "Train Loss" ìŠ¤ì¼€ì¼ëŸ¬ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì€ í•¨ê»˜ ì‹¤í–‰í•œ ëª¨ë“  ëª¨ë¸ì„ ë³´ì‹¤ ìˆ˜ë„ ìˆê³ , ê°œë³„ ëª¨ë¸ì„ ì„ íƒí•˜ì—¬ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì˜ˆì œëŠ” ì²« ë²ˆì§¸ ì£¼í™©ìƒ‰ ì‹¤í—˜ ê²°ê³¼ì™€ ë‘ ë²ˆì§¸ íŒŒë€ìƒ‰ ì˜ˆì œ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë‘ ë²ˆì§¸ ì‹¤í—˜ì—ì„œ ì†ì‹¤ì´ ë” ì ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Image
2.2.6 ì˜ˆì œ: ì–¸ì–´ ëª¨ë¸ ë³€ê²½í•˜ê¸°
ì§€ê¸ˆê¹Œì§€ëŠ” ê¸°ë³¸ì ì¸ bert-base-uncased ì–¸ì–´ ëª¨ë¸ì„ ì‚¬ìš©í•´ ì™”ì§€ë§Œ, ì´ ëª¨ë¸ì€ ì—¬ëŸ¬ë¶„ì´ ì‹œë„í•´ë³¼ ìˆ˜ ìˆëŠ” ëª¨ë¸ ì¤‘ í•˜ë‚˜ì¼ ë¿ì…ë‹ˆë‹¤. ë‹¤ìŒ ì…€ì„ ì‹¤í–‰í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥í•œ ì–¸ì–´ ëª¨ë¸ë“¤ì„ í™•ì¸í•´ ë³´ì„¸ìš”.

# complete list of supported BERT-like models
from nemo.collections import nlp as nemo_nlp
nemo_nlp.modules.get_pretrained_lm_models_list()
ì´ë²ˆ ì˜ˆì œì—ì„œëŠ” megatron-bert-345m-casedì™€ ê°™ì€ ìƒˆë¡œìš´ ì–¸ì–´ ëª¨ë¸ì„ ì„ íƒí•©ë‹ˆë‹¤.

ë©”ëª¨ë¦¬ë¥¼ ì§€ìš°ê¸° ìœ„í•´ ë…¸íŠ¸ë¶ ì»¤ë„ì„ ìƒˆë¡œ ì‹œì‘í•˜ì…”ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ëŒ€í˜• ëª¨ë¸ì„ ì‚¬ìš©í•  ê²½ìš°, GPU ë©”ëª¨ë¦¬ ê³µê°„ì„ ì ˆì•½í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•ì€ batch_size ë¥¼ 32, 16 ë˜ëŠ” 8ë¡œ ì¤„ì´ê³  max_seq_lengthë¥¼ 64ë¡œ ì¤„ì´ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” ì •ë‹µì´ ë”°ë¡œ ì—†ìŠµë‹ˆë‹¤. ì˜¤íˆë ¤ ì´ë²ˆ ì˜ˆì œëŠ” ì—¬ëŸ¬ë¶„ì´ ì—¬ëŸ¬ ì‹¤í—˜ì„ í•´ë³¼ ìˆ˜ ìˆëŠ” ê¸°íšŒì…ë‹ˆë‹¤.ì¼ë¶€ ëª¨ë¸ì€ ì‹¤í–‰í•˜ëŠ” ë° ëª‡ ë¶„ì´ ì†Œìš”ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë‹¤ìŒ ë…¸íŠ¸ë¶ìœ¼ë¡œ ë¨¼ì € ì´ë™í•œ í›„ ë‚˜ì¤‘ì— ì‹œê°„ì´ ë‚˜ë©´ ë‹¤ì‹œ ì—¬ê¸°ë¡œ ëŒì•„ì˜¤ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤. ì‹¤ìŠµ ì§„í–‰ì— ì–´ë ¤ì›€ì´ ìˆëŠ” ê²½ìš°, ì˜ˆì œ ì†”ë£¨ì…˜ ì„ ì‚´í´ë³´ì‹­ì‹œì˜¤. ì´ ëª¨ë¸ì— ëŒ€í•œ ì†ì‹¤ê°’ ë° f1 ê²°ê³¼ ê°’ì„ ê¸°ë¡í•´ë†“ê±°ë‚˜ í…ì„œë³´ë“œë¥¼ í†µí•´ ì°¨ì´ì ì„ ì‹œê°í™”í•´ë³´ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”.

# Restart the kernel
import IPython
app = IPython.Application.instance()
app.kernel.do_shutdown(True)
# TODO Try your own experiment with a different language model!
# TODO Try your own experiment with a different language model!


























---
title: "[04] Machine Learning: ë¹„ì„ í˜• SVM"
date:   2020-03-8
excerpt: "ë‹¤í•­ì‹ ì»¤ë„, ìœ ì‚¬ë„ íŠ¹ì„±, ê°€ìš°ì‹œì•ˆ RBF ì»¤ë„"
category: [Machine Learning]
layout: post
tag:
- Machine Learning
order: 0

comments: true
---

# ëª©ì°¨
- [SVMì´ë€?](#svmì´ë€-)
- [ë¹„ì„ í˜• SVM ë¶„ë¥˜](#ë¹„ì„ í˜•-svm-ë¶„ë¥˜)
  * [ë‹¤í•­ì‹ ì»¤ë„](#ë‹¤í•­ì‹-ì»¤ë„)
  * [ìœ ì‚¬ë„ íŠ¹ì„±](#ìœ ì‚¬ë„-íŠ¹ì„±)
  * [ê°€ìš°ì‹œì•ˆ RBF ì»¤ë„](#ê°€ìš°ì‹œì•ˆ-rbf-ì»¤ë„)
    + [í•˜ì´í¼íŒŒë¼ë¯¸í„°](#í•˜ì´í¼íŒŒë¼ë¯¸í„°)
  * [ê³„ì‚° ë³µì¡ë„](#ê³„ì‚°-ë³µì¡ë„)







----
---

ğŸ‘€, ğŸ¤·â€â™€ï¸ , ğŸ“œ    
ì´ ì•„ì´ì½˜ë“¤ì„ ëˆ„ë¥´ì‹œë©´ ì½”ë“œ, ê°œë… ë¶€ê°€ ì„¤ëª…ì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:)

---
----

# SVMì´ë€?
ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹  SVM(support vector machine)  
* ë§¤ìš° ê°•ë ¥í•¨: ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ ì¤‘ ê°€ì¥ ì¸ê¸°ìˆëŠ” ëª¨ë¸ ì¤‘ í•˜ë‚˜ì„         
* ë‹¤ëª©ì  ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸: ì„ í˜• or ë¹„ì„ í˜• ë¶„ë¥˜ íšŒê·€, ì´ìƒì¹˜ íƒìƒ‰ì— ì‚¬ìš©ê°€ëŠ¥     
* ì‚¬ìš© ìš©ë„    
   * íŠ¹íˆ ë³µì¡í•œ ë¶„ë¥˜ ë¬¸ì œì— ì í•©      
   * ì‘ê±°ë‚˜ ì¤‘ê°„ í¬ê¸°ì˜ ë°ì´í„°ì…‹ì— ì í•©      


-----
-----
 
 
 
 # ë¹„ì„ í˜• SVM ë¶„ë¥˜
 
[ì„ í˜• SVM ë¶„ë¥˜ê¸°](https://yerimoh.github.io/ML3/)ê°€ íš¨ìœ¨ì ì´ê³  ë§ì€ ê²½ìš°ì— ì•„ì£¼ ì˜ ì‘ë™í•˜ì§€ë§Œ,      
ì„ í˜•ì ìœ¼ë¡œ ë¶„ë¥˜í•  ìˆ˜ ì—†ëŠ” ë°ì´í„°ì…‹ì´ ë§ë‹¤.      

ì„ í˜• ë°ì´í„° ì…‹ì„ ë‹¤ë£¨ëŠ” í•œê°€ì§€ ë°©ë²•ì€ **íŠ¹ì„±ì„ ë” ì¶”ê°€í•˜ëŠ” ê²ƒ** ì´ë‹¤.       
ì´ë ‡ê²Œ í•˜ë©´ ì„ í˜•ì ìœ¼ë¡œ êµ¬ë¶„ë˜ëŠ” ë°ì´í„°ì…‹ì´ ë§Œë“¤ì–´ ì§ˆ ìˆ˜ ìˆë‹¤.       

ì˜ˆë¥¼ ë“¤ì–´ë³´ë©´

ì•„ë˜ëŠ” $$X_1$$ ì´ë¼ëŠ” íŠ¹ì„± í•˜ë‚˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ì…‹ì„ ë¶„ë¥˜í•œ ê²ƒì´ë‹¤.(1ì°¨ì›)    
ê·¸ëŸ°ë° ë°ì´í„° ì…‹ì´ í•˜ë‚˜ë‹¤ ë³´ë‹ˆ ì˜ ë¶„ë¥˜ë˜ì§€ ì•ŠëŠ”ë‹¤.         
![image](https://user-images.githubusercontent.com/76824611/147763059-88928f4a-9f16-49dc-933c-34fb4e3530e6.png)

ê·¸ëŸ¬ë¯€ë¡œ $$X_2$$ë¼ëŠ” íŠ¹ì„±í•˜ë‚˜ë¥¼ ë” ì¶”ê°€í•´ì„œ ë” ì˜ ë¶„ë¥˜ê°€ ë˜ê²Œ í•˜ëŠ” ê²ƒì´ë‹¤.(2ì°¨ì›) 
![image](https://user-images.githubusercontent.com/76824611/147763069-ae864e03-cdbf-46d9-9aff-eed68f162961.png)



 
 <details>
<summary>ğŸ‘€ íŠ¹ì„± ì¶”ê°€ ì „,í›„ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
X1D = np.linspace(-4, 4, 9).reshape(-1, 1)
X2D = np.c_[X1D, X1D**2]
y = np.array([0, 0, 1, 1, 1, 1, 1, 0, 0])

plt.figure(figsize=(10, 3))

plt.subplot(121)
plt.grid(True, which='both')
plt.axhline(y=0, color='k')
plt.plot(X1D[:, 0][y==0], np.zeros(4), "bs")
plt.plot(X1D[:, 0][y==1], np.zeros(5), "g^")
plt.gca().get_yaxis().set_ticks([])
plt.xlabel(r"$x_1$", fontsize=20)
plt.axis([-4.5, 4.5, -0.2, 0.2])

plt.subplot(122)
plt.grid(True, which='both')
plt.axhline(y=0, color='k')
plt.axvline(x=0, color='k')
plt.plot(X2D[:, 0][y==0], X2D[:, 1][y==0], "bs")
plt.plot(X2D[:, 0][y==1], X2D[:, 1][y==1], "g^")
plt.xlabel(r"$x_1$", fontsize=20)
plt.ylabel(r"$x_2$  ", fontsize=20, rotation=0)
plt.gca().get_yaxis().set_ticks([0, 4, 8, 12, 16])
plt.plot([-4.5, 4.5], [6.5, 6.5], "r--", linewidth=3)
plt.axis([-4.5, 4.5, -1, 17])

plt.subplots_adjust(right=1)

save_fig("higher_dimensions_plot", tight_layout=False)
plt.show()
```
  
</div>
</details>
 
ì‚¬ì´í‚· ëŸ°ì„ ì´ìš©í•˜ì—¬ ì´ë¥¼ êµ¬í˜„í•˜ë ¤ë©´,  
* [PolynomialFeatures](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html)       
* StandardScaler(https://yerimoh.github.io/ML3/#%EB%9D%BC%EC%A7%80-%EB%A7%88%EC%A7%84-%EB%B6%84%EB%A5%98-large-margin-classification)(ë‘ íŠ¹ì„±ì˜ ë‹¨ìœ„ ì¡°ì •)
* LinearSVC([C](https://yerimoh.github.io/ML3/#%EC%86%8C%ED%94%84%ED%8A%B8-%EB%A7%88%EC%A7%84-%EB%B6%84%EB%A5%98-soft-margin-classification)ê°’ ì¡°ì •)     

ë¥¼ ì‚¬ìš©í•œë‹¤.                                                                                                                                                                                                                      <details>
<summary>ğŸ‘€ ì‚¬ìš©í•  ë°ì´í„°ì…‹ ë§Œë“œëŠ” ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

moons ë°ì´í„°ì…‹ì€ ì‚¬ì´í‚·ëŸ°ì˜ make_moons ë¥¼ ì‚¬ìš©í•´ì„œ ë§Œë“  ë‘ ê°œì˜ ë°˜ë‹¬ ëª¨ì–‘ ë°ì´í„°ì…‹ì´ë‹¤.      
  
```python
from sklearn.datasets import make_moons
X, y = make_moons(n_samples=100, noise=0.15, random_state=42)

def plot_dataset(X, y, axes):
    plt.plot(X[:, 0][y==0], X[:, 1][y==0], "bs")
    plt.plot(X[:, 0][y==1], X[:, 1][y==1], "g^")
    plt.axis(axes)
    plt.grid(True, which='both')
    plt.xlabel(r"$x_1$", fontsize=20)
    plt.ylabel(r"$x_2$", fontsize=20, rotation=0)

plot_dataset(X, y, [-1.5, 2.5, -1, 1.5])
plt.show()
```

 ![image](https://user-images.githubusercontent.com/76824611/147765159-074eed4f-73b8-4a96-8e41-f1b7f1f97198.png)

  
  
</div>
</details>                                                                                                                                                             
 
```python
from sklearn.datasets import make_moons
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import PolynomialFeatures

polynomial_svm_clf = Pipeline([
        ("poly_features", PolynomialFeatures(degree=3)),
        ("scaler", StandardScaler()),
        ("svm_clf", LinearSVC(C=10, loss="hinge", random_state=42))
    ])

polynomial_svm_clf.fit(X, y)
```
 
![image](https://user-images.githubusercontent.com/76824611/147765481-7ff81b23-659b-451e-b867-c4d9518eb00f.png)


---
----

## ë‹¤í•­ì‹ ì»¤ë„
ìœ„ì˜ ì˜ˆì²˜ëŸ¼ íŠ¹ì„±ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•˜ê³  ëª¨ë“  ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì—ì„œ ì˜ ì‘ë™í•œë‹¤.     
ğŸš« í•˜ì§€ë§Œ, ë†’ì€ ì¹˜ìˆ˜ì˜ ë‹¤í•­ì‹ì€      
* ë§¤ìš° ë³µì¡í•œ ë°ì´í„°ì…‹ì„ ì˜ í‘œí˜„í•˜ì§€ ëª»í•¨             
* ë†’ì€ ì°¨ìˆ˜ì˜ ë‹¤í•­ì‹ì€ êµ‰ì¥íˆ ë§ì€ íŠ¹ì„±ì„ ì¶”ê°€í•˜ë¯€ë¡œ ëª¨ë¸ì„ ëŠë¦¬ê²Œ ë§Œë“¦     

**[SOLUTION]**    
SVMì˜ **ì»¤ë„ íŠ¸ë¦­(kernel trick)** ì‚¬ìš©    
ì»¤ë„ íŠ¸ë¦­      
* ì‹¤ì œë¡œëŠ” íŠ¹ì„±ì„ì¶”ê°€í•˜ì§€ ì•Šìœ¼ë©´ì„œ ë‹¤í•­ì‹ íŠ¹ì„±ì„ ë§ì´ ì¶”ê°€í•œ ê²ƒê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ìˆ˜ ìˆìŒ.      
* SVC íŒŒì´ì¬ í´ë˜ìŠ¤ì— êµ¬í˜„ë˜ì–´ ìˆìŒ      

moons ë°ì´í„°ì…‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í•´ë³´ì.
ì•„ë˜ì˜ ì½”ë“œëŠ” 3ì°¨ ë‹¤í•­ì‹ ì»¤ë„ì„ ì‚¬ìš©í•´ SVM ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ì‹œí‚¤ëŠ” ì½”ë“œì´ë‹¤.    

```python
from sklearn.svm import SVC

poly_kernel_svm_clf = Pipeline([
        ("scaler", StandardScaler()),
        ("svm_clf", SVC(kernel="poly", degree=3, coef0=1, C=5))
    ])
poly_kernel_svm_clf.fit(X, y)
```
![image](https://user-images.githubusercontent.com/76824611/147767149-22b5ae30-b1d8-4b92-9c89-15285e1919fa.png)

ì•„ë˜ì˜ì½”ë“œëŠ” 10ì°¨ ë‹¤í•­ì‹ ì»¤ë„ì„ ì‚¬ìš©í•œ ë˜ë‹¤ë¥¸ SVM ë¶„ë¥˜ê¸°ì´ë‹¤.    
* ëª¨ë¸ì´ ê³¼ëŒ€ì í•©ì´ë¼ë©´ ë‹¤í•­ì‹ì˜ ì°¨ìˆ˜ë¥¼ ì¤„ì—¬ì•¼ í•¨.     
* ë°˜ëŒ€ë¡œ ê³¼ì†Œì í•©ì´ë¼ë©´ ì°¨ìˆ˜ë¥¼ ëŠ˜ë ¤ì•¼ í•¨.     

ë§¤ê°œë³€ìˆ˜ ```coef0```ëŠ” ëª¨ë¸ì´ ë†’ì€ ì°¨ìˆ˜ì™€ ë‚®ì€ ì°¨ìˆ˜ì— ì–¼ë§ˆë‚˜ ì˜í–¥ì„ ë°›ì„ì§€ ì¡°ì ˆí•¨

```python
poly100_kernel_svm_clf = Pipeline([
        ("scaler", StandardScaler()),
        ("svm_clf", SVC(kernel="poly", degree=10, coef0=100, C=5))
    ])
poly100_kernel_svm_clf.fit(X, y)
```
![image](https://user-images.githubusercontent.com/76824611/147767405-2ccd3f69-14bf-44ce-9d46-cafea4d3d486.png)


-----
-----


## ìœ ì‚¬ë„ íŠ¹ì„±
ë¹„ì„ í˜• íŠ¹ì„±ì„ ë‹¤ë£¨ëŠ” ë˜ ë‹¤ë¥¸ ê¸°ë²•ì€ **ìœ ì‚¬ë„ í•¨ìˆ˜**ë¡œ ê³„ì‚°í•œ **íŠ¹ì„±ì„ ì¶”ê°€**í•˜ëŠ” ê²ƒì´ë‹¤.     
* **ìœ ì‚¬ë„ í•¨ìˆ˜ similaritiy function**: ê° ìƒ˜í”Œì´ íŠ¹ì • **ëœë“œ ë§ˆí¬ landmark** ì™€ ì–¼ë§ˆë‚˜ ë‹®ì•˜ëŠ”ì§€ ì¸¡ì •    

ì´í•´ê°€ ì•ˆë˜ë‹ˆ ì˜ˆë¥¼ ë“¤ì–´ë³´ì.    
ì•ì—ì„œ ë³¸ 1ì°¨ì› ë°ì´í„°ì…‹ì— ë‘ ê°œì˜ ëœë“œë§ˆí¬ $$x_1=-2$$ì™€ $$x_1=1$$ ì„ ì¶”ê°€í•˜ì    
![image](https://user-images.githubusercontent.com/76824611/147768257-6eb836ae-a32a-4b5f-adef-93548c3de325.png)

ê·¸ë¦¬ê³  ğ›¾ = 0.3 ì¸ ê°€ìš°ì‹œì•ˆ [ë°©ì‚¬ ê¸°ì € í•¨ìˆ˜ radial basis function(RBF)](https://en.wikipedia.org/wiki/Radial_basis_function) ë¥¼ **ìœ ì‚¬ë„ í•¨ìˆ˜**ë¡œ ì •ì˜í•´ë³´ì.     
ê·¸ë ‡ë‹¤ë©´ ê°€ìš°ì‹œì•ˆ RBFëŠ” ì•„ë˜ì™€ ê°™ë‹¤.   
*  ğ‘™: ëœë“œë§ˆí¬ ì§€ì       
*  ğ›¾: 0 ë³´ë‹¤ ì»¤ì•¼ í•˜ë©° ê°’ì´ ì‘ì„ìˆ˜ë¡ í­ì´ ë„“ì€ ì¢…ëª¨ì–‘ì´ ë¨    
![image](https://user-images.githubusercontent.com/76824611/147768559-ea6c41e6-8237-4f0d-ac1e-d0b7f3992c69.png)


<details>
<summary>ğŸ“œ ê°€ìš°ì‹œì•ˆ RBF íŠ¹ì„± ë³´ê¸°</summary>
<div markdown="1">
 
í•¨ìˆ˜ì˜ ê°’ì€ ì¢…ëª¨ì–‘ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ë©°,    
* 0ì— ê°€ê¹Œì›€: ëœë“œë§ˆí¬ì—ì„œ ì ì  ë©€ë¦¬ ë–¨ì–´ì§     
* 1ì— ê°€ê¹Œì›€: ëœë“œë§ˆí¬ì™€ ì ì  ê°€ê¹Œì›Œì§     

ë¹¨ê°„ì ì´ ëœë“œë§ˆí¬ê³  ì´ ëœë“œë§ˆí¬ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì¢…ëª¨ì–‘ì´ ê·¸ë ¤ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ    
ì‚¬ê°í˜•ìœ¼ë¡œ í‘œì‹œëœ ìƒ˜í”Œì€ ë‘ ê°œì˜ ëœë“œë§ˆí¬ ì¤‘ ì ì–´ë„ í•˜ë‚˜ì™€ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìŒ       
![image](https://user-images.githubusercontent.com/76824611/147768559-ea6c41e6-8237-4f0d-ac1e-d0b7f3992c69.png)

  
</div>
</details>  


ê·¸ëŸ¼ ì´ì œ ìƒˆë¡œìš´ íŠ¹ì„±ì„ ë§Œë“¤ì–´ë³´ì.   
ì˜ˆë¥¼ ë“¤ì–´ $$x_1=1$$ ìƒ˜í”Œì„ ì‚´í´ë³´ì.     
ì´ ìƒ˜í”Œì€ ì²« ë²ˆì§¸ ëœë“œë§ˆí¬ì—ì„œ 1 ë§Œí¼ ë–¨ì–´ì ¸ ìˆê³  ë‘ ë²ˆì§¸ ëœë“œë§ˆí¬ì—ì„œ 2 ë§Œí¼ ë–¨ì–´ì ¸ ìˆë‹¤.     \
![image](https://user-images.githubusercontent.com/76824611/147769402-cb553d2e-4303-4430-9e56-bc514eb84943.png)

ê·¸ëŸ¬ë¯€ë¡œ ìƒˆë¡œ ë§Œë“  íŠ¹ì„±ì€,    
$$x_2 = exp(â€”0.3 x 1^2) â‰ˆ 0.74$$ ì™€ $$x_3 = exp(-0.3 x 2^2)  â‰ˆ 0.30$$ ì´ë‹¤.    
![image](https://user-images.githubusercontent.com/76824611/147769916-1383032f-9111-4e11-9896-d9d1927ce847.png)

<details>
<summary>ğŸ“œ ëœë“œë§ˆí¬ ì„ íƒ ê¸°ì¤€ ë³´ê¸°</summary>
<div markdown="1">


ëœë“œë§ˆí¬ê°€ ì„ íƒë˜ì–´ì§€ëŠ” ê¸°ì¤€ì„ ì‚´í´ë³´ì.    

ëœë“œë§ˆí¬ë¥¼ ì„ ì •í•˜ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ ë°ì´í„°ì…‹ì— ìˆëŠ” **ëª¨ë“  ìƒ˜í”Œ ìœ„ì¹˜ì— ëœë“œë§ˆí¬ë¥¼ ì„¤ì •**í•˜ëŠ” ê²ƒì´ë‹¤.       
(ì¥ì )     
* ì°¨ì›ì´ ë§¤ìš° ì»¤ì§€ê³ ,       
* ë”°ë¼ì„œ ë³€í™˜ëœ í›ˆë ¨ì„¸íŠ¸ê°€ **ì„ í˜•ì **ìœ¼ë¡œ êµ¬ë¶„ë  ê¸°ëŠ¥ì„±ì´ ë†’ë‹¤.          
  
(ë‹¨ì )     
* í›ˆë ¨ ì„¸íŠ¸ì— ìˆëŠ” nê°œì˜ íŠ¹ì„±ì„ ê°€ì§„ mê°œì˜ ìƒ˜í”Œì´ mê°œì˜ íŠ¹ì„±ì„ ê°€ì§„ mê°œì˜ ìƒ˜í”Œë¡œ ë³€í™˜ë¨.     
* ì¦‰, í›ˆë ¨ ì„¸íŠ¸ê°€ ë§¤ìš° í´ ê²½ìš° ë™ì¼í•œ í¬ê¸°ì˜ ì•„ì£¼ ë§ì€ íŠ¹ì„±ì´ ë§Œë“¤ì–´ì§.

  
</div>
</details>  


<details>
<summary>ğŸ‘€ ê°€ìš°ì‹œì•ˆ RBFë¥¼ ì‚¬ìš©í•œ ìœ ì‚¬ë„ íŠ¹ì„± ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
def gaussian_rbf(x, landmark, gamma):
    return np.exp(-gamma * np.linalg.norm(x - landmark, axis=1)**2)

gamma = 0.3

x1s = np.linspace(-4.5, 4.5, 200).reshape(-1, 1)
x2s = gaussian_rbf(x1s, -2, gamma)
x3s = gaussian_rbf(x1s, 1, gamma)

XK = np.c_[gaussian_rbf(X1D, -2, gamma), gaussian_rbf(X1D, 1, gamma)]
yk = np.array([0, 0, 1, 1, 1, 1, 1, 0, 0])

plt.figure(figsize=(10.5, 4))

plt.subplot(121)
plt.grid(True, which='both')
plt.axhline(y=0, color='k')
plt.scatter(x=[-2, 1], y=[0, 0], s=150, alpha=0.5, c="red")
plt.plot(X1D[:, 0][yk==0], np.zeros(4), "bs")
plt.plot(X1D[:, 0][yk==1], np.zeros(5), "g^")
plt.plot(x1s, x2s, "g--")
plt.plot(x1s, x3s, "b:")
plt.gca().get_yaxis().set_ticks([0, 0.25, 0.5, 0.75, 1])
plt.xlabel(r"$x_1$", fontsize=20)
plt.ylabel(r"Similarity", fontsize=14)
plt.annotate(r'$\mathbf{x}$',
             xy=(X1D[3, 0], 0),
             xytext=(-0.5, 0.20),
             ha="center",
             arrowprops=dict(facecolor='black', shrink=0.1),
             fontsize=18,
            )
plt.text(-2, 0.9, "$x_2$", ha="center", fontsize=20)
plt.text(1, 0.9, "$x_3$", ha="center", fontsize=20)
plt.axis([-4.5, 4.5, -0.1, 1.1])

plt.subplot(122)
plt.grid(True, which='both')
plt.axhline(y=0, color='k')
plt.axvline(x=0, color='k')
plt.plot(XK[:, 0][yk==0], XK[:, 1][yk==0], "bs")
plt.plot(XK[:, 0][yk==1], XK[:, 1][yk==1], "g^")
plt.xlabel(r"$x_2$", fontsize=20)
plt.ylabel(r"$x_3$  ", fontsize=20, rotation=0)
plt.annotate(r'$\phi\left(\mathbf{x}\right)$',
             xy=(XK[3, 0], XK[3, 1]),
             xytext=(0.65, 0.50),
             ha="center",
             arrowprops=dict(facecolor='black', shrink=0.1),
             fontsize=18,
            )
plt.plot([-0.1, 1.1], [0.57, -0.1], "r--", linewidth=3)
plt.axis([-0.1, 1.1, -0.1, 1.1])
    
plt.subplots_adjust(right=1)

save_fig("kernel_method_plot")
plt.show()
```
  
![image](https://user-images.githubusercontent.com/76824611/147772471-d333a85a-bc6e-446d-94d1-365950d07111.png)

  
</div>
</details>

----
---


## ê°€ìš°ì‹œì•ˆ RBF ì»¤ë„
ë‹¤í•­ íŠ¹ì„± ë°©ì‹ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ìœ„ì—ì„œ ë§í•œ **ìœ ì‚¬ë„ íŠ¹ì„± ë°©ì‹**ë„ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì— ìœ ìš©í•˜ê²Œ ì‚¬ìš© ë  ìˆ˜ ìˆìŒ.      

ğŸš« ì¶”ê°€ íŠ¹ì„±ì„ ëª¨ë‘ ê³„ì‚°í•˜ë ¤ë©´ ì—°ì‚° ë¹„ìš©ì´ ë§ì´ ë“œëŠ”ë° íŠ¹íˆ í›ˆë ¨ ì„¸íŠ¸ê°€ í´ ê²½ìš° ë” ê·¸ëŸ¼.     

**[SOLUTION]**     
ì—¬ê¸°ì—ì„œ ì»¤ë„ íŠ¸ë¦­ì´ í•œ ë²ˆ ë” SVM ì˜ ë§ˆë²•ì„ ë§Œë“¬.       
ì»¤ë„ íŠ¸ë¦­ì€ ìœ ì‚¬ë„ íŠ¹ì„±ì„ ë§ì´ ì¶”ê°€í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë¹„ìŠ·í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ.     
ê·¸ëŸ¼ ê°€ìš°ì‹œì•ˆ RBF ì»¤ë„ì„ ì‚¬ìš©í•œ svc ëª¨ì ¤ì„ ì‹œë„í•´ë³´ì.     

```python
rbf_kernel_svm_clf = Pipeline([
        ("scaler", StandardScaler()),
        ("svm_clf", SVC(kernel="rbf", gamma=5, C=0.001))
    ])
rbf_kernel_svm_clf.fit(X, y)

# Pipeline(steps=[('scaler', StandardScaler()),
                ('svm_clf', SVC(C=0.001, gamma=5))])
```

![image](https://user-images.githubusercontent.com/76824611/147876811-bbb2e084-af36-4e82-93df-4622da9cf458.png)


ê·¸ëŸ¼ ì—¬ê¸°ì„œ í•˜ì´í¼íŒŒë¼ë¯¸í„° ë¥¼ ì¡°ì •í•´ë³´ì     



------

### í•˜ì´í¼íŒŒë¼ë¯¸í„°   
ê·œì œ ì—­í• ì„ í•¨      
**[gamma (y)]**   
* gamma ë¥¼ ì¦ê°€     
    * ì¢… ëª¨ì–‘ ê·¸ë˜í”„ê°€ ì¢ì•„ì ¸ì„œ ê° ìƒ˜í”Œì˜ ì˜í–¥ ë²”ìœ„ê°€ ì‘ì•„ì§.          
    * ê²°ì • ê²½ê³„ê°€ ì¡°ê¸ˆ ë” ë¶ˆê·œì¹™í•´ì§€ê³  ê° ìƒ˜í”Œì„ ë”°ë¼ êµ¬ë¶ˆêµ¬ë¶ˆí•˜ì„¸ íœ˜ì–´ì§.         
* gamma ë¥¼ ê°ì†Œ    
    * ë„“ì€ ì¢… ëª¨ì–‘ ê·¸ë˜í”„ë¥¼ ë§Œë“¦.    
    * ìƒ˜í”Œì´ ë„“ì€ ë²”ìœ„ì— ê±¸ì³ ì˜í–¥ì„ ì£¼ë¯€ë¡œ ê²°ì • ê²½ê³„ê°€ ë” ë¶€ë“œëŸ¬ì›Œì§        

â¡ï¸ ëª¨ë¸ì´ **ê³¼ëŒ€ì í•©**ì¼ ê²½ìš°ì—” **ê°ì†Œ**ì‹œì¼œì•¼í•˜ê³ ,   
**ê³¼ì†Œì í•©**ì¼ ê²½ìš°ì—”**ì¦ê°€**ì‹œì¼œì•¼í•¨      
[í•˜ì´í¼íŒŒë¼ë¯¸í„° C](https://yerimoh.github.io/ML3/#%EC%86%8C%ED%94%84%ED%8A%B8-%EB%A7%88%EC%A7%84-%EB%B6%84%EB%A5%98-soft-margin-classification)ì™€ ë¹„ìŠ·   
 
![image](https://user-images.githubusercontent.com/76824611/147877021-081b51cf-d35c-4852-9b4f-545e55b3b70a.png)


<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
from sklearn.svm import SVC

gamma1, gamma2 = 0.1, 5
C1, C2 = 0.001, 1000
hyperparams = (gamma1, C1), (gamma1, C2), (gamma2, C1), (gamma2, C2)

svm_clfs = []
for gamma, C in hyperparams:
    rbf_kernel_svm_clf = Pipeline([
            ("scaler", StandardScaler()),
            ("svm_clf", SVC(kernel="rbf", gamma=gamma, C=C))
        ])
    rbf_kernel_svm_clf.fit(X, y)
    svm_clfs.append(rbf_kernel_svm_clf)

fig, axes = plt.subplots(nrows=2, ncols=2, figsize=(10.5, 7), sharex=True, sharey=True)

for i, svm_clf in enumerate(svm_clfs):
    plt.sca(axes[i // 2, i % 2])
    plot_predictions(svm_clf, [-1.5, 2.45, -1, 1.5])
    plot_dataset(X, y, [-1.5, 2.45, -1, 1.5])
    gamma, C = hyperparams[i]
    plt.title(r"$\gamma = {}, C = {}$".format(gamma, C), fontsize=16)
    if i in (0, 1):
        plt.xlabel("")
    if i in (1, 3):
        plt.ylabel("")

save_fig("moons_rbf_svc_plot")
plt.show()
```
  
</div>
</details>



----
----

## ê³„ì‚° ë³µì¡ë„
LinearSVC íŒŒì´ì¬ í´ë˜ìŠ¤ëŠ” ì„ í˜• SVMì„ ìœ„í•œ ìµœì í™”ëœ ì•Œê³ ë¦¬ì¦˜ ì„ êµ¬í˜„í•œ ```liblinear``` ë¼ì´ë¸ŒëŸ¬ë¦¬ ê¸°ë°˜ì„      

**```liblinear``` ë¼ì´ë¸ŒëŸ¬ë¦¬**      
* ì»¤ë„ íŠ¸ë¦­ì„ ì§€ì›í•˜ì§€ ì•Šì§€ë§Œ í›ˆë ¨ ìƒ˜í”Œê³¼ íŠ¹ì„± ìˆ˜ì— ê±°ì˜ ì„ í˜•ì ìœ¼ë¡œ ëŠ˜ì–´ë‚¨      
* ì•Œê³ ë¦¬ì¦˜ì˜ í›ˆë ¨ì‹œê°„ ë³µì¡ë„: ëŒ€ëµ O(mxn)       
* ì •ë°€ë„ë¥¼ ë†’ì´ë©´ ì•Œê³ ë¦¬ì¦˜ì˜ ìˆ˜í–‰ì‹œê°„ì´ ê¸¸ì–´ì§     


![image](https://user-images.githubusercontent.com/76824611/147883937-c4787630-b9d5-4c40-b25a-a096554c950b.png)












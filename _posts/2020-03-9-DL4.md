---
title: "[05] Deep learning 1: ì˜¤ì°¨ì—­ì „ë²•(backpropagation) "
date:   2020-03-9
excerpt: "ì˜¤ì°¨ì—­ì „ë²•(backpropagation)ì„ ìœ„í•œ ê³„ì‚°ê·¸ë˜í”„ computational graph,í™œì„±í™” í•¨ìˆ˜ ê³„ì¸µ ì—­ì „íŒŒ êµ¬í˜„[ReLU, Sigmoid ê³„ì¸µ],Affine/Softmax êµ¬í˜„, ì˜¤ì°¨ì—­ì „íŒŒë²• êµ¬í˜„"
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---

# ëª©ì°¨   
- [ì˜¤ì°¨ì—­ì „ë²•(backpropagation)(=â€˜ì—­ì „íŒŒë²•â€™,â€˜ì—­ì „íŒŒâ€™)](#ì˜¤ì°¨ì—­ì „ë²•-backpropagation----ì—­ì „íŒŒë²•---ì—­ì „íŒŒ--)
- [ê³„ì‚°ê·¸ë˜í”„ computational graph](#ê³„ì‚°ê·¸ë˜í”„-computational-graph)
  * [ì—°ì‡„ë²•ì¹™ chain rule](#ì—°ì‡„ë²•ì¹™-chain-rule)
  * [ì—­ì „íŒŒ](#ì—­ì „íŒŒ)
    + [ë§ì…ˆ ë…¸ë“œì˜ ì—­ì „íŒŒ](#ë§ì…ˆ-ë…¸ë“œì˜-ì—­ì „íŒŒ)
    + [ê³±ì…ˆ ë…¸ë“œì˜ ì—­ì „íŒŒ](#ê³±ì…ˆ-ë…¸ë“œì˜-ì—­ì „íŒŒ)
- [í™œì„±í™” í•¨ìˆ˜ ê³„ì¸µ êµ¬í˜„](#í™œì„±í™”-í•¨ìˆ˜-ê³„ì¸µ-êµ¬í˜„)
  * [ReLU ê³„ì¸µ](#relu-ê³„ì¸µ)
  * [Sigmoid ê³„ì¸µ](#sigmoid-ê³„ì¸µ)
- [Affine/Softmax ê³„ì¸µ êµ¬í˜„í•˜ê¸°](#affine-softmax-ê³„ì¸µ-êµ¬í˜„í•˜ê¸°)
  * [Affine ê³„ì¸µ](#affine-ê³„ì¸µ)
  * [Softmax-with-Loss ê³„ì¸µ](#softmax-with-loss-ê³„ì¸µ)
- [ì˜¤ì°¨ì—­ì „íŒŒë²• êµ¬í˜„](#ì˜¤ì°¨ì—­ì „íŒŒë²•-êµ¬í˜„)
  * [ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜](#ì¸ìŠ¤í„´ìŠ¤-ë³€ìˆ˜)
  * [ë©”ì„œë“œ  ì„¤ëª…](#ë©”ì„œë“œ--ì„¤ëª…)
  * [point](#point)
  * [ì˜¤ì°¨ì—­ì „íŒŒë²•ìœ¼ë¡œ êµ¬í•œ ê¸°ìš¸ê¸° ê²€ì¦](#ì˜¤ì°¨ì—­ì „íŒŒë²•ìœ¼ë¡œ-êµ¬í•œ-ê¸°ìš¸ê¸°-ê²€ì¦)
- [ì •ë¦¬](#ì •ë¦¬)


---

ğŸ‘€, ğŸ¤·â€â™€ï¸ , ğŸ“œ    
ì´ ì•„ì´ì½˜ë“¤ì„ ëˆ„ë¥´ì‹œë©´ ì½”ë“œ, ê°œë… ë¶€ê°€ ì„¤ëª…ì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:)


------


# ì „ì²´ ë”¥ëŸ¬ë‹ í•™ìŠµê³¼ì •
ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„  ì–´ë”œ ë°°ìš¸ê¹Œ? 
ì „ì˜ í¬ìŠ¤íŠ¸ [ê²½ì‚¬í•˜ê°•ë²•](https://yerimoh.github.io/DL3.5/)ì—ì„  [ì˜¤ì°¨ê°’ì— ë”°ë¼](https://yerimoh.github.io/DL3/) ë§¤ê°œë³€ìˆ˜ë¥¼ ì˜¤ì°¨ê°€ ì—†ëŠ” ë°©í–¥ìœ¼ë¡œ ì¤„ì—¬ì£¼ëŠ” ê¸°ë³¸ì ì¸ ë©”ì„œë“œë¥¼ ë´¤ë‹¤.   

**ê·¸ëŸ¼ ì´ì œ ì´ ê²½ì‚¬í•™ìŠµë²•ì„ ì´ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ ëª¨ë¸ì˜ êµ¬í˜„ë²•ì¸ ì˜¤ì°¨ì—­ì „ë²•(backpropagation)ì„ ë³¼ ê²ƒì´ë‹¤**

![1](https://user-images.githubusercontent.com/76824611/131564918-5a425904-ff1e-46a1-8fe0-0acc9a5e48ce.png)







----

# í•™ìŠµ ë°©ì‹

ë§¤ê°œë³€ìˆ˜ì˜ ì¡°ì • ë°©ì‹(ìœ„ì˜ í•‘í¬ìƒ‰ ë¶€ë¶„)ì€ ë‹¤ìŒì˜ ê³¼ì •ì„ í†µí•´ ì§„í–‰ëœë‹¤.   

1ï¸âƒ£ ë¨¼ì € ì„ì˜ì˜ ì´ˆê¸° ê°€ì¤‘ì¹˜(W) ë¥¼ ì¤€ ë’¤ [ìˆœì „íŒŒ](https://yerimoh.github.io/DL2/)ë¥¼ í†µí•œ ê²°ê³¼ ê°’(output)(Y)ì„ ì–»ëŠ”ë‹¤      

![33](https://user-images.githubusercontent.com/76824611/131634126-1bb03d7e-eeee-40c2-b473-5e81ef2f7ba1.gif)


2ï¸âƒ£ ê³„ì‚° ê²°ê³¼ì™€ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê°’ ì‚¬ì´ì˜ [ì˜¤ì°¨](https://yerimoh.github.io/DL3/)ë¥¼ êµ¬í•œë‹¤    

![2](https://user-images.githubusercontent.com/76824611/131635389-2a1b6429-3b99-4631-8ad1-4d0369e36487.png)


3ï¸âƒ£ **ê²½ì‚¬ í•˜ê°•ë²•**ì„ ì´ìš©í•´ ë°”ë¡œ ì• ê°€ì¤‘ì¹˜ë¥¼ [ì˜¤ì°¨ê°€ ì‘ì•„ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ ì—…ë°ì´íŠ¸](https://yerimoh.github.io/DL4/)í•œë‹¤    
![222](https://user-images.githubusercontent.com/76824611/131638909-5184f4af-671d-46b5-8d83-d5bbd20192a9.gif)



4ï¸âƒ£ ë”ì´ìƒ ì˜¤ì°¨ê°€ ì¤„ì–´ë“¤ì§€ ì•Šì„ ë•Œ ê¹Œì§€ ìœ„ì˜ ê³¼ì •ì„ ë°˜ë³µí•œë‹¤

![444](https://user-images.githubusercontent.com/76824611/131639137-6e16128f-0ecb-4faf-a1e8-f7416a95e869.gif)


ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” 3ï¸âƒ£ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì“°ì´ëŠ” **ìˆ˜ë‹¨**ì¸ **ê²½ì‚¬ í•˜ê°•ë²•**ì„ ì´ìš©í•˜ì—¬ backpropagationí•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•´ ë³¼ ê²ƒì´ë‹¤      


---
---

     
# INTRO     
ì´ì „ í¬ìŠ¤íŠ¸ì—ì„œ Inputì—ì„œ Outputìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´ì„œ í™œì„±í™” í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ê²°ê³¼ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒê¹Œì§€ ë°°ì› ë‹¤.
â¡ [ì‹ ê²½ë§ì˜ êµ¬ì„±(í™œì„±í™” í•¨ìˆ˜)](https://yerimoh.github.io/DL2/)       
ì´ë ‡ê²Œ ì­‰ ì˜¤ëŠ” ê²ƒì„ **ìˆœì „íŒŒ(foward)** ë¼ê³  í•˜ë©° ë§ ê·¸ëŒ€ë¡œ ì•ìª½ìœ¼ë¡œ input ê°’ì„ ì „íŒŒ, ë³´ë‚´ëŠ” ê²ƒì´ë¼ê³  ë³´ë©´ ëœë‹¤. 

â›” PROBLEM   
í•˜ì§€ë§Œ ìš°ë¦¬ê°€ ì„ì˜ë¡œ í•œ ë²ˆ ìˆœì „íŒŒ í–ˆë‹¤ê³  ì¶œë ¥ ê°’ì´ ì •í™•í•˜ì§€ëŠ” ì•Šì„ ê²ƒì´ë‹¤.   
ì´ˆê¸° ê°€ì¤‘ì¹˜ëŠ” ê·¸ ë°ì´í„°ì˜ íŠ¹ì§•ì— ë§ëŠ” ê°€ì¤‘ì¹˜ê°€ ì•„ë‹Œ ìš°ë¦¬ê°€ ì„ì˜ë¡œ ì„¤ì •í•œ ëœë¤ ê°€ì¤‘ì¹˜ ì˜€ê¸° ë•Œë¬¸ì´ë‹¤.    
ìš°ë¦¬ê°€ ì„ì˜ë¡œ ì„¤ì •í•œ ê°€ì¤‘ì¹˜ ê°’ì´ inputì— ì˜í•´ì„œ í•œ ë²ˆ ì—…ë°ì´íŠ¸ ë˜ê¸´ í–ˆì§€ë§Œ ë§ì€ ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆë‹¤.   


â­• SOLUTION   
ì—­ì „íŒŒ ë°©ë²•ì€ **ê²°ê³¼ ê°’ì„ í†µí•´ì„œ** ë‹¤ì‹œ **ì—­ìœ¼ë¡œ** input ë°©í–¥ìœ¼ë¡œ **ì˜¤ì°¨ë¥¼ ë‹¤ì‹œ ë³´ë‚´ë©°** **ê°€ì¤‘ì¹˜ë¥¼ ì¬ì—…ë°ì´íŠ¸** í•˜ëŠ” ê²ƒì´ë‹¤.     
ê²°ê³¼ì— ì˜í–¥ì„ ë§ì´ ë¯¸ì¹œ ë…¸ë“œ(ë‰´ëŸ°)ì— ë” ë§ì€ ì˜¤ì°¨ë¥¼ ëŒë ¤ì¤„ ê²ƒì´ë‹¤.      

---
----


# Before backpropagation 
ê·¸ëŸ¼ ì´ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ì„œ ì „ì²´ í•™ìŠµ ê³¼ì •ì„ ê³„ì‚°ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë³´ì      
â¡ êµ­ì†Œì  ê³„ì‚°ì— ì§‘ì¤‘í•˜ê¸° ì¢‹ê¸° ë•Œë¬¸ì´ë‹¤    

**êµ­ì†Œì  ê³„ì‚°ì— ì§‘ì¤‘**     
ì „ì²´ ê³„ì‚°ì´ ë³µì¡í•˜ë”ë¼ë„ ê° ë‹¨ê³„ì—ì„œ í•˜ëŠ” ì¼ì€ í•´ë‹¹ ë…¸ë“œì˜ â€˜êµ­ì†Œì  ê³„ì‚°â€™.        
êµ­ì†Œì ì¸ ê³„ì‚°ì€ ë‹¨ìˆœí•˜ì§€ë§Œ, ê·¸ ê²°ê³¼ë¥¼ ì „ë‹¬í•¨ìœ¼ë¡œì„œ ì „ì²´ë¥¼ êµ¬ì„±í•˜ëŠ” ë³µì¡í•œ ê³„ì‚°ì„ í•´ë‚¼ ìˆ˜ ìˆìŒ       
ì¦‰ ê° ë…¸ë“œê°€ ìì‹ ì˜ ë…¸ë“œë§Œ ì‹ ê²½ì“´ë‹¤ëŠ” ëœ»ì´ë‹¤.

**[ê³„ì‚°ê·¸ë˜í”„ë¡œ í’€ê¸°]**     
![image](https://user-images.githubusercontent.com/76824611/119589259-67c8d780-be0d-11eb-9be3-26eee73882fc.png)
   
ê³„ì‚° ê²°ê³¼ë¥¼ ìœ„ì—(ì—ì§€)ì— ì ìŒ    
![image](https://user-images.githubusercontent.com/76824611/119589265-6bf4f500-be0d-11eb-800e-5e4f4dae4940.png)

**[ê³„ì‚°ê·¸ë˜í”„ì˜ íë¦„]**     
**1.** ê³„ì‚° ê·¸ë˜í”„ë¥¼ êµ¬ì„±      
**2.** ìˆœì „íŒŒ(forward propagation)     
* ê·¸ë˜í”„ì—ì„œ ê³„ì‚°ì„ **ì™¼ìª½**ì—ì„œ **ì˜¤ë¥¸ìª½**ìœ¼ë¡œ ì§„í–‰   
* ê³„ì‚° ê·¸ë˜í”„ì˜ ì¶œë°œì ë¶€í„° ì¢…ì°©ì ìœ¼ë¡œì˜ ì „íŒŒ          
* cf) **ì—­ì „íŒŒ backward propagation**: ë°˜ëŒ€ ë°©í–¥(ê·¸ë¦¼ì—ì„œ ë§í•˜ë©´ ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½)ì˜ ì „íŒŒ-> **ë¯¸ë¶„**ì„ ê³„ì‚°í•  ë•Œ ì¤‘ìš”í•œ ì—­í•       

<details>
<summary>ğŸ“œ ê³„ì‚°ê·¸ë˜í”„ computational graph  </summary>
<div markdown="1">

ê³„ì‚° ê³¼ì •ì„ ê·¸ë˜í”„(ìˆ˜ì˜ **ë…¸ë“œ node**ì™€ **ì—ì§€edge** í‘œí˜„)ë¡œ ë‚˜íƒ€ë‚¸ ê²ƒ         
[ë…¸ë“œì™€ ì—ì§€?](https://yerimoh.github.io/DL1/)

**[ê³„ì‚°ê·¸ë˜í”„ ì‚¬ìš© ì´ìœ ]**    
ì „ì²´ê°€ ì•„ë¬´ë¦¬ ë³µì¡í•´ë„ ê° ë…¸ë“œì—ì„œëŠ” ë‹¨ìˆœí•œ ê³„ì‚°ì— ì§‘ì¤‘í•˜ì—¬ ë¬¸ì œ **ë‹¨ìˆœí™”** ê°€ëŠ¥    
**ì¤‘ê°„ ê³„ì‚° ê²°ê³¼**ë¥¼ ëª¨ë‘ ë³´ê´€ê°€ëŠ¥   
ì—­ì „íŒŒë¥¼ í†µí•´ **â€˜ë¯¸ë¶„â€™ì˜ íš¨ìœ¨ì  ê³„ì‚°** 

  
</div>
</details> 	
	
       
<details>
<summary>ğŸ“œ êµ­ì†Œì  ê³„ì‚°  </summary>
<div markdown="1">

**êµ­ì†Œì **: â€˜ìì‹ ê³¼ ì§ì ‘ ê´€ê³„ëœ ì‘ì€ ë²”ìœ„â€™    
**êµ­ì†Œì  ê³„ì‚°**: ì „ì²´ì—ì„œ ì–´ë–¤ ì¼ì´ ë²Œì–´ì§€ë“  ìƒê´€X       
* ìì‹ ê³¼ ê´€ê³„ëœ ì •ë³´ë§Œìœ¼ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒ      
![image](https://user-images.githubusercontent.com/76824611/119589831-998e6e00-be0e-11eb-856f-b6ad04c2763a.png)
ê° ë…¸ë“œì—ì„œì˜ ê³„ì‚°ì€ êµ­ì†Œì  ê³„ì‚°     
ê° ë…¸ë“œëŠ” **ìì‹ ë§Œ ì‹ ê²½ ì”€**      
  
</div>
</details> 

--- 
---


# ì˜¤ì°¨ì—­ì „ë²• (backpropagation)
=â€˜ì—­ì „íŒŒë²•â€™,â€˜ì—­ì „íŒŒâ€™    

ê·¸ëŸ¼ ê³„ì‚° ê·¸ë˜í”„ë¡œ ìˆœì „íŒŒê¹Œì§€ êµ¬í˜„ì„ í•´ë’€ìœ¼ë‹ˆ ì—­ì „íŒŒë¥¼ í•´ë³´ì   

ì´ ì—­ì „íŒŒë¥¼ í†µí•´ì„œ ì¶œë ¥ê³¼ ì •ë‹µì˜ ì˜¤ì°¨ë¥¼ input ë…¸ë“œê¹Œì§€ ì „ë‹¬í•´ê°€ë©° ê° ê°€ì¤‘ì¹˜ë¥¼ ì—…ë°ì´íŠ¸ í•´ë‚˜ê°ˆ ê²ƒì´ë‹¤. 

ê·¸ëŸ¼ ì—­ì „íŒŒë¥¼ í•˜ë©° ê¸°ìš¸ê¸°ë¥¼ êµ¬í•˜ëŠ” ë²•ì€ ë¬´ì—‡ì¼ê¹Œ?   

ìˆœì „íŒŒ ì‹œ ê° ê³„ì‚°ì— ë”°ë¼ ë‹¤ë¥´ë‹¤ ì•„ë˜ì—ì„œ í™•ì¸í•´ë³´ì

--- 

## ì—°ì‡„ë²•ì¹™ chain rule

[ì •ì˜](https://ko.wikipedia.org/wiki/%EC%97%B0%EC%87%84_%EB%B2%95%EC%B9%99): í•©ì„±í•¨ìˆ˜ì˜ ë¯¸ë¶„ë²•       

**â€˜êµ­ì†Œì  ë¯¸ë¶„â€™ì„ ì „ë‹¬**í•˜ëŠ” ì›ë¦¬ëŠ” ì—°ì‡„ë²•ì¹™ ì— ë”°ë¥¸ ê²ƒì´ë‹¤           

**[ì—°ì‡„ë²•ì¹™(ê²‰ë¯¸ë¶„ ì†ë¯¸ë¶„)]**      
ì—°ì‡„ë²•ì¹™: **í•©ì„± í•¨ìˆ˜**ì˜ ë¯¸ë¶„ì— ëŒ€í•œ ì„±ì§ˆ           
* í•©ì„±í•¨ìˆ˜: **ì—¬ëŸ¬ í•¨ìˆ˜ë¡œ êµ¬ì„±**ëœ í•¨ìˆ˜    
* Ex) $$z = (x + y)^2  -> z = t^2  and  t = x + y$$  
  
**[ê³„ì‚° ê·¸ë˜í”„ì˜ ì—­ì „íŒŒ]**             
$$y = f (x)$$ë¼ëŠ” ê³„ì‚°ì˜ ì—­ì „íŒŒ     
![image](https://user-images.githubusercontent.com/76824611/119590739-52a17800-be10-11eb-84d1-b708a2fafe17.png)
* ì‹ í˜¸ Eì— ë…¸ë“œì˜ êµ­ì†Œì  ë¯¸ë¶„ $$ay/ax$$ë¥¼ ê³±í•œ í›„ ë‹¤ìŒë…¸ë“œë¡œ ì „ë‹¬      
* ì´ê²ƒì´ ê°€ëŠ¥í•œ ì´ìœ ëŠ” ì—°ì‡„ì ë²•ì¹™ ë•Œë¬¸                          

---

## ì—­ì „íŒŒ

### ë§ì…ˆ ë…¸ë“œì˜ ì—­ì „íŒŒ
**ê·¸ëŒ€ë¡œ** ì¶œë ¥    
* **1ì„ ê³±í•˜ê¸°ë§Œ í•  ë¿**ì´ë¯€ë¡œ ì…ë ¥ëœ ê°’ì„ ê·¸ëŒ€ë¡œ ë‹¤ìŒ ë…¸ë“œë¡œ ë³´ë‚´ê²Œ ë¨     
![image](https://user-images.githubusercontent.com/76824611/119591265-42d66380-be11-11eb-9090-bfba94b15148.png)

   
* $$L$$:  ìˆœì „íŒŒ ì‹œ ìµœì¢…ì ì¸ ì¶œë ¥ ê°’          
* $$z$$,     
  * $$x + y$$ ê³„ì‚°ê²°ê³¼ë¡œ, ê·¸ í° ê³„ì‚° ê·¸ë˜í”„ì˜ ì¤‘ê°„ ì–´ë”˜ê°€ì— ì¡´ì¬    
  * ìƒë¥˜ë¡œë¶€í„° ê°’ì´ ì „í•´ì§„ ê²ƒ    
  * í•˜ë¥˜ë¡œëŠ” $$âˆ‚L/âˆ‚x$$ê³¼ $$âˆ‚L/âˆ‚y$$ê°’ì„ ì „ë‹¬í•˜ëŠ” ê²ƒ     
  
<details>
<summary>ğŸ‘€ ë§ì…ˆ ë…¸ë“œ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  

**[ë‹¨ìˆœí•œ ê³„ì¸µ êµ¬í˜„í•˜ê¸°]**        
ë°‘ì˜ ê¸°ëŠ¥ì„ **ê³„ì¸µ ë‹¨ìœ„**ë¡œ êµ¬í˜„       
* ë§ì…ˆ ë…¸ë“œë¥¼ **â€˜AddLayerâ€™**    
* ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ **Sigmoid**    
* í–‰ë ¬ ê³±ì„  **Affine**   
	
```python 
class AddLayer:
  def__init__(self):
    pass

  def forward(self, x, y):
    out = x + y 
    return out

  def backward(self, dout): 
    dx = dout * 1
    dy = dout * 1
    return dx, dy

```
	
</div>
</details>


---


### ê³±ì…ˆ ë…¸ë“œì˜ ì—­ì „íŒŒ
**ì„œë¡œ ë°”ê¾¼ê°’** ê³±í•˜ê¸°  
* $$âˆ‚L/âˆ‚x=y$$.   
* $$âˆ‚L/âˆ‚y=x$$    
![image](https://user-images.githubusercontent.com/76824611/119591587-d7d95c80-be11-11eb-8d2c-b3b83b75819a.png)
**[ex]**  
![image](https://user-images.githubusercontent.com/76824611/119591609-e162c480-be11-11eb-9335-148799f3dec8.png)
* $$1.3 * 5 = 6.5$$.    
* $$1.3 * 10 = 13$$.
   
<details>
<summary>ğŸ‘€ ê³±ì…ˆë…¸ë“œ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
**[ë‹¨ìˆœí•œ ê³„ì¸µ êµ¬í˜„í•˜ê¸°]**        
ë°‘ì˜ ê¸°ëŠ¥ì„ **ê³„ì¸µ ë‹¨ìœ„**ë¡œ êµ¬í˜„       
* ê³±ì…ˆ ë…¸ë“œë¥¼ **â€˜MulLayerâ€™**      
* ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ **Sigmoid**      
* í–‰ë ¬ ê³±ì„  **Affine**    

	

**[ê³±ì…ˆ ê³„ì¸µ êµ¬í˜„]**       
ëª¨ë“  ê³„ì¸µì€ ```forward ( )```ìˆœì „íŒŒì™€ ```backward ( )```ì—­ì „íŒŒë¼ëŠ” ê³µí†µì˜ ë©”ì„œë“œ(ì¸í„°í˜ì´ìŠ¤)ë¥¼ ê°–ë„ë¡ êµ¬í˜„í•  ê²ƒ          
```python
class MulLayer:
    # ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì¸ xì™€ yë¥¼ ì´ˆê¸°í™”
    # ë‘ ë³€ìˆ˜ëŠ” ìˆœì „íŒŒì‹œì˜ ì…ë ¥ ê°’ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©
    def__init__(self):
        self.x = None 
        self.y = None

    # xì™€ yë¥¼ ì¸ìˆ˜ë¡œ ë°›ê³  ë‘ ê°’ì„ ê³±í•´ì„œ ë°˜í™˜
    def forward(self, x, y):
        self.x = x 
        self.y = y 
        out = x * y

        return out

    #ìƒë¥˜ì—ì„œ ë„˜ì–´ì˜¨ ë¯¸ë¶„(dout)ì— ìˆœì „íŒŒ ë•Œì˜ ê°’ì„ â€˜ì„œë¡œ ë°”ê¿”â€™ ê³±í•œ í›„ í•˜ë¥˜ë¡œ
    def backward(self, dout):
        dx = dout * self.y # x ì™€ y ë¥¼ ë°”ê¾¼ë‹¤.
        dy = dout * self.x
    
        return dx, dy
```
  
</div>
</details>

-----

### ì˜ˆì‹œ ì ìš©

**[ì˜ˆì‹œ ì„¤ëª…]**    
![image](https://user-images.githubusercontent.com/76824611/119591810-3f8fa780-be12-11eb-93d7-8679a8c7989b.png)
ì†Œë¹„ì„¸ì™€ ì‚¬ê³¼ ê°€ê²©ì´ ê°™ì€ ì–‘ë§Œí¼ ì˜¤ë¥¼ ë•Œ ì˜í–¥      
* ìµœì¢… ê¸ˆì•¡ì—ëŠ” ì†Œë¹„ì„¸ê°€ 200ì˜ í¬ê¸°ë¡œ,   
* ì‚¬ê³¼ ê°€ê²©ì´ 2.2 í¬ê¸°ë¡œ ì˜í–¥ì„ ì¤Œ     

ì£¼ì˜) ì´ ì˜ˆì—ì„œ ì†Œë¹„ì„¸ì™€ ì‚¬ê³¼ ê°€ê²©ì€ **ë‹¨ìœ„ê°€ ë‹¤ë¦„**     
* ì†Œë¹„ì„¸ 1ì€ 100%     
* ì‚¬ê³¼ ê°€ê²© 1ì€ 1ì›      



**[ì˜ˆì‹œ ì ìš© 1]**  
![image](https://user-images.githubusercontent.com/76824611/119592742-05270a00-be14-11eb-96fe-396d1b56520e.png)

<details>
<summary>ğŸ‘€ ì˜ˆì‹œ ì ìš© ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
 
```python
apple = 100
apple_num = 2
tax = 1.1

# ê³„ì¸µë“¤
mul_apple_layer = MulLayer() 
mul_tax_layer = MulLayer()

# ìˆœì „íŒŒ
apple_price = mul_apple_layer.forward(apple, apple_num) 
price = mul_tax_layer.forward(apple_price, tax)

print(price) # 220

# ì—­ì „íŒŒ
dprice = 1
## dapple_priceë¡œ dapple, dapple_numì— ì•ì˜ ì—­ì „íŒŒ ê²°ê³¼ ì „ë‹¬
## dapple_price = 1.1
dapple_price, dtax = mul_tax_layer.backward(dprice) 
dapple, dapple_num = mul _apple _layer.backward(dapple _price)

print(dapple, dapple _num, dtax) # 2.2 110 200
   
# backward ( )ê°€ ë°›ëŠ” ì¸ìˆ˜ëŠ” â€˜ìˆœì „íŒŒì˜ ì¶œë ¥ì— ëŒ€í•œ ë¯¸ë¶„â€™
```
  
</div>
</details>







**[ì˜ˆì‹œ ì ìš© 2]**   
ì´ë²ˆì—” ì•ì—ì„œ ë°°ìš´ ë§ì…ˆë…¸ë“œê¹Œì§€ 
![image](https://user-images.githubusercontent.com/76824611/119593500-099ff280-be15-11eb-805e-9525abf996a7.png)

<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
apple = 100
apple _num = 2
orange = 150
orange _num = 3
tax = 1.1

# ê³„ì¸µë“¤
mul_apple_layer = MulLayer() 
mul_orange_layer = MulLayer() 
add_apple_orange_layer = AddLayer() 
mul_tax_layer = MulLayer()

# ìˆœì „íŒŒ
apple_price = mul_appl _layer.forward(apple, apple_num)  
orange_price = mul_orange_layer.forward(orange, orange_num) 
all_price = add_apple_orange_layer.forward(apple_price,orange_price) 
price = mul_tax_layer.forward(all_price, tax) 

# ì—­ì „íŒŒ
dprice = 1
dall_price, dtax = mul_tax_layer.backward(dprice) 
dapple_price, dorange_price = add_apple _orange_layer.backward(dall _price)
dorange, dorange _num = mul_orange_layer.backward(dorange_price) 
dapple, dapple_num = mul_apple_layer.backward(dapple_price) 

print(price) # 715
print(dapple_num, dapple, dorange, dorange_num, dtax) 
# 110 2.2 3.3 165 650
```
  
</div>
</details>


---
---



# í™œì„±í™” í•¨ìˆ˜ ê³„ì¸µ ì—­ì „íŒŒ êµ¬í˜„
[í™œì„±í™” í•¨ìˆ˜ë€?](https://yerimoh.github.io/DL2/)     
ê³„ì‚° ê·¸ë˜í”„ë¥¼ ì‹ ê²½ë§ì— ì ìš©   

## ReLU ê³„ì¸µ
![image](https://user-images.githubusercontent.com/76824611/131722824-a5490e97-282b-4649-8d32-7ed107206a67.png)

**[ì—­ì „íŒŒ]**     
![image](https://user-images.githubusercontent.com/76824611/131722867-ef617b4a-7d33-47bc-bfa1-82f31dd669d8.png)
* ìˆœì „íŒŒ ì‹œ **$$x> 0$$**: ì—­ì „íŒŒëŠ” ìƒë¥˜ì˜ ê°’ì„ **ê·¸ëŒ€ë¡œ** í•˜ë¥˜ë¡œ í˜ë¦¼
* ìˆœì „íŒŒ ì‹œ **$$x<= 0$$**: ì—­ì „íŒŒ ë•ŒëŠ” í•˜ë¥˜ë¡œ **ì‹ í˜¸ë¥¼ ë³´ë‚´ì§€X** (0ì„ ë³´ëƒ„)

<details>
<summary>ğŸ‘€ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
class Relu:
  # maskë¼ëŠ” ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ê°€ì§‘ë‹ˆë‹¤
  # maskëŠ” True/Falseë¡œ êµ¬ì„±ëœ ë„˜íŒŒì´ ë°°ì—´
  # ìˆœì „íŒŒì˜ ì…ë ¥ì¸ xì˜ ì›ì†Œ ê°’ì´ 0 ì´í•˜ì¸ ì¸ë±ìŠ¤ëŠ” True,
  # ê·¸ ì™¸(0ë³´ë‹¤ í° ì›ì†Œ)ëŠ” Falseë¡œ ìœ ì§€
  def __init__(self):
    self.mask = None

  def forward(self, x): 
    # "ìˆœì „íŒŒ ë•Œì˜ ì…ë ¥ ê°’ì´ 0 ì´í•˜ë©´" ìˆœì „íŒŒ ì‹œì˜ ê°’ì€ 0ì´ ë¼ì•¼ í•¨.
    self.mask = (x < = 0) 
    # 0ì´ìƒ ì´ë©´ ê·¸ëƒ¥ ë˜‘ê°™ì€ê±° ë³´ëƒ„
    out = x.copy() 
    # ìˆœì „íŒŒ ë•Œì˜ ì…ë ¥ ê°’ì´ 0 ì´í•˜ë©´ "ìˆœì „íŒŒ ì‹œì˜ ê°’ì€ 0ì´ ë¼ì•¼ í•¨".
    out[self.mask] = 0
    return out

  def backward(self, dout):
    # "ìˆœì „íŒŒ ë•Œì˜ ì…ë ¥ ê°’ì´ 0 ì´í•˜ë©´" ì—­ì „íŒŒ ë•Œì˜ ê°’ì€ 0ì´ ë¼ì•¼ í•¨.
    ## ì—­ì „íŒŒ ë•ŒëŠ” ìˆœì „íŒŒ ë•Œ ë§Œë“¤ì–´ë‘” maskë¥¼ ì¨ì„œ maskì˜ ì›ì†Œê°€ Trueì¸ ê³³ì—ëŠ” 
    ## ìƒë¥˜ì—ì„œ ì „íŒŒëœ doutì„ 0ìœ¼ë¡œ ì„¤ì •
    dout[self.mask] = 0
    dx = dout
    return dx
```
  
</div>
</details>


---


## Sigmoid ê³„ì¸µ
**[ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜](https://yerimoh.github.io//DL2/#sigmoid-function%EC%8B%9C%EA%B7%B8%EB%AA%A8%EC%9D%B4%EB%93%9C-%ED%95%A8%EC%88%98)**       

**[ì—­ì „íŒŒ]**    
[ìˆœì „íŒŒ]
![image](https://user-images.githubusercontent.com/76824611/119597493-196f0500-be1c-11eb-8c09-b5e88ff05831.png)

[ì—­ì „íŒŒ]
![image](https://user-images.githubusercontent.com/76824611/119597500-1d028c00-be1c-11eb-9589-de894e3b65e7.png)



**[1ë‹¨ê³„]**        
**â€˜/â€™ ë…¸ë“œ**, ì¦‰ $$y= 1/x$$ ë¯¸ë¶„
* ì—­ìœ¼ë¡œ ë°”ê¾¼ ê²ƒ, ì¦‰ $$* x^{-1}$$í•œ ê²ƒ ë¯¸ë¶„
* ì—­ì „íŒŒ ë•ŒëŠ” ìƒë¥˜ì—ì„œ í˜ëŸ¬ì˜¨ ê°’ì— $$-y^2$$ì„ ê³±í•´ì„œ í•˜ë¥˜ë¡œ ì „ë‹¬   
  &&ay/ax= -1/x^2 = -y^2 &&
  
 
**[2ë‹¨ê³„]**         
**â€˜+â€™ ë…¸ë“œ**, ìƒë¥˜ì˜ ê°’ì„ ì—¬ê³¼ ì—†ì´ í•˜ë¥˜ë¡œ ë‚´ë³´ëƒ„. 
![image](https://user-images.githubusercontent.com/76824611/119599433-f5152780-be1f-11eb-8b72-f6e275fc22a9.png)


**[3ë‹¨ê³„]**      
**â€˜expâ€™ ë…¸ë“œ**, $$y = exp (x)$$ ì—°ì‚°ì„ ìˆ˜í–‰      
  &&ay/ax=  exp(x) =  exp(-x) &&
![image](https://user-images.githubusercontent.com/76824611/119599486-0d854200-be20-11eb-8bc3-511c49c31283.png)
    
**[4ë‹¨ê³„]**      
**â€˜Ã—â€™ ë…¸ë“œ**, ìˆœì „íŒŒ ë•Œì˜ ê°’ì„ â€˜ì„œë¡œ ë°”ê¿”â€™ ê³±í•¨.      
* ì´ ì˜ˆì—ì„œëŠ” -1ì„ ê³±í•˜ë©´ ë¨      
![image](https://user-images.githubusercontent.com/76824611/119599600-4b826600-be20-11eb-974d-420f62ceb5f7.png)

* ì´ë¥¼ í•˜ë‚˜ì˜ ë…¸ë“œë¡œ í‘œí˜„í•˜ë©´
![image](https://user-images.githubusercontent.com/76824611/119600222-90f36300-be21-11eb-8c9b-03b455e53711.png)

* ìœ„ë¥¼ ì „ê°œí•œ ì‹ì€
![image](https://user-images.githubusercontent.com/76824611/119600228-92bd2680-be21-11eb-9377-5925b802f9ba.png)

* ê·¸ëŸ¼ ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ì—­ì „íŒŒ ê²°ê³¼ ë‚˜ì˜¤ê²Œ ëœë‹¤
![image](https://user-images.githubusercontent.com/76824611/119600233-951f8080-be21-11eb-9f02-49df61a8b967.png)


   
<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python  
class Sigmoid:
	def __init __(self):
		self.out = None

	def forward(self, x):
		out = 1 / (1 + np.exp(-x)) 
		# ìˆœì „íŒŒì˜ ì¶œë ¥ì„ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ outì— ë³´ê´€
		## ì—­ì „íŒŒ ê³„ì‚° ë•Œ ê·¸ ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤
		self.out = out

		return out

	# self.out = y
	def backward(self, dout):
		dx = dout * (1.0 - self.out) * self.out

		return dx
```
  
</div>
</details>

---


# Affine/Softmax ê³„ì¸µ ì—­ì „íŒŒ êµ¬í˜„í•˜ê¸°

## Affine ê³„ì¸µ
ì‹ ê²½ë§ì˜ **ìˆœì „íŒŒ**ì—ì„œëŠ” **ê°€ì¤‘ì¹˜ ì‹ í˜¸ì˜ ì´í•©ì„ ê³„ì‚°**í•˜ê¸° ë•Œë¬¸ì— **í–‰ë ¬ì˜ ê³±(ë„˜íŒŒì´ì—ì„œëŠ” np.dot ( ) )ì„ ì‚¬ìš©**         

![image](https://user-images.githubusercontent.com/76824611/119601397-0e1fd780-be24-11eb-8fc4-e1855632c87b.png)

(ì‹ ê²½ë§)ìˆœì „íŒŒì˜ íë¦„     
* $$Y = np.dot (X, W ) + B$$ì²˜ëŸ¼ ê³„ì‚°.       
* Yë¥¼ **í™œì„±í™” í•¨ìˆ˜ë¡œ ë³€í™˜**í•´ ë‹¤ìŒ ì¸µìœ¼ë¡œ ì „íŒŒí•˜ëŠ” ê²ƒ    

ì–´íŒŒì¸ ë³€í™˜ (affine transformation): ì‹ ê²½ë§ì˜ ìˆœì „íŒŒ ë•Œ ìˆ˜í–‰í•˜ëŠ” í–‰ë ¬ì˜ ê³±    
* Affine ê³„ì¸µ: ì–´íŒŒì¸ ë³€í™˜ì„ ìˆ˜í–‰í•˜ëŠ” ì²˜ë¦¬    
* ë…¸ë“œê³„ì‚°ì‹œ ê°ë³€ìˆ˜ì˜ ì´ë¦„ ìœ„ì— ê·¸ ë³€ìˆ˜ì˜ í˜•ìƒë„ í‘œê¸°    
![image](https://user-images.githubusercontent.com/76824611/119775747-fd905f80-befe-11eb-819c-628b54a26833.png)
* ì§€ê¸ˆê¹Œì§€ì˜ ê³„ì‚° ê·¸ë˜í”„: ë…¸ë“œ ì‚¬ì´ì— â€˜ìŠ¤ì¹¼ë¼ê°’â€™ì´ íë¦„     
* ì–´íŒŒì¸ ë³€í™˜(ì•„í•€ ë³€í™˜):â€˜í–‰ë ¬â€™ì´ íë¦„    



**[ì—­ì „íŒŒ]**     
ê³±í•˜ê¸°ì™€ ê°™ìŒ       
ê³±í•  ë•Œ ë‹¤ë¥¸ê±° ê³±(í•˜ì§€ë§Œ **ì „ì¹˜(T)í•„ìš”**!!)    
![image](https://user-images.githubusercontent.com/76824611/119602878-19283700-be27-11eb-8033-1858463dbde4.png)
![image](https://user-images.githubusercontent.com/76824611/119602881-1af1fa80-be27-11eb-9f6f-70aebe370835.png)
[1ë‹¨ê³„]  
![image](https://user-images.githubusercontent.com/76824611/119602987-4bd22f80-be27-11eb-842d-a5a7018a97cb.png)
[2ë‹¨ê³„]
![image](https://user-images.githubusercontent.com/76824611/119603004-5260a700-be27-11eb-815e-1861787e3185.png)
     
### ë°°ì¹˜ìš© Affine ê³„ì¸µ
ì§€ê¸ˆê¹Œì§„  ì…ë ¥ ë°ì´í„°ë¡œ **X í•˜ë‚˜ë§Œì„ ê³ ë ¤**     
**ë°°ì¹˜-ë¬¶ì€ ë°ì´í„°**: **ë°ì´í„° Nê°œë¥¼ ë¬¶ì–´** ìˆœì „íŒŒí•˜ëŠ” ê²½ìš°       
* ê¸°ì¡´ê³¼ ë‹¤ë¥¸ ë¶€ë¶„ì€ ì…ë ¥ì¸ Xì˜ í˜•ìƒì´ (N, 2)ê°€ ëœ ê²ƒ
![image](https://user-images.githubusercontent.com/76824611/119603104-82a84580-be27-11eb-9629-6dd20a3d14dc.png)

<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
class Affine:
	def __init __(self, W, b):
		self.W = W 
		self.b = b 
		self.x = None 
		self.dW = None 
		self.db = None

	def forward(self, x):
		self.x = x 
		out = np.dot(x, self.W) + self.b
		return out

	def backward(self, dout):
		dx = np.dot(dout, self.W.T) 
		self.dW = np.dot(self.x.T, dout) 
		#[3]êµ¬í˜„ ì–˜ëŠ” ì—´ë¡œ ë”í•´ë²„ë ¤
		self.db = np.sum(dout, axis = 0)
		return dx
```
  
</div>
</details>
	
----

## Softmax-with-Loss ê³„ì¸µ
**ì¶œë ¥ì¸µ**ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜   
* ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ëŠ” **ì…ë ¥ ê°’ì„ ì •ê·œí™”**í•˜ì—¬ ì¶œë ¥(í™•ë¥ ë¡œ ì¶œë ¥)   
![image](https://user-images.githubusercontent.com/76824611/119603388-0bbf7c80-be28-11eb-9a8d-e2893a616ca0.png)
**1)** **ì…ë ¥ ì´ë¯¸ì§€**ê°€ Affine ê³„ì¸µê³¼ ReLU ê³„ì¸µì„ í†µê³¼í•˜ë©° **ë³€í™˜**ë˜ê³ ,   
**2)** ë§ˆì§€ë§‰ Softmax ê³„ì¸µì— ì˜í•´ì„œ 10ê°œì˜ ì…ë ¥ì´ **ì •ê·œí™”**        

* **ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ì˜ ì´ìš©**: ì‹ ê²½ë§ì—ì„œ í•™ìŠµê³¼ ì¶”ë¡ ì¤‘ **í•™ìŠµ**ì— ì£¼ë¡œ ì´ìš©      
   * ì¶”ë¡ ì—ëŠ” ì œì¼ ë†’ì€ ê°’ë§Œ í•„ìš”í•˜ê¸° ë•Œë¬¸      
* **ì ìˆ˜(score)**: ì‹ ê²½ë§ì—ì„œ ~~ì •ê·œí™”í•˜ì§€ ì•ŠëŠ”~~ ì¶œë ¥ ê²°ê³¼(ê·¸ë¦¼ì—ì„  Softmax ì• Affine ê³„ì¸µì˜ ì¶œë ¥)    
   * ì£¼ë¡œ 'í•™ìŠµ'ì— ì´ìš©    

**[Softmaxwith-Loss ê³„ì¸µ]** 
ì†ì‹¤ í•¨ìˆ˜ì¸ [êµì°¨ ì—”íŠ¸ë¡œí”¼ ì˜¤ì°¨](https://yerimoh.github.io//DL3/#%EA%B5%90%EC%B0%A8-%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC-%EC%98%A4%EC%B0%A8cross-entropy-error-cee)ë„ í¬í•¨       
â€˜Softmaxâ€™ ê³„ì¸µ+â€˜Cross Entropy Errorâ€™    
![image](https://user-images.githubusercontent.com/76824611/119621300-e9862880-be40-11eb-8631-a6ce44a62d57.png)
    

(ê°„ì†Œí™”)
![image](https://user-images.githubusercontent.com/76824611/119621747-7204c900-be41-11eb-86d5-07fe41ee2d64.png)
* **ì…ë ¥**: $$(a_1 , a_2 , a_3 )$$    
* **Softmax ê³„ì¸µ ì¶œë ¥**: $$(y_1 , y_2 , y_3)$$   
* **ì •ë‹µ ë ˆì´ë¸”**: $$(t_1 , t_2 , t_3 )$$   
* **Cross Entropy Error ì¶œë ¥**: ì†ì‹¤ L    
* **Softmax-with-Loss ê³„ì¸µ ì—­ì „íŒŒ ê²°ê³¼**: $$(y_1 - t_1 , y_2 -t_2 , y_3 - t_3 )$$

(êµ¬ì²´í™”)       
**[1 ìˆœì „íŒŒ]**    
**(1) Softmax ê³„ì¸µ**  
![image](https://user-images.githubusercontent.com/76824611/119631668-15a6a700-be4b-11eb-991e-293274ba8273.png)
![image](https://user-images.githubusercontent.com/76824611/119631683-19d2c480-be4b-11eb-9115-df737d4d5e53.png)
* ìµœì¢… ì¶œë ¥ì€ $$(y_1 , y_2 , y_3)$$

**(2) Cross Entropy Error ê³„ì¸µ**
![image](https://user-images.githubusercontent.com/76824611/119632293-a2516500-be4b-11eb-9333-1d6c09bcf612.png)
![image](https://user-images.githubusercontent.com/76824611/119632307-a4b3bf00-be4b-11eb-8bd0-d740503f549f.png)
     
**[2 ì—­ì „íŒŒ]**       
**(1) Cross Entropy Error ê³„ì¸µ**   
![image](https://user-images.githubusercontent.com/76824611/119632527-da58a800-be4b-11eb-83a9-481a44cc4f8a.png)
**ì£¼ì˜**    
* ì—­ì „íŒŒì˜ ì´ˆê¹ƒê°’, ì¦‰ ê°€ì¥ ì˜¤ë¥¸ìª½ ì—­ì „íŒŒì˜ ê°’ì€ $$1(aL/aL =1)$$        
* **â€˜Ã—â€™ ë…¸ë“œ**ì˜ ì—­ì „íŒŒëŠ” ìˆœì „íŒŒ ì‹œì˜ ì…ë ¥ë“¤ì˜ ê°’ì„ â€˜ì„œë¡œ ë°”ê¿”â€™ ìƒë¥˜ì˜ ë¯¸ë¶„ì— ê³±í•˜ê³  í•˜ë¥˜ë¡œ í˜ë¦¼      
* **â€˜+â€™ ë…¸ë“œ**ì—ì„œëŠ” ìƒë¥˜ì—ì„œ ì „í•´ì§€ëŠ” ë¯¸ë¶„ì„ ê·¸ëŒ€ë¡œ í˜ë¦¼    
* **â€˜logâ€™ ë…¸ë“œ**ì˜ ì—­ì „íŒŒëŠ” ë‹¤ìŒ ì‹ì„ ë”°ë¦„
  * $$y- log x$$,
  * $$âˆ‚y/âˆ‚x = 1/x$$.   
   
**(2) Softmax ê³„ì¸µ**
(1ë‹¨ê³„)
![image](https://user-images.githubusercontent.com/76824611/119633258-85696180-be4c-11eb-9fe4-c3c877018739.png)
![image](https://user-images.githubusercontent.com/76824611/119633443-b5b10000-be4c-11eb-98ce-a73126e50fa8.png)
(2ë‹¨ê³„)     
**â€˜/â€™ ë…¸ë“œ**ì˜ ì—­ì „íŒŒ:```â€˜ìƒë¥˜ì—ì„œ í˜ëŸ¬ì˜¨ ê°’â€™```x```â€˜ìˆœì „íŒŒ ë•Œì˜ ì¶œë ¥ì„ ì œê³±í•œ í›„ ë§ˆì´ë„ˆìŠ¤ë¥¼ ë¶™ì¸ ê°’â€™```ì„ í•˜ë¥˜ ì „ë‹¬.      
* ```â€˜ìƒë¥˜ì—ì„œ í˜ëŸ¬ì˜¨ ê°’â€™```:  $$(-t_1 S) + (-t_2 S) + (-t_3 S)$$ $$= -S(t_1 + t_2 + t_3 )$$    
* ```â€˜ìˆœì „íŒŒ ë•Œì˜ ì¶œë ¥â€™```: $$1/S$$
ì—­ì „íŒŒì˜ ì¶œë ¥
* $$-S(t_1 + t_2 + t_3 ) * (-1/S)^2$$.  
* $$= (t_1 + t_2 + t_3 ) * (1/S)$$.  
* ![image](https://user-images.githubusercontent.com/76824611/119634329-9e264700-be4d-11eb-8ceb-50c4841d982d.png)
(3ë‹¨ê³„)     
â€˜xâ€™ëŠ” ë°”ê¿”ì„œ ì—°ì‚°
![image](https://user-images.githubusercontent.com/76824611/119634457-bc8c4280-be4d-11eb-8b31-4b2e312f2bce.png)
(4ë‹¨ê³„)    
â€˜expâ€™ ë…¸ë“œ ì—­ì „íŒŒ: ë‘ ê°ˆë˜ì˜ ì…ë ¥ì˜ í•©ì— $$exp(a_1 )$$ì„ ê³±í•œ ìˆ˜ì¹˜    
![image](https://user-images.githubusercontent.com/76824611/119634688-f1989500-be4d-11eb-9c5f-34c237dcbe64.png)
![image](https://user-images.githubusercontent.com/76824611/119634695-f4938580-be4d-11eb-9142-205b06baa28b.png)
![image](https://user-images.githubusercontent.com/76824611/119634566-d3329980-be4d-11eb-8943-cd3132623dd1.png)

     
    

**[ì •ë¦¬]**    
![image](https://user-images.githubusercontent.com/76824611/119634600-d9c11100-be4d-11eb-87e6-9f6dc734cc00.png)
* **ì‹ ê²½ë§ì˜ ì—­ì „íŒŒ**: ì´ ì°¨ì´ì¸ **ì˜¤ì°¨**ê°€ ì• ê³„ì¸µì— **ì „í•´ì§€ëŠ” ê²ƒ**     
   * $$(y_1 - t_1 , y_2 - t_2 , y_3 - t_3 )$$: Softmax ê³„ì¸µì˜ ì¶œë ¥ê³¼ ì •ë‹µ ë ˆì´ë¸”ì˜ ì°¨.        
* **ì‹ ê²½ë§ í•™ìŠµì˜ ëª©ì **: ì‹ ê²½ë§ì˜ **ì¶œë ¥**(Softmaxì˜ ì¶œë ¥)ì´ **ì •ë‹µ ë ˆì´ë¸”**ê³¼ ê°€ê¹Œì›Œì§€ë„ë¡ **ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜**ì˜ ê°’ì„ ì¡°ì •í•˜ëŠ” ê²ƒ       
   * ê·¸ë˜ì„œ ì‹ ê²½ë§ì˜ ì¶œë ¥ê³¼ ì •ë‹µ ë ˆì´ë¸”ì˜ ì˜¤ì°¨ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì• ê³„ì¸µì— ì „ë‹¬

ex) êµ¬ì²´ì ì¸ ì˜ˆ     
ì •ë‹µ ë ˆì´ë¸”ì´ (0, **1**, 0 )ì¼ ë•Œ, Softmax ê³„ì¸µì´ (0.3, **0.2**, 0.5 )ë¥¼ ì¶œë ¥    
* ì •ë‹µ ë ˆì´ë¸”ì„ ë³´ë©´ ì •ë‹µì˜ ì¸ë±ìŠ¤ëŠ” 1.      
* ê·¸ëŸ°ë° ì¶œë ¥ì—ì„œëŠ” ì´ë•Œì˜ í™•ë¥  ê²¨ìš° 0.2 (20%)ë¼ì„œ, ì´ ì‹œì ì˜ ì‹ ê²½ë§ì€ ì œëŒ€ë¡œ ì¸ì‹X     
  * ì´ ê²½ìš° Softmax ê³„ì¸µì˜ ì—­ì „íŒŒëŠ” (0.3, -0.8, 0.5 )ë¼ëŠ” ì»¤ë‹¤ë€ ì˜¤ì°¨ë¥¼ ì „íŒŒ     
  * ê²°ê³¼ì ìœ¼ë¡œ Softmax ê³„ì¸µì˜ ì• ê³„ì¸µë“¤ì€ ê·¸ í° ì˜¤ì°¨ë¡œë¶€í„° í° ê¹¨ë‹¬ìŒì„ ì–»ê²Œ ë¨     

<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
class SoftmaxWithLoss: 
	def __init __(self):
		self.loss = None # ì†ì‹¤
		self.y = None # softmax ì˜ ì¶œë ¥
		self.t = None # ì •ë‹µ ë ˆì´ë¸”(ì›-í•« ë²¡í„°)

	def forward(self, x, t):
		self.t = t 
		self.y = softmax(x) 
		# ì†Œí”„íŠ¸ ë§¥ìŠ¤ì˜ ì¶œë ¥ê³¼ ì •ë‹µë ˆì´ë¸”ì„ ë¹„êµ
		self.loss = cross_entropy_error(self.y, self.t) 

		return self.loss

	# ì—­ì „íŒŒ ë•ŒëŠ” ì „íŒŒí•˜ëŠ” ê°’ì„ ë°°ì¹˜ì˜ ìˆ˜(batch_size) ë¡œ ë‚˜ëˆ ì„œ 
	# ë°ì´í„° 1ê°œë‹¹ ì˜¤ì°¨ë¥¼ ì• ê³„ì¸µìœ¼ë¡œ ì „íŒŒí•˜ëŠ” ì ì— ì£¼ì˜
	def backward(self, dout = 1):
		batch_size = self.t.shape[0] 
		dx = (self.y - self.t) / batch_size

		return dx
```
  
</div>
</details>




----


### ì˜¤ì°¨ì—­ì „íŒŒë²• êµ¬í˜„
ì‹ ê²½ë§ í•™ìŠµì˜ ì „ì²´ ê·¸ë¦¼(4ë‹¨ê³„)ì˜ [2ë‹¨ê³„ ê¸°ìš¸ê¸° ì‚°ì¶œ]ì—ì„œ ì˜¤ë˜ê±¸ë¦¬ëŠ” ~~ìˆ˜ì¹˜ë¯¸ë¶„~~ ëŒ€ì‹  **ê¸°ìš¸ê¸°ë¥¼ íš¨ìœ¨ì ì´ê³  ë¹ ë¥´ê²Œ**êµ¬í•  ìˆ˜ ìˆìŒ       
* êµ¬í˜„: 2ì¸µ ì‹ ê²½ë§ì„ TwoLayerNet í´ë˜ìŠ¤ë¡œ êµ¬í˜„   


<details>
<summary>ğŸ“œ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ë³´ê¸°</summary>
<div markdown="1">
	
```params```: ë”•ì…”ë„ˆë¦¬ ë³€ìˆ˜ë¡œ, ì‹ ê²½ë§ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë³´ê´€     
* ```params['W1']```: 1ë²ˆì§¸ ì¸µì˜ ê°€ì¤‘ì¹˜, params['b1']ì€ 1ë²ˆì§¸ ì¸µì˜ í¸í–¥     
* ```params['W2']```: 2ë²ˆì§¸ ì¸µì˜ ê°€ì¤‘ì¹˜, params['b2']ëŠ” 2ë²ˆì§¸ ì¸µì˜ í¸í–¥    

```layers```: ìˆœì„œê°€ ìˆëŠ” ë”•ì…”ë„ˆë¦¬ ë³€ìˆ˜ë¡œ, ì‹ ê²½ë§ì˜ ê³„ì¸µì„ ë³´ê´€ layers['Affine1'], layers['Relu1'], ```layers['Affine2']```ì™€ ê°™ì´ ê° ê³„ì¸µì„ ìˆœì„œëŒ€ë¡œ ìœ ì§€  
```lastLayer```: ì‹ ê²½ë§ì˜ ë§ˆì§€ë§‰ ê³„ì¸µ
* ì´ ì˜ˆì—ì„œëŠ” SoftmaxWithLoss ê³„ì¸µ
	
  
</div>
</details>  

<details>
<summary>ğŸ“œ ë§¤ì„œë“œ ì„¤ëª… ë³´ê¸°</summary>
<div markdown="1">
	
```__init__(self,input_size,hidden_ size,output_size,weight_init_ std)```: ì´ˆê¸°í™”ë¥¼ ìˆ˜í–‰     
* ```input_size```: ì…ë ¥ì¸µ ë‰´ëŸ° ìˆ˜     
* ```hidden_ size```: ì€ë‹‰ì¸µ ë‰´ëŸ° ìˆ˜    
* ```output_size```: ì¶œë ¥ì¸µ ë‰´ëŸ° ìˆ˜  
* ```weight_init_ std```: ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” ì‹œ ì •ê·œë¶„í¬ì˜ ìŠ¤ì¼€ì¼    

```predict(self, x)```:	ì˜ˆì¸¡(ì¶”ë¡ )ì„ ìˆ˜í–‰        
* ```x```: ì´ë¯¸ì§€ ë°ì´í„°    

```loss(self, x, t)```: ì†ì‹¤ í•¨ìˆ˜ì˜ ê°’ì„ êµ¬í•¨    
* ```x```: ì´ë¯¸ì§€ ë°ì´í„°    
* ```t```: ì •ë‹µ ë ˆì´ë¸”

```accuracy(self, x, t)```: ì •í™•ë„ë¥¼ êµ¬í•¨

```numerical_gradient(self, x, t)```: ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜ì˜ ê¸°ìš¸ê¸°ë¥¼ **ìˆ˜ì¹˜ë¯¸ë¶„ë°©ì‹**ìœ¼ë¡œ êµ¬í•¨      
```gradient(self, x, t)```: ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜ì˜ ê¸°ìš¸ê¸°ë¥¼ **ì˜¤ì°¨ì—­ì „íŒŒë²•**ìœ¼ë¡œ êµ¬í•¨    

[ìš”ì•½]      
* ```(predict ( ) )```: ê³„ì¸µì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ **ì¸ì‹ ê²°ê³¼ë¥¼ ì–»ëŠ”** ì²˜ë¦¬ì™€      
* ```(gradient ( ) )```: **ê¸°ìš¸ê¸°ë¥¼ êµ¬í•˜ëŠ” ì²˜ë¦¬**      

ì´ **ë‘ ê³„ì¸µì˜ ì „íŒŒë§Œ** ìœ¼ë¡œ ë™ì‘ì´ ì´ë£¨ì–´ì§€ëŠ” ê²ƒ    

  
</div>
</details>  

<details>
<summary>ğŸ‘€ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">
  
```python
import sys, os 
sys.path.append(os.pardir) 
import numpy as np

from common.layers import * 
from common.gradient import numerical _gradient 
# ì…ë ¥ëœ ì•„ì´í…œë“¤(items)ì˜ ìˆœì„œë¥¼ ê¸°ì–µí•˜ëŠ” Dictionary í´ë˜ìŠ¤ 
from collections import OrderedDict

class TwoLayerNet:
	def __init __(self, input_size, hidden_size, output_size, weight_init_std = 0.01):

		# ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”
		self.params = {} 
		self.params['W1'] = weight_init_std * np.random.randn(input_size, hidden_size) self.params['b1'] = np.zeros(hidden_size) 
		self.params['W2'] = weight _init _std * np.random.randn(hidden_size,output_size) 
		self.params['b2'] = np.zeros(output _size)

		# ê³„ì¸µ ìƒì„±
		self.layers = OrderedDict() 
		self.layers['Affine1'] = Affine(self.params['W1'], self.params['b1']) self.layers['Relu1'] = Relu() 
	self.layers['Affine2'] = Affine(self.params['W2'], self.params['b2'])

		self.lastLayer = SoftmaxWithLoss()
		
	def predict(self, x):
		for layer in self.layers.values():
			x = layer.forward(x)

		return x

	# x : ì…ë ¥ ë°ì´í„° , t : ì •ë‹µ ë ˆì´ë¸”
	def loss(self, x, t):
		y = self.predict(x) 

		return self.lastLayer.forward(y, t)

	def accuracy(self, x, t):
		y = self.predict(x)
		y = np.argmax(y, axis = 1)
		if t.ndim ! = 1 : t = np.argmax(t, axis = 1)

		accuracy = np.sum(y == t) / float(x.shape[0])

		return accuracy

	# x : ì…ë ¥ ë°ì´í„° , t : ì •ë‹µ ë ˆì´ë¸”
	def numerical_gradient(self, x, t):
		loss_W = lambda W: self.loss(x, t)
		grads = {} 
		grads['W1'] = numerical_gradient(loss_W, self.params['W1']) 
		grads['b1'] = numerical_gradient(loss_W, self.params['b1']) 
		grads['W2'] = numerical_gradient(loss_W, self.params['W2']) 
		grads['b2'] = numerical _gradient(loss_W, self.params['b2']) 
		
		return grads

	def gradient(self, x, t):
		# ìˆœì „íŒŒ
		self.loss(x, t)

		# ì—­ì „íŒŒ
		dout = 1
		dout = self.lastLayer.backward(dout)

		layers = list(self.layers.values()) 
		layers.reverse() 
		for layer in layers:
			dout = layer.backward(dout)

		# ê²°ê³¼ ì €ì¥
		grads = {}
		grads['W1'] = self.layers['Affine1'].dW 
		grads['b1'] = self.layers['Affine1'].db 
		grads['W2'] = self.layers['Affine2'].dW 
		grads['b2'] = self.layers['Affine2'].db

		return grads
```
  
</div>
</details>
	
<details>
<summary>ğŸ“œ ì½”ë“œ ì„¤ëª… ë³´ê¸°</summary>
<div markdown="1">
	
OrderedDictì— ë³´ê´€í•˜ëŠ” ì ì´ ì¤‘ìš”    
* OrderedDict: ìˆœì„œê°€ ìˆëŠ” ë”•ì…”ë„ˆë¦¬

**ìˆœì „íŒŒ**: **ì¶”ê°€í•œ ìˆœì„œëŒ€ë¡œ** ê° ê³„ì¸µì˜ forward ( ) ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ì²˜ë¦¬ ì™„ë£Œ.(OrderedDict ë•ë¶„)     
**ì—­ì „íŒŒ**: ê³„ì¸µì„ **ë°˜ëŒ€ ìˆœì„œë¡œ í˜¸ì¶œ**í•˜ê¸°ë§Œ í•˜ë©´ ë¨       

 
Affine ê³„ì¸µê³¼ ReLU ê³„ì¸µì´ ê°ìì˜ ë‚´ë¶€ì—ì„œ ìˆœì „íŒŒì™€ ì—­ì „íŒŒë¥¼ ì œëŒ€ë¡œ ì²˜ë¦¬í•˜ê³  ìˆìœ¼ë‹ˆ,     
* ì—¬ê¸°ì—ì„œëŠ” ê·¸ëƒ¥ ê³„ì¸µì„ **ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ì—°ê²°**í•œ ë‹¤ìŒ **ìˆœì„œëŒ€ë¡œ (í˜¹ì€ ì—­ìˆœìœ¼ë¡œ) í˜¸ì¶œ**í•´ì£¼ë©´ ë    
  
</div>
</details>  
	
---
	
### ì˜¤ì°¨ì—­ì „íŒŒë²•ìœ¼ë¡œ êµ¬í•œ ê¸°ìš¸ê¸° ê²€ì¦
**ìˆ˜ì¹˜ ë¯¸ë¶„**ì€ **ì˜¤ì°¨ì—­ì „íŒŒë²•**ì„ **ì •í™•íˆ êµ¬í˜„**í–ˆëŠ”ì§€ **í™•ì¸**í•˜ê¸° ìœ„í•´ í•„ìš”

**[gradient check]**      
ë‘ ë°©ì‹ìœ¼ë¡œ êµ¬í•œ ê¸°ìš¸ê¸°ê°€ ì¼ì¹˜í•¨(ì—„ë°€íˆ ë§í•˜ë©´ ê±°ì˜ ê°™ìŒ)ì„ í™•ì¸í•˜ëŠ” ì‘ì—…ì„ ê¸°ìš¸ê¸° í™•ì¸         

**[í¬ê¸° ë¹„êµ ìœ ì˜ì ]**   
ìˆ˜ì¹˜ ë¯¸ë¶„ê³¼ ì˜¤ì°¨ì—­ì „íŒŒë²•ì˜ ê²°ê³¼ ì˜¤ì°¨ê°€ 0ì´ ë˜ëŠ” ì¼ì€ ë“œë­„ (ì´ëŠ” ì»´í“¨í„°ê°€ í•  ìˆ˜ ìˆëŠ” ê³„ì‚°ì˜ ì •ë°€ë„ê°€ ìœ í•œí•˜ê¸° ë•Œë¬¸)     
ì´ ì •ë°€ë„ì˜ í•œê³„ ë•Œë¬¸ì— ì˜¤ì°¨ëŠ” ëŒ€ë¶€ë¶„ 0ì´ ë˜ì§€ëŠ” ì•Šì§€ë§Œ, ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„í–ˆë‹¤ë©´ 0ì— ì•„ì£¼ ê°€ê¹Œìš´ ì‘ì€ ê°’ì´ ë¨    
ë§Œì•½ ê·¸ ê°’ì´ í¬ë©´ ì˜¤ì°¨ì—­ì „íŒŒë²•ì„ ì˜ëª» êµ¬í˜„í–ˆë‹¤ê³  ì˜ì‹¬ í•„ìš”      

	
---

# ì •ë¦¬
ì´ë²ˆ ì¥ì—ì„œ ë°°ìš´ ë‚´ìš©    
â— ê³„ì‚° ê·¸ë˜í”„ë¥¼ ì´ìš©í•˜ë©´ ê³„ì‚° ê³¼ì •ì„ ì‹œê°ì ìœ¼ë¡œ íŒŒì•… ê°€ëŠ¥.     
â— ê³„ì‚° ê·¸ë˜í”„ì˜ ë…¸ë“œëŠ” êµ­ì†Œì  ê³„ì‚°ìœ¼ë¡œ êµ¬ì„±. êµ­ì†Œì  ê³„ì‚°ì„ ì¡°í•©í•´ ì „ì²´ ê³„ì‚°ì„ êµ¬ì„±.     
â— ê³„ì‚° ê·¸ë˜í”„ì˜ ìˆœì „íŒŒëŠ” í†µìƒì˜ ê³„ì‚°ì„ ìˆ˜í–‰. í•œí¸, ê³„ì‚° ê·¸ë˜í”„ì˜ ì—­ì „íŒŒë¡œëŠ” ê° ë…¸ë“œì˜ ë¯¸ë¶„ì„ êµ¬í• ìˆ˜ ìˆë‹¤.     
â— ì‹ ê²½ë§ì˜ êµ¬ì„± ìš”ì†Œë¥¼ ê³„ì¸µìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ ê¸°ìš¸ê¸°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤(ì˜¤ì°¨ì—­ì „íŒŒë²•).    
â— ìˆ˜ì¹˜ ë¯¸ë¶„ê³¼ ì˜¤ì°¨ì—­ì „íŒŒë²•ì˜ ê²°ê³¼ë¥¼ ë¹„êµí•˜ë©´ ì˜¤ì°¨ì—­ì „íŒŒë²•ì˜ êµ¬í˜„ì— ì˜ëª»ì´ ì—†ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤(ê¸°ìš¸ê¸° í™•ì¸).    
	
	
ì‚¬ì§„ ì¶œì²˜: ë°‘ë°”ë‹¥ë¶€í„° ì‹œì‘í•˜ëŠ” ë”¥ëŸ¬ë‹ 1

---
title: "[09] Deep learning 1: ë¯¸êµ­ ìˆ˜í™” ë°ì´í„°ì„¸íŠ¸ ì´ë¯¸ì§€ ë¶„ë¥˜ TEST"
date:   2020-03-4
excerpt: ""
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---

# ë¯¸êµ­ ìˆ˜í™” ë°ì´í„°ì„¸íŠ¸ ì´ë¯¸ì§€ ë¶„ë¥˜

## ì‹œì‘í•˜ê¸° ì „ ë°°ìš¸ ê°œë…
* [MNIST ì—°ìŠµí•˜ëŸ¬ ê°€ê¸°]( https://yerimoh.github.io/DL6/)      
â¡ ì•„ë˜ì˜ ë¬¸ì œì™€ ê±°ì˜ ìœ ì‚¬í•˜ë‹ˆ ìœ„ì˜ ê°œë…ì„ ì™„ì „íˆ ìˆ™ì§€í•˜ê³  ì˜¤ì    


## ëª©í‘œ
* íŠ¸ë ˆì´ë‹ì„ ìœ„í•œ ì´ë¯¸ì§€ ë°ì´í„° ì¤€ë¹„     
* ì´ë¯¸ì§€ ë¶„ë¥˜ë¥¼ ìœ„í•œ ë‹¨ìˆœ ëª¨ë¸ ìƒì„± ë° ì»´íŒŒì¼     
* ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ íŠ¸ë ˆì´ë‹ ë° ê²°ê³¼ ê´€ì°°      

## ë¯¸êµ­ ìˆ˜í™” ë°ì´í„°ì…‹ ì„¤ëª…
* 26ê°œì˜ ë¬¸ìê°€ í¬í•¨        
* ì´ ì¤‘ ë‘ ê°œì˜ ë¬¸ì(j ë° z)ì—ëŠ” ë™ì‘ì´ ìš”êµ¬ë˜ë¯€ë¡œ ì œì™¸      

![image](https://user-images.githubusercontent.com/76824611/128883527-6e6b2705-f0b4-45fb-9e3d-25b6727055ff.png)


----



# ë°ì´í„° ë¡œë“œ   
MNISTì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ Kerasë¥¼ í†µí•´ ì œê³µë˜ì§€ ì•ŠìŒ     
â¡ x_train, y_train, x_valid , y_valid ë¥¼ ë¶€ë¥´ê¸° ìœ„í•œ ë‹¤ë¥¸ ë°©ë²• í•„ìš”       

## ë°ì´í„° ì½ê¸°
ìˆ˜í™” ë°ì´í„°ì„¸íŠ¸ëŠ” csv í˜•ì‹ìœ¼ë¡œ ë˜ì–´ìˆìŒ.      
* ìƒë‹¨ì— ë ˆì´ë¸”ì´ ìˆëŠ” í–‰ê³¼ ì—´ë¡œ ì´ë£¨ì–´ì§„ ê·¸ë¦¬ë“œ       
* ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì—¬ ì‘ì—…í•˜ê¸° ìœ„í•´ ë°ì´í„° ë¡œë“œ ë° ì¡°ì‘ì„ ìœ„í•œ ê³ ì„±ëŠ¥ íˆ´ì¸ [Pandas](https://yerimoh.github.io/PD/)ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©           
* CSV íŒŒì¼ì€ [DataFrame]( https://yerimoh.github.io/PD2/#%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%94%84%EB%A0%88%EC%9E%84-%EB%8B%A4%EB%A3%A8%EA%B8%B0)ì´ë¼ëŠ” í˜•ì‹ìœ¼ë¡œ ì½ìŒ        
 
```python
import pandas as pd
```


Pandasì—ëŠ” csv íŒŒì¼ì„ ì˜ˆìƒí•˜ê³  DataFrameì„ ë°˜í™˜í•˜ëŠ” read_csv ë©”ì„œë“œê°€ ì¡´ì¬      
* ì´ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ ì˜¬ ê²ƒì„   

```python
train_df = pd.read_csv("data/asl_data/sign_mnist_train.csv")
valid_df = pd.read_csv("data/asl_data/sign_mnist_valid.csv")
```

### ë°ì´í„° ì‚´í´ë³´ê¸°
* head ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ DataFrameì˜ ì²˜ìŒ í–‰ ëª‡ ê°œë¥¼ ì¶œë ¥   
* 784ê°œì˜ ê°’ì„ ì§€ë‹Œ ì´ë¯¸ì§€      

```python
train_df.head()
```
![image](https://user-images.githubusercontent.com/76824611/128883791-44d36ec4-47da-439c-91f5-0a482b1328a2.png)


### ë ˆì´ë¸” ì¶”ì¶œ
íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ë ˆì´ë¸”ì„ y_train ë° y_valid ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ” ë²•    
1ï¸âƒ£ í•´ë‹¹ ë³€ìˆ˜ë¥¼ ìƒì„±         
2ï¸âƒ£ ë‹¤ìŒ ë ˆì´ë¸”ì´ ë” ì´ìƒ í•„ìš”ì—†ëŠ” ë°ì´í„°í”„ë ˆì„ ì›ë³¸ì—ì„œ ë ˆì´ë¸”ì„ ì‚­ì œ      

```python
# label ì´ë¼ëŠ” ì—´ì´ ì •ë‹µì—´ì„
y_train = train_df['label'] 
y_valid = valid_df['label']
del train_df['label']
del valid_df['label']
```
### ì´ë¯¸ì§€ ì¶”ì¶œ
íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ì´ë¯¸ì§€ë¥¼ x_train ë° x_valid ë³€ìˆ˜ì— ì €ì¥      
```python
x_train = train_df.values
x_valid = valid_df.values
```
### íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ë°ì´í„° ìš”ì•½
**[íŠ¸ë ˆì´ë‹]**       
* x_train.shape: íŠ¸ë ˆì´ë‹ì„ ìœ„í•œ ê°ê° 784ê°œ í”½ì…€ì„ í¬í•¨í•˜ëŠ” 27,455ê°œì˜ ì´ë¯¸ì§€ ì¡´ì¬     
* y_train.shape: íŠ¸ë ˆì´ë‹ì„ ìœ„í•œ ìœ„ ì´ë¯¸ì§€ì˜ ë ˆì´ë¸”(ì •ë‹µ)   
   
```python 
x_train.shape
# (27455, 784)
# (ì´ë¯¸ì§€ ê°œìˆ˜, ê° í”½ì…€ ê°œìˆ˜)
y_train.shape
# (27455,)

# (ìœ„ ì´ë¯¸ì§€ì˜ ì •ë‹µ ê°œìˆ˜,)
```


**[ê²€ì¦]**      
* x_valid.shape :ê²€ì¦ì„ ìœ„í•œ 7,172ê°œì˜ ì´ë¯¸ì§€, 784ê°œì˜ í”½ì…€ ì¡´ì¬     
* y_valid.shape: ê²€ì¦ì„ ìœ„í•œ ì´ë¯¸ì§€ì˜ ì •ë‹µ  
  
```python
x_valid.shape
# (7172, 784)
# (ì´ë¯¸ì§€ ê°œìˆ˜, í”½ì…€ê°œìˆ˜)
y_valid.shape
# (7172,)
# ì´ë¯¸ì§€ ì •ë‹µê°œìˆ˜
```


## ë°ì´í„° ì‹œê°í™”
* [matplotlib]( https://yerimoh.github.io//PD3/#matplotlib-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A1%9C-%EA%B7%B8%EB%9E%98%ED%94%84-%EA%B7%B8%EB%A6%AC%EA%B8%B0) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©      
* ì´ë¯¸ì§€ë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ 784ê°œ í”½ì…€ë¡œ ì´ë£¨ì–´ì§„ **1D ëª¨ì–‘ â¡  28x28í”½ì…€ë¡œ ì´ë£¨ì–´ì§„ 2D ëª¨ì–‘**     
```python
import matplotlib.pyplot as plt
plt.figure(figsize=(40,40))

num_images = 20
for i in range(num_images):
    row = x_train[i]
    label = y_train[i]
    
    image = row.reshape(28,28)
    plt.subplot(1, num_images, i+1)
    plt.title(label, fontdict={'fontsize': 30})
    plt.axis('off')
    plt.imshow(image, cmap='gray')
```


--

# TEST
##  ì´ë¯¸ì§€ë°ì´í„° ì •ê·œí™”  
ë°ì´í„°ì˜ í”½ì…€ ê°’ì´ í˜„ì¬ì²˜ëŸ¼ 0~255ê°€ ì•„ë‹Œ 0~1ì˜ ë¶€ë™ ì†Œìˆ˜ì  ê°’ì´ ë˜ì–´ì•¼í•¨        
* [ì´ìœ  ì•Œì•„ë³´ëŸ¬ê°€ê¸°]( https://yerimoh.github.io/DL6/#2-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EA%B7%9C%ED%99%94)

ë³´ê¸°ì „ì— ì½”ë“œ ì§ì ‘ ì³ë³´ê³  ì •ë§ ì •ë‹µ í™•ì¸ìš©ìœ¼ë¡œ ë´ë¼   
<details>
<summary>ğŸ”½ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
x_train = x_train / 255
x_valid = x_valid / 255
```

</div>
</details>


## ë ˆì´ë¸” ë¶„ë¥˜
* [ë ˆì´ë¸”ì„ ë²”ì£¼ ì¸ì½”ë”©]( https://yerimoh.github.io/DL6/#31-%EB%B2%94%EC%A3%BC-%EC%9D%B8%EC%BD%94%EB%94%A9)

* ```keras.utils.to_categorical``` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ê¸°ì— ì¸ì½”ë”©í•  ê°’ê³¼ ê°’ì„ ì¸ì½”ë”©í•  ë²”ì£¼ ìˆ˜ë¥¼ ì „ë‹¬í•´ ë²”ì£¼ ì¸ì½”ë”©     
* ```kerasë¥¼ ê°€ì ¸ì™€ ë²”ì£¼ ìˆ˜(24)ë¥¼ ì„¤ì •í•´ë‘ ```       

```python
import tensorflow.keras as keras
num_classes = 24
```

ì´ ë‹¤ìŒ ì½”ë“œë¥¼ ì§œë´ë¼     
* Categorically encode y_train and y_valid     

<details>
<summary>ğŸ”½ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# TODO: Categorically encode y_train and y_valid.
y_train = keras.utils.to_categorical(y_train, num_classes)
y_valid = keras.utils.to_categorical(y_valid, num_classes)
```
    
</div>
</details>




## ëª¨ë¸ ë¶„ë¥˜
ë°ì´í„°ê°€ ëª¨ë‘ ì¤€ë¹„ë˜ì—ˆìŒ ì´ì œ ìˆœì°¨ëª¨ë¸ êµ¬ì¶•í•  ì°¨ë¡€

ë‹¤ìŒê³¼ ê°™ì€ ëª¨ë¸ì„ êµ¬ì¶•í•´ë´ë¼    

1ï¸âƒ£ ì…ë ¥ ë ˆì´ì–´: dense, 512ê°œì˜ ë‰´ëŸ° í¬í•¨, í™œì„±í™” í•¨ìˆ˜ relu ì‚¬ìš©, ì…ë ¥ì´ë¯¸ì§€ ëª¨ì–‘(784,)        
2ï¸âƒ£ 512ê°œì˜ ë‰´ëŸ° í¬í•¨, í™œì„±í™” í•¨ìˆ˜ reluì‚¬ìš©, ë°€ì§‘ ë ˆì´ì–´ ì§€ë‹˜       
3ï¸âƒ£ ë‰´ëŸ° ìˆ˜ = í´ë˜ìŠ¤, í™œì„±í™” í•¨ìˆ˜ softmax, ë°€ì§‘ ì¶œë ¥ ë ˆì´ì–´ ì§€ë‹˜     
â• ëª¨ë¸ì„ ì €ì¥í•  model ë³€ìˆ˜ë¥¼ ìƒì„±      


* Keras ìˆœì°¨ ëª¨ë¸ í´ë˜ìŠ¤ì™€ Dense ë ˆì´ì–´ í´ë˜ìŠ¤ë¥¼ ê°€ì ¸ì˜´

```python
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
```
<details>
<summary> ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
models =  Sequential # ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

```

</div>
</details>




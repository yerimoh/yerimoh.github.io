---
title: "[07] Deep learning 1: ê²½ì‚¬ í•˜ê°•ë²• gradient descent method"
date:   2020-03-6
excerpt: "ê²½ì‚¬ í•˜ê°•ë²• gradient descent methodì˜ ê°œë…, ì“°ì„ì„ ì˜ˆë¥¼ í†µí•´ì„œ ì‰½ê²Œ ì´í•´í•˜ê¸°/ MSE(Mean Squared Error)/ ì†ì‹¤í•¨ìˆ˜ ì‰½ê²Œ "
category: [Deep Learning]
layout: post
tag:
- Deep Learning
order: 0

comments: true
---

# ê²½ì‚¬í•˜ê°•ë²• ëª©ì°¨
- [ê²½ì‚¬ í•˜ê°•ë²• gradient descent method](#ê²½ì‚¬-í•˜ê°•ë²•-gradient-descent-method)
  * [ì‹œì‘í•˜ê¸° ì „ ì½ì–´ë³´ë©´ ì¢‹ì„ ê°œë…(í•„ìˆ˜ ê°œë…)](#ì‹œì‘í•˜ê¸°-ì „-ì½ì–´ë³´ë©´-ì¢‹ì„-ê°œë…-í•„ìˆ˜-ê°œë…-)
- [ëª©í‘œ](#ëª©í‘œ)
- [bulid-up 1](#bulid-up-1)
  * [MSE(Mean Squared Error)](#mse-mean-squared-error-)
    + [MSEì˜ ìˆ˜ì‹](#mseì˜-ìˆ˜ì‹)
    + [MSE êµ¬í˜„](#mse-êµ¬í˜„)
- [bulid-up 2](#bulid-up-2)
  * [ì†ì‹¤ ê³¡ì„ (The Loss Curve)](#ì†ì‹¤-ê³¡ì„ -the-loss-curve-)
- [ê²½ì‚¬ í•˜ê°•ë²• gradient descent method](#ê²½ì‚¬ í•˜ê°•ë²•-gradient-descent-method-1)
  * [ì˜ˆì‹œ](#ì˜ˆì‹œ)
    + [1) MSEì— ëŒ€ì…](#1--mseì—-ëŒ€ì…)
    + [2) MSEë¥¼ í™•ì¥](#2--mseë¥¼-í™•ì¥)
    + [3) ì´ë™ë°©í–¥ ì„¤ì •](#3--ì´ë™ë°©í–¥-ì„¤ì •)
    + [4) í•™ìŠµë¥ (Î»)ë„ì…](#4--í•™ìŠµë¥ ---ë„ì…)
    + [5) í•™ìŠµ](#5--í•™ìŠµ)

---

# ê²½ì‚¬ í•˜ê°•ë²• gradient descent method   

## ì‹œì‘í•˜ê¸° ì „ ì½ì–´ë³´ë©´ ì¢‹ì„ ê°œë…(í•„ìˆ˜ ê°œë…)
* [ê²½ì‚¬í•˜ê°•ë²•ì´ ë”¥ëŸ¬ë‹ì˜ ì „ì²´ì ì¸ ê³¼ì •ì—ì„œ ì–´ë””ì— ì™œ ì“°ì´ë‚˜ìš”?](https://yerimoh.github.io/DL3/)       
* [ì†ì‹¤ ê³¡ì„ ](https://yerimoh.github.io/DL3/#%EC%86%90%EC%8B%A4-%ED%95%A8%EC%88%98loss-function)     

---

# ëª©í‘œ
[ì†ì‹¤ í•¨ìˆ˜](https://yerimoh.github.io/DL3/#%EC%86%90%EC%8B%A4-%ED%95%A8%EC%88%98loss-function)ì—ì„œ ê²½ì‚¬í•˜ê°•ë²•ì„ ì´ìš©í•˜ì—¬,    
í˜„ì¬ìœ„ì¹˜ â¡ íƒ€ê¹ƒìœ„ì¹˜ ë¡œ ì´ë™
![image](https://user-images.githubusercontent.com/76824611/128706696-c8306e64-9a7a-4b29-801d-b489e17cb5b9.png)



---
# bulid-up 1

## MSE(Mean Squared Error)
ë¨¼ì € ê²½ì‚¬í•˜ê°•ë²•ì— ì“°ì¼ ì†ì‹¤í•¨ìˆ˜ë¶€í„° ì•Œì•„ë³´ì!   

ì•ì˜ ë§í¬ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” **ì˜¤ì°¨ ì œê³± í•©(sum of squares for error, SSE)**, **êµì°¨ ì—”íŠ¸ë¡œí”¼ ì˜¤ì°¨(cross entropy error, CEE)** ì™€ ê°™ì€ ì†ì‹¤ í•¨ìˆ˜     
ì¦‰ ì†ì‹¤í•¨ìˆ˜ì˜ ë˜ ë‹¤ë¥¸ ì¢…ë¥˜     

ì´ ì†ì‹¤í•¨ìˆ˜ê°€ ì™œ ì“°ì´ëŠ”ì§€ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•´ ë³´ê² ë‹¤.     

ì´ë¥¼ ìœ„í•´ ë§¤ìš° ë‹¨ìˆœí•œ ëª¨ë¸ì„ ê°€ì ¸ì™€ë³´ì.     

![image](https://user-images.githubusercontent.com/76824611/128722387-33a7260b-da3b-4da4-865f-5bbb55da8735.png)

* ê° ì› ğŸŸ¢: ë‰´ëŸ°      
* ëª©í‘œ: ë‘ ë‰´ëŸ°ì„ ì‡ëŠ” **íšŒê·€ì„ (y = mx + b)** ë§Œë“¤ê¸°      


**[ë‰´ëŸ°(y)ë¡œ ë“¤ì–´ì˜¤ëŠ” ê° ë³€ìˆ˜]**      
**íšŒê·€ì„ (y = mx + b)**       
* **m**: ê¸°ìš¸ê¸°, ê°€ì¤‘ì¹˜       
* **b**: yì˜ ì ˆí¸ìœ¼ë¡œ ë‰´ëŸ°ê³¼ í•¨ê»˜ ì €ì¥ë¨      

 
**[mê³¼ bë¥¼ êµ¬í•  ìˆ˜ ìˆëŠ” ì¢€ ë” í™•ì •ì ì¸ ë°©ë²•]**       
 * ì‹œì‘ì€ ë¬´ì‘ìœ„ ê°’         
 * ì²˜ìŒì˜ y_hatì€ xì— ëŒ€í•œ ì •ë‹µì¸ yë¥¼ ë¬´ì‘ìœ„ë¡œ ì¶”ì¸¡í•œë‹¤   
 * ê¸°ì¡´ì˜ íšŒê·€ì„ : âœ¨ìµœì†Œì œê³±ì˜¤ì°¨âœ¨(ì°¸ê°’ê³¼ ê° ê·¼ì‚¬ì¹˜ì˜ ì°¨ë¥¼ ì œê³±)ì— ê¸°ë°˜     

ë§ë‹¤.. ì´ âœ¨ìµœì†Œì œê³±ì˜¤ì°¨âœ¨ì˜ ë°©ë²•ì´ **MSE(Mean Squared Error)** ì´ë‹¤.    

### MSEì˜ ìˆ˜ì‹
![image](https://user-images.githubusercontent.com/76824611/128714016-18cac55d-f080-4763-906f-63167de24611.png)
* ì´ ë°©ë²•ì€ **ì˜¤ì°¨ë¥¼ ì–‘ìˆ˜ë¡œ ìœ ì§€**    
* ì´ ì˜¤ì°¨ë¥¼ íŒŒì•…í•  ë•Œ ì„œë¡œë¥¼ **ìƒì‡„ ì•ˆ í•¨**    
* ì˜ëª»ëœ ì¶”ì¸¡ì„ **ì œê³±**ì„ í†µí•´ **ê°•í•˜ê²Œ ì²˜ë²Œ**     
![image](https://user-images.githubusercontent.com/76824611/128714148-b81d8b94-facf-44f5-805c-e90eeab2975e.png)

â¡ ë‘ ì˜¤ì°¨ê°’ì´ -,+ ì—¬ë„ ì œê³±ì„ í•˜ì—¬ ì„œë¡œ ìƒì‡„ ì•ˆí•¨   
â¡ ì´ë¥¼ ìœ„ì˜ ë‘ ì‹ì„ ì´ìš©í•˜ì—¬ y_hatì„ yì— ê°€ê¹ê²Œ ë§Œë“¤ì–´ mê³¼ bë¥¼ ì œëŒ€ë¡œ ì¶”ì¸¡í•œë‹¤     

### MSE êµ¬í˜„

```python
data = [(1, 3), (2, 5)]
m = -1
b = 5
def get_mse(data, m, b):
    """í‰ê· ì œê³±ì˜¤ì°¨ ê³„ì‚°"""
    n = len(data)
    squared_error = 0
    for x, y in data:
        # ì˜ˆì¸¡ëœ y ì°¾ê¸°
    	y_hat = m*x+b
    	# ì˜ˆì¸¡ê³¼ ì°¸ê°’ ì‚¬ì´ì˜ 
    	# ì°¨ì´ë¥¼ ì œê³±
    	squared_error += (
    	    y - y_hat)**2
    # í‰ê·  ì œê³± ì°¨ì´ êµ¬í•˜ê¸°
    mse = squared_error / n
    return mse
```

---
# bulid-up 2

## ì†ì‹¤ ê³¡ì„ (The Loss Curve)
ê·¸ëŸ¼ ì´ ê²½ì‚¬í•˜ê°•ë²•ì´ ì‘ë™í•  ë°°ê²½ì¸ ì†ì‹¤ ê³¡ì„ (The Loss Curve)ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•´ë³´ê² ë‹¤ 
.

í‰ê· ì œê³±ì˜¤ì°¨ì— ê´€í•œ mê³¼ bë¥¼ ê·¸ë˜í”„ë¡œ ê·¸ë¦¬ë©´,

**[ì†ì‹¤í•¨ìˆ˜ì˜ í‘œë©´ë„]**    
ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•´ ìš°ë¦¬ê°€ ì„ íƒí•œ ì˜¤ì°¨ í•¨ìˆ˜ ì¦‰, MSEì˜ í‘œë©´ë„ëŠ”
![image](https://user-images.githubusercontent.com/76824611/128714866-7876302b-e0e0-41de-8ec7-b84c2188c764.png)

**[ì†ì‹¤í•¨ìˆ˜ì˜ ë“±ê³ ì„ ë„]**    
ì´ë¥¼ ë” ì§ê´€ì ìœ¼ë¡œ ë³´ê¸°ìœ„í•´ ë“±ê³ ì„ ë„ë¡œ ê·¸ë ¤ë³´ê² ë‹¤.    
![image](https://user-images.githubusercontent.com/76824611/128714942-07851f3a-df3e-49a2-8d92-31a0c9b9fa41.png)
â¡ ì´ë¥¼ í†µí•´ ìµœì†Œê°’ì„ ê°–ëŠ” ì˜ì—­ì´ b=1ê³¼ m=2ì¸ í¬ë¬¼ì„  íƒ€ì›ê³¼ ê°™ë‹¤ëŠ” ì‚¬ì‹¤ì„ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤    
â¡ ê°€ì¥ ì§„í•œ ê³³ì´ ê°€ì¥ ì†ì‹¤ì´ ì ì€ê³³, íƒ€ê¹ƒì´ê¸° ë•Œë¬¸ì´ë‹¤     

**[PROBLELM & ê²½ì‚¬í•˜ê°•ë²•]**    
* ì»´í“¨í„°ì—ëŠ” ì´ ê·¸ë˜í”„ì˜ ë°”ë‹¥ì— ë„ë‹¬í•˜ê¸° ìœ„í•´ ë­˜ ë³€ê²½í•´ì•¼ í• ì§€ë¥¼ ì¶”ì¸¡í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì´ ì—†ìŒ       
![image](https://user-images.githubusercontent.com/76824611/128715294-34a15621-0577-493f-9235-b4a8dc4139c0.png)
â¡ì£¼ì–´ì§„ í˜„ì¬ ì ì—ì„œ ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ê³„ì‚°í•  ê²ƒ    

----

# ê²½ì‚¬ í•˜ê°•ë²• gradient descent method
**ê·¸ë˜ë””ì–¸íŠ¸(gradient)**: ì–´ë–¤ ë°©í–¥ìœ¼ë¡œ ì†ì‹¤ì´ ê°€ì¥ ë§ì´ ê°ì†Œí•˜ëŠ”ê°€      
* mì— ëŒ€í•œ bì˜ ì–´ë–¤ ë¹„ìœ¨      
* íƒ€ê¹ƒì—ì„œ ë©€ì–´ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ í•œë²ˆì— ë§ì´ì”© ê°€ë©´ ì•ˆë¨(step ì´ ë„ˆë¬´ í¬ë©´ ì•ˆë¨)      

- **ë‹¨ê³„(step)**: ê°€ì¤‘ì¹˜ ë§¤ê°œë³€ìˆ˜ì— ëŒ€í•œ ì—…ë°ì´íŠ¸    
- **Î»(í•™ìŠµë¥ )(learning rate)**: ì´ë™ê±°ë¦¬   
   * ë°©í–¥(ê·¸ë˜ë””ì–¸íŠ¸)ì´ í™•ë³´ë˜ë©´ ì–¼ë§ˆë‚˜ ë©€ë¦¬ ì´ë™í• ì§€ë¥¼ íŒŒì•…     



- **ì—í¬í¬(epoch)**: **ì „ì²´ ë°ì´í„° ì„¸íŠ¸**ë¡œ ëª¨ë¸ ì—…ë°ì´íŠ¸     
  * ìƒˆ ìœ„ì¹˜ì— ë„ë‹¬í•œ í›„ ìœ„ì˜ ê³¼ì • ë°˜ë³µ    
- **ë°°ì¹˜(batch)**: ì „ì²´ ë°ì´í„° ì„¸íŠ¸ ì¤‘ íŠ¹ì • ìƒ˜í”Œ    
â¡ ì „ì²´ ë°ì´í„°ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ë“  ë°°ì¹˜ë¥¼ ì‚¬ìš©í•˜ë“  ì–´ë–¤ ê²½ìš°ë“ , ìœ„ì˜ ë‹¨ê³„ì—ì„œ ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ê³„ì‚°í•œ ë‹¤ìŒ í•´ë‹¹ ê·¸ë˜ë””ì–¸íŠ¸ì™€ í•™ìŠµë¥ ë¡œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.


## ì˜ˆì‹œ
**[ì—ëŸ¬ë¥¼ í†µí•œ í•™ìŠµ]**   
![image](https://user-images.githubusercontent.com/76824611/128715294-34a15621-0577-493f-9235-b4a8dc4139c0.png)
ìœ„ì™€ ê°™ì€ ìƒí™©ì—ì„œ MSEë¥¼ ì´ìš©í•˜ì—¬ íƒ€ê²Ÿìœ¼ë¡œ ê°€ë³´ì     

### 1) MSEì— ëŒ€ì…
ë¨¼ì € MSEì— ìœ„ì˜ ìƒíƒœë¥¼ ëŒ€ì…í•´ë³´ë©´
![image](https://user-images.githubusercontent.com/76824611/128713894-93663e11-6052-4e87-977d-2e14e0cdb686.png)

### 2) MSEë¥¼ í™•ì¥
ìœ„ì˜ í˜„ì¬ ì ì„ ì§€ë‚˜ëŠ” ìˆ˜ë§ì€ ì§ì„  ì¤‘ x,y ë°ì´í„°í¬ì¸íŠ¸ì¸ (1,3)ê³¼ (2,5)ë¥¼ í¬í•¨í•˜ë„ë¡ MSEë¥¼ í™•ì¥í•´ë³´ì  
![image](https://user-images.githubusercontent.com/76824611/128715960-61b9985d-cd76-4e53-802a-5536728cba65.png)

$$ğœ•ğ‘€ğ‘†ğ¸/ğœ•ğ‘š=9ğ‘š+5ğ‘âˆ’23$$
$$ğœ•ğ‘€ğ‘†ğ¸/ğœ•ğ‘š=âˆ’7$$

$$ğœ•ğ‘€ğ‘†ğ¸/ğœ•ğ‘=5ğ‘š+3ğ‘âˆ’13$$
$$ğœ•ğ‘€ğ‘†ğ¸/ğœ•ğ‘=âˆ’3$$    


### 3) ì´ë™ë°©í–¥ ì„¤ì •
$$ğœ•ğ‘€ğ‘†ğ¸/ğœ•ğ‘š=âˆ’7$$, $$ğœ•ğ‘€ğ‘†ğ¸/ğœ•ğ‘=âˆ’3$$  ë‘˜ë‹¤ ìŒìˆ˜ì´ë‹¤ -> ì‹¤ì œ ê°’ì´ ë” ì‘ìœ¼ë‹ˆ í‚¤ì›Œì•¼ í•œë‹¤.      
â¡ 0ì— ê·¼ì ‘í•´ì§€ê²Œ í•˜ê¸° ìœ„í•´ ë‘˜ì„ ëŠ˜ë ¤ì•¼ í•¨
![image](https://user-images.githubusercontent.com/76824611/128718260-0fc50fe8-7832-4f16-b1c5-3394fd7e6a4a.png)
ğŸš« ë¬¸ì œì : ê·¸ë˜ë””ì–¸íŠ¸ê°€ ì˜¬ë°”ë¥¸ ë°©í–¥ì€ ì œì‹œí•˜ì§€ë§Œ **ê·œëª¨ê°€ ë„ˆë¬´ í¼**   

### 4) í•™ìŠµë¥ (Î»)ë„ì…  
ë§¤ê°œë³€ìˆ˜ì˜ ë³€ê²½ ê·œëª¨ë¥¼ ì¡°ì •!     
ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ëŠ” ì§ì ‘ ì´ë¥¼ ì •ì˜í•˜ì§€ë§Œ, ë‹¤í–‰íˆ ì´ ì£¼ì œì— ëŒ€í•œ ì¶©ë¶„í•œ ì—°êµ¬ê°€ ìˆì—ˆë˜ ë•ë¶„ì— ë¨¸ì‹  ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ë‚˜ë¦„ì˜ ì•Œê³ ë¦¬ì¦˜ì´ í¬í•¨ë˜ì–´ ìˆ

![image](https://user-images.githubusercontent.com/76824611/128718649-97a0900f-fa5c-4c32-b204-06921f92f11d.png)
![image](https://user-images.githubusercontent.com/76824611/128718671-07d71dc9-e588-49ec-b936-5a0eec6fb1c6.png)

í•™ìŠµë¥ ì„ ë„ˆë¬´ ë†’ê²Œ ì„¤ì •í•˜ë©´ ëª©í‘œì—ì„œ ë” ë©€ë¦¬ ë²—ì–´ë‚¨    
ex) Î»=.5   
![image](https://user-images.githubusercontent.com/76824611/128718875-704d92ed-3da5-4c7d-9bcf-a52f2616cde1.png)

ë„ˆë¬´ ì‘ê²Œ ì„¤ì •í•˜ë©´ ëª©í‘œì— ë„ë‹¬í•˜ëŠ” ë° ë„ˆë¬´ ì˜¤ë˜ê±¸ë¦¼     
â¡ [ì•ˆì¥ì  saddle point](https://yerimoh.github.io/DL3/) ë¬¸ì œê°€ ì¼ì–´ë‚  ìˆ˜ ìˆìŒ(ì§€ì—­ ìµœì†Œê°’ì— ë¨¸ë¬¼ëŸ¬ ìˆê²Œ ëœë‹¤)   
ex) Î»=.005 
![image](https://user-images.githubusercontent.com/76824611/128719413-b6418ca3-8653-47ec-96b8-4d9b34031a4a.png)

### 5) í•™ìŠµ
â¡ ì´ ì¤‘ê°„ì¸ 0.1ì˜ í•™ìŠµë¥ ì„ ìœ ì§€í•´ë³´ê² ë‹¤     
$$Î»=.1$$  
$$mâ‰”âˆ’1 âˆ’7 Î»=âˆ’1.7$$    
$$b â‰”5 âˆ’3 Î»=5.3$$   
![image](https://user-images.githubusercontent.com/76824611/128720003-86d999ea-7ac0-4147-86f4-0bbb791dc34c.png)

ê³„ì†í•´ì„œ ê³¼ì •ì„ ë°˜ë³µí•˜ë©° **bì™€ mì˜ ìƒˆ ê°’ì„ ì ìš©í•´** ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ì°¾ìœ¼ë©´ ë¨.






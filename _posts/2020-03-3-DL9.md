---
title: "[09] Deep learning 1: "
date:   2020-03-3
excerpt: "ë°ì´í„° ì¦ê°„"
layout: post
tag:
- Deep Learning
order: 0

comments: true
---



# ë°ì´í„° ì¦ê°• ë° ë°°í¬

## ë¬¸ì œ
CNNìœ¼ë¡œ ê°œì„ ë˜ì—ˆê¸´ í•˜ì§€ë§Œ ì—¬ì „íˆ íŠ¸ë ˆì´ë‹ ì •í™•ë„ê°€ ê²€ì¦ ì •í™•ë„ë³´ë‹¤ ë” ë†’ìŒ â¡ ê³¼ì í•© ë¬¸ì œ ë‚¨ì•„ìˆìŒ    

## í•´ê²°ì±…
ì •ì œ ë°ì´í„°ê°€ ë” ë‚˜ì€ ì˜ˆì‹œë¥¼ ì œê³µ     
ë°ì´í„°ì„¸íŠ¸ì˜ ë‹¤ì–‘ì„±ì´ ëª¨ë¸ì˜ ì¼ë°˜í™”ì— ë„ì›€ì´ ë¨          


----

# ë°ì´í„° ì¦ê°• DATA AUGMENTATION
ëª¨ë¸ì´ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì‚´í´ë³¼ ë•Œ ì¢€ ë” ê°•ë ¥í•œ ì„±ëŠ¥ì„ ë°œíœ˜í•˜ë„ë¡ ê°€ë¥´ì¹˜ê¸° ìœ„í•´ ìš°ë¦¬ëŠ” **ë°ì´í„°ì„¸íŠ¸ì—ì„œ í¬ê¸°ì™€ í¸ì°¨**ë¥¼ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ **ëŠ˜ë¦¬ëŠ” ê²ƒ**           

ì»´í“¨í„° ë¹„ì „ ë¨¸ì‹  ëŸ¬ë‹ ëª¨ë¸ì—ì„  ë°ì´í„°ë¥¼ ì¦ê°•í•˜ì—¬ ì¶”ê°€ ì˜ˆì‹œë¥¼ ì œê³µ ê°€ëŠ¥    
* ë‹¤ìˆ˜ì˜ ë¨¸ì‹  ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ëŠ” ì´ë¯¸ ìì²´ì ìœ¼ë¡œ [ì‚¬ì§„ ìˆ˜ì •ì„ ìœ„í•œ ë„êµ¬](https://yerimoh.github.io/C0/)ë¥¼ ë³´ìœ      
Ex) ìƒ‰ì¡° ë³€ê²½   

ì´ë ‡ê²Œ ì¦ê°•ì„ í†µí•´ 
* **í¬ê¸° ì¦ê°€**: ëª¨ë¸ì´ íŠ¸ë ˆì´ë‹ ì¤‘ì— **ë” ë§ì€ ì´ë¯¸ì§€ë¥¼ í•™ìŠµ**ê°€ëŠ¥     
* **í¸ì°¨ ì¦ê°€**: ëª¨ë¸ì´ **ì¤‘ìš”í•˜ì§€ ì•Šì€ íŠ¹ì§•ì„ ë¬´ì‹œ**í•˜ê³  ë¶„ë¥˜ì—ì„œ ì •ë§ë¡œ ì¤‘ìš”í•œ íŠ¹ì§•ë§Œ ì„ íƒí•˜ë„ë¡ í•˜ì—¬ **ë” ë‚˜ì€ ì¼ë°˜í™”**ê°€ ê°€ëŠ¥     

----

# ëª©í‘œ
* ASL ë°ì´í„°ì„¸íŠ¸ ì¦ê°•    
* ì¦ê°•ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°œì„ ëœ ëª¨ë¸ íŠ¸ë ˆì´ë‹     
* ì œëŒ€ë¡œ íŠ¸ë ˆì´ë‹ëœ ëª¨ë¸ì„ ë””ìŠ¤í¬ì— ì €ì¥í•˜ì—¬ ë°°í¬ì— ì‚¬ìš©     

-----

## ë°ì´í„° ì¤€ë¹„

ìˆ˜í™” ë°ì´í„°ì„¸íŠ¸ëŠ” csv í˜•ì‹ìœ¼ë¡œ ë˜ì–´ìˆìŒ.      
* ìƒë‹¨ì— ë ˆì´ë¸”ì´ ìˆëŠ” í–‰ê³¼ ì—´ë¡œ ì´ë£¨ì–´ì§„ ê·¸ë¦¬ë“œ       
* ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì—¬ ì‘ì—…í•˜ê¸° ìœ„í•´ ë°ì´í„° ë¡œë“œ ë° ì¡°ì‘ì„ ìœ„í•œ ê³ ì„±ëŠ¥ íˆ´ì¸ [Pandas](https://yerimoh.github.io/PD/)ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©           
* CSV íŒŒì¼ì€ [DataFrame]( https://yerimoh.github.io/PD2/#%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%94%84%EB%A0%88%EC%9E%84-%EB%8B%A4%EB%A3%A8%EA%B8%B0)ì´ë¼ëŠ” í˜•ì‹ìœ¼ë¡œ ì½ìŒ        
 
```python
import pandas as pd
```



Pandasì—ëŠ” csv íŒŒì¼ì„ ì˜ˆìƒí•˜ê³  DataFrameì„ ë°˜í™˜í•˜ëŠ” read_csv ë©”ì„œë“œê°€ ì¡´ì¬      
* ì´ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ ì˜¬ ê²ƒì„   


<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# Load in our data from CSV files
train_df = pd.read_csv("data/asl_data/sign_mnist_train.csv")
valid_df = pd.read_csv("data/asl_data/sign_mnist_valid.csv")
```

</div>
</details>




### ë ˆì´ë¸” ì¶”ì¶œ
íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ë ˆì´ë¸”ì„ y_train ë° y_valid ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ” ë²•    
1ï¸âƒ£ í•´ë‹¹ ë³€ìˆ˜ë¥¼ ìƒì„±         
2ï¸âƒ£ ë‹¤ìŒ ë ˆì´ë¸”ì´ ë” ì´ìƒ í•„ìš”ì—†ëŠ” ë°ì´í„°í”„ë ˆì„ ì›ë³¸ì—ì„œ ë ˆì´ë¸”ì„ ì‚­ì œ      



<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# label ì´ë¼ëŠ” ì—´ì´ ì •ë‹µì—´ì„
y_train = train_df['label'] 
y_valid = valid_df['label']
del train_df['label']
del valid_df['label']
```

</div>
</details>


### ì´ë¯¸ì§€ ì¶”ì¶œ
íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ì´ë¯¸ì§€ë¥¼ x_train ë° x_valid ë³€ìˆ˜ì— ì €ì¥      

<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
x_train = train_df.values
x_valid = valid_df.values
```

</div>
</details>




### ë ˆì´ë¸” ë¶„ë¥˜
* [ë ˆì´ë¸”ì„ ë²”ì£¼ ì¸ì½”ë”©]( https://yerimoh.github.io/DL6/#31-%EB%B2%94%EC%A3%BC-%EC%9D%B8%EC%BD%94%EB%94%A9)

* ```keras.utils.to_categorical``` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ê¸°ì— ì¸ì½”ë”©í•  ê°’ê³¼ ê°’ì„ ì¸ì½”ë”©í•  ë²”ì£¼ ìˆ˜ë¥¼ ì „ë‹¬í•´ ë²”ì£¼ ì¸ì½”ë”©     
* ```kerasë¥¼ ê°€ì ¸ì™€ ë²”ì£¼ ìˆ˜(24)ë¥¼ ì„¤ì •í•´ë‘ ```       

```python
import tensorflow.keras as keras
num_classes = 24
```

ì´ ë‹¤ìŒ ì½”ë“œë¥¼ ì§œë´ë¼     
* Categorically encode y_train and y_valid     

<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# TODO: Categorically encode y_train and y_valid.
y_train = keras.utils.to_categorical(y_train, num_classes)
y_valid = keras.utils.to_categorical(y_valid, num_classes)
```
    
</div>
</details>


### ì´ë¯¸ì§€ë°ì´í„° ì •ê·œí™”  
ë°ì´í„°ì˜ í”½ì…€ ê°’ì´ í˜„ì¬ì²˜ëŸ¼ 0~255ê°€ ì•„ë‹Œ 0~1ì˜ ë¶€ë™ ì†Œìˆ˜ì  ê°’ì´ ë˜ì–´ì•¼í•¨        
* [ì´ìœ  ì•Œì•„ë³´ëŸ¬ê°€ê¸°]( https://yerimoh.github.io/DL6/#2-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EA%B7%9C%ED%99%94)

ë³´ê¸°ì „ì— ì½”ë“œ ì§ì ‘ ì³ë³´ê³  ì •ë§ ì •ë‹µ í™•ì¸ìš©ìœ¼ë¡œ ë´ë¼   
<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
x_train = x_train / 255
x_valid = x_valid / 255
```

</div>
</details>


â¤ ì—¬ê¸°ê¹Œì§„ [MNIST ëª¨ë¸ êµ¬í˜„](https://yerimoh.github.io/DL6/)ê³¼ ê°™ë‹¤ â¤ 

----

# CNNì„ ìœ„í•œ ì´ë¯¸ì§€ ë³€í™˜ reshaping

í˜„ì¬ ë°ì´í„° ì…‹ì˜ ìƒíƒœë¥¼ í™•ì¸í•´ë³´ì     
```python 
x_train.shape, x_valid.shape
# ((27455, 784), (7172, 784))
```

í˜„ì¬ ë°ì´í„° ì…‹ì˜ íŠ¹ì§•    
* ì„œë¡œ ê°€ê¹Œìš´ í”½ì…€(ìœ„ì¹˜ ì •ë³´)ì— ëŒ€í•œ ëª¨ë“  ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•ŠìŒ      
* featureë¥¼ íƒì§€í•˜ëŠ” **[ì»¨ë³¼ë£¨ì…˜(convolution)(í•©ì„±ê³± ê³„ì¸µ)](https://yerimoh.github.io/DL8/#%ED%95%A9%EC%84%B1%EA%B3%B1-%EA%B3%84%EC%B8%B5)** ì ìš© **ë¶ˆê°€**      

**[ë³€í™˜]**   
ì»¨ë³¼ë£¨ì…˜ ì ìš©ì„ ìœ„í•´ ë°ì´í„° ì…‹ì„ 28x28í”½ì…€ í˜•ì‹ìœ¼ë¡œ ë³€ê²½       
â¡ ì»¨ë³¼ë£¨ì…˜ì—ì„œ **ì¸ì ‘í•œ í”½ì…€ë¼ë¦¬ ê·¸ë£¹**ì„ ì§“ê³  ì¤‘ìš”í•œ featureë“¤ì„ íƒì§€ê°€ëŠ¥      

**[ëª¨ë¸ì˜ ì²«ë²ˆ ì§¸ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´]**     
[ìì„¸í•œ ì„¤ëª… ë³´ëŸ¬ê°€ê¸°](https://yerimoh.github.io/DL8/#%ED%95%A9%EC%84%B1%EA%B3%B1-%EA%B3%84%EC%B8%B5%EC%9D%98-%EA%B5%AC%ED%98%84)      
* ì´ë¯¸ì§€ì˜ ë†’ì´    
* ì´ë¯¸ì§€ ë„ˆë¹„     
* ì±„ë„ì˜ ìˆ«ì       
ìš°ë¦¬ì˜ ì´ë¯¸ì§€ëŠ” **Grayscale**ì´ê¸° ë•Œë¬¸ì— **ì±„ë„ì€ 1**ì˜ ê°’ì„ ê°–ìŒ          

ì¦‰,  
**(27455, 784) â¡ (27455, 28, 28, 1)**         
**(ì´ë¯¸ì§€ ê°œìˆ˜, í”½ì…€ ê°œìˆ˜) â¡ (ì´ë¯¸ì§€ ê°œìˆ˜, íŠ¹ì§•ë§µ ê°€ë¡œ, íŠ¹ì§•ë§µ ì„¸ë¡œ, ì±„ë„ ìˆ˜)**      


**ë™ì¼**í•˜ê²Œ **ìœ ì§€**í•˜ê¸°ë¥¼ ì›í•˜ëŠ” ëª¨ë“  ì°¨ì›ì— ëŒ€í•´ reshapeì„ ì§„í–‰í•˜ëŠ” ê²½ìš°,     
**'-1'** ì„ í†µí•´ í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±     

```python 
x_train = x_train.reshape(-1,28,28,1)
x_valid = x_valid.reshape(-1,28,28,1)
```

ë°”ë€ ë°ì´í„° í™•ì¸
```python 
x_train.shape
# (27455, 28, 28, 1)
x_valid.shape
# (7172, 28, 28, 1)
x_train.shape, x_valid.shape
# ((27455, 28, 28, 1), (7172, 28, 28, 1))
```


----

# í•©ì„±ê³± ëª¨ë¸ ìƒì„±
ì•„ë˜ì˜ ê·¸ë¦¼ì„ êµ¬í˜„í•  ê²ƒì„
![image](https://user-images.githubusercontent.com/76824611/128993962-42166a4e-3a09-4a15-a8f4-42dece705a69.png)

í•„ìš”í•œê±´ ì¤„í…Œë‹ˆ ê³„ì¸µì„ í•˜ë‚˜í•˜ë‚˜ êµ¬í˜„í•´ ë³´ì!
*  padding="same" ì´ë‹¤

```python 
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import (
    Dense,
    Conv2D,
    MaxPool2D,
    Flatten,
    Dropout,
    BatchNormalization,
) 
```

ë¨¼ì € ì¸ìŠ¤í„´ìŠ¤ ë¶€í„° ìƒì„±í•´ë¼  

<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python 
model = Sequential()
model.add(Conv2D(75, (3, 3), strides=1, padding="same", activation="relu", input_shape=(28, 28, 1)))
model.add(BatchNormalization())
model.add(MaxPool2D((2, 2), strides=2, padding="same"))
model.add(Conv2D(50, (3, 3), strides=1, padding="same", activation="relu"))
model.add(Dropout(0.2))
model.add(BatchNormalization())
model.add(MaxPool2D((2, 2), strides=2, padding="same"))
model.add(Conv2D(25, (3, 3), strides=1, padding="same", activation="relu"))
model.add(BatchNormalization())
model.add(MaxPool2D((2, 2), strides=2, padding="same"))
model.add(Flatten())
model.add(Dense(units=512, activation="relu"))
model.add(Dropout(0.3))
model.add(Dense(units=num_classes, activation="softmax"))
```
    
</div>
</details>



â¤ ì—¬ê¸°ê¹Œì§„ [CNN ëª¨ë¸ êµ¬í˜„](https://yerimoh.github.io/DL8.5/)ê³¼ ê°™ë‹¤ â¤ 


----
----


# ë°ì´í„° ì¦ê°•
ëª¨ë¸ì„ ì»´íŒŒì¼í•˜ê¸° ì „ì— ë°ì´í„° ì¦ê°•ì„ ì„¤ì • í•„ìš”      

```Keras```ì˜ ```ImageDataGenerator```: **ì´ë¯¸ì§€ ì¦ê°• í´ë˜ìŠ¤**       
* ì´ í´ë˜ìŠ¤ëŠ” ë°ì´í„° ì¦ê°•ì„ ìœ„í•œ ì¼ë ¨ì˜ ì˜µì…˜ì„ í—ˆìš©       
* ê³¼ì • í›„ë°˜ë¶€ì—ì„œ ì í•©í•œ ì¦ê°• ì „ëµì„ ì„ íƒ í•„ìš”      

```python 
from tensorflow.keras.preprocessing.image import ImageDataGenerator
```


---

## ì˜µì…˜ 
* featurewise_center: Boolean. ì…ë ¥ í‰ê· ì„ ë°ì´í„° ì§‘í•© ìœ„ì— 0ìœ¼ë¡œ ì„¤ì •        
* samplewise_center: Boolean. ê° í‘œë³¸ í‰ê· ì„ 0ìœ¼ë¡œ ì„¤ì •     
* featurewise_std_normalization: Boolean. ì…ë ¥ì„ ë°ì´í„° ì§‘í•©(íŠ¹ì§•ë§µ)ì˜ í‘œì¤€ìœ¼ë¡œ ë‚˜ëˆ”     
* samplewise_std_normalization: Boolean. ê° ì…ë ¥ì„ í‘œì¤€ìœ¼ë¡œ ë‚˜ëˆ”        
* zca_epsilon: ZCA ë¯¸ë°±ìš© ì—¡ì‹¤ë¡ . ê¸°ë³¸ê°’ì€ 1e-6     
* zca_whitening: Boolean. ZCA í™”ì´íŠ¸ë‹      
* rotation_range: Int. ë¬´ì‘ìœ„ íšŒì „ì— ëŒ€í•œ ë„(ã…‡) ë‹¨ìœ„ ë²”ìœ„       
* width_shift_range: Float, ì´ë¯¸ì§€ë¥¼ ìˆ˜í‰ìœ¼ë¡œ ì„ì˜ë¡œ ì´ë™(ì „ì²´ ë„ˆë¹„ì˜ ëŒ€ì¹­)      
* height_shift_range: Float, ì´ë¯¸ì§€ë¥¼ ìˆ˜ì§ìœ¼ë¡œ ì„ì˜ë¡œ ì´ë™(ì „ì²´ ë†’ì´ì˜ ëŒ€ì¹­) 
* brightness_range: Tuple or list of two floats,ë°ê¸° ì´ë™ ê°’ ì„ íƒ ë²”ìœ„    
* shear_range: Float, ì „ë‹¨ ê°•ë„(ë„ ë‹¨ìœ„ë¡œ ì‹œê³„ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì „ë‹¨ ê°ë„)     
* zoom_range: Float or [lower, upper], ë¬´ì‘ìœ„ í™•ëŒ€/ì¶•ì†Œ ë²”ìœ„ì…ë‹ˆë‹¤. ë¶€ë™ ì†Œìˆ˜ì¸ ê²½ìš°, [í•˜ìœ„, ìƒí•œ] = [1-dynam_range, 1+dynam_range].          
* channel_shift_range: Float, ë¬´ì‘ìœ„ ì±„ë„ ì´ë™ ë²”ìœ„         
* fill_mode: One of {"constant", "nearest", "reflect" or "wrap"}, "nearest"ê°€ ê¸°ë³¸        
   * ì§€ì •ëœ ëª¨ë“œì— ë”°ë¼ ì…ë ¥ ê²½ê³„ë¥¼ ë²—ì–´ë‚˜ëŠ” ì ì´ ì±„ì›Œì§       
   * constant': kkkkkkkk|abcd|kkkkkkkk (cval=k)   
   * 'nearest': aaaaaaaa|abcd|dddddddd    
   * 'reflect': abcddcba|abcd|dcbaabcd    
   * 'wrap': abcdabcd|abcd|abcdabcd   
* cval: Float or Int, ê²½ê³„ë¥¼ ë²—ì–´ë‚˜ëŠ” ì ì— ì‚¬ìš©ë˜ëŠ” ê°’         
* horizontal_flip: Boolean, ì…ë ¥ì„ ìˆ˜í‰ìœ¼ë¡œ ëœë¤í•˜ê²Œ ë’¤ì§‘ìŒ    
* vertical_flip: Boolean. ì…ë ¥ì„ ìˆ˜ì§ìœ¼ë¡œ ëœë¤í•˜ê²Œ ë’¤ì§‘ìŒ    
* rescale: ë°ì´í„°ì— ì œê³µëœ ê°’ì„ ê³±í•¨      
* preprocessing_function: ê° ì…ë ¥ì— ì ìš©ë  í•¨ìˆ˜ -> ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • ë° ì¦ê°• í›„ì— ì‹¤í–‰         
* dtype: ìƒì„±ëœ ì–´ë ˆì´ì— ì‚¬ìš©í•  Dtype       

ì—¬ê¸°ì„  ì„¤ì •ì„,   
```python 
datagen = ImageDataGenerator(
    rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)
    zoom_range=0.1,  # Randomly zoom image
    width_shift_range=0.1,  # randomly shift images horizontally (fraction of total width)
    height_shift_range=0.1,  # randomly shift images vertically (fraction of total height)
    horizontal_flip=True,  # randomly flip images horizontally
    vertical_flip=False, # Don't randomly flip images vertically
)  
```

ì´ë¯¸ì§€ë¥¼ ì„¸ë¡œê°€ ì•„ë‹Œ ê°€ë¡œë¡œ ë°˜ì „í•´ì•¼ í•˜ëŠ” ì´ìœ        
* ì† ì´ë¯¸ì§€ë¥¼ ë¶„ë¥˜í•˜ë ¤ëŠ” ê²½ìš° ì†ì˜ ìœ„ì•„ë˜ê°€ ë°”ë€” ê°€ëŠ¥ì„±ì€ ì ì§€ë§Œ ì™¼ì†ì¡ì´ë¡œ ì „í™˜ë  ìˆ˜ëŠ” ìˆê¸° ë•Œë¬¸     
* [matplotlib]( https://yerimoh.github.io//PD3/#matplotlib-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A1%9C-%EA%B7%B8%EB%9E%98%ED%94%84-%EA%B7%B8%EB%A6%AC%EA%B8%B0) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©      

----

## ë°°ì¹˜í¬ê¸°
```ImageDataGenerator```: ëª¨ë¸ì´ ë¬´ì‘ìœ„ ìƒ˜í”Œì— ëŒ€í•´ íŠ¸ë ˆì´ë‹í•  ìˆ˜ ìˆë„ë¡ ë°ì´í„°ë¥¼ [ë°°ì¹˜ì²˜ë¦¬](https://yerimoh.github.io/DL5/#%EB%B0%B0%EC%B9%98-%EC%A0%95%EA%B7%9C%ED%99%94-batch-normalization)      

```python 
import matplotlib.pyplot as plt
import numpy as np
batch_size = 32
img_iter = datagen.flow(x_train, y_train, batch_size=batch_size)

x, y = img_iter.next()
fig, ax = plt.subplots(nrows=4, ncols=8)
for i in range(batch_size):
    image = x[i]
    ax.flatten()[i].imshow(np.squeeze(image))
plt.show()
```

**[ë°°ì¹˜ì¡°ì •, ì¦ê°• ì „]**    
![image](https://user-images.githubusercontent.com/76824611/129066058-60fe0d92-08a8-4b2d-97e2-24fad9016994.png)
**[ë°°ì¹˜ì¡°ì •, ì¦ê°• í›„]**  
![image](https://user-images.githubusercontent.com/76824611/129066101-68babd49-7381-4bb3-87c3-e1ce4fe22076.png)

----

## ë°ì´í„° ìƒì„±ê¸°ì— ë§ì¶”ê¸°
ì´ì œ ìƒì„±ê¸°ë¥¼ íŠ¸ë ˆì´ë‹ ë°ì´í„°ì„¸íŠ¸ì— ë§ì¶°ì•¼ í•¨    
ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ íŠ¸ë ˆì´ë‹ ë°ì´í„°ì— ë§ì¶¤ -> ì»´íŒŒì¼ í•˜ê¸°ìœ„í•´   
```python 
datagen.fit(x_train)
```
---

# ëª¨ë¸ ì»´íŒŒì¼
ì‹¤ì œë¡œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ íŠ¸ë ˆì´ë‹í•˜ê¸° ì „ì— ìˆ˜í–‰í•´ì•¼ í•  ë§ˆì§€ë§‰ ë‹¨ê³„       
* ì†ì‹¤í•¨ìˆ˜: ```categorical crossentropy```ì‚¬ìš©      
* ëª¨ë¸ì˜ ì •í™•ë„ë¥¼ ì¸¡ì •

```python 
model.compile(loss='categorical_crossentropy', metrics=['accuracy'])
```


-----

# ì¦ê°•ìœ¼ë¡œ íŠ¸ë ˆì´ë‹
Kerasì— **ì´ë¯¸ì§€ ë°ì´í„° ìƒì„±ê¸°**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ëª¨ë¸ì€ ì•½ê°„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ íŠ¸ë ˆì´ë‹.    
* **ê¸°ì¡´ë°©ì‹**: ë‹¨ìˆœíˆ x_train ë° y_train ë°ì´í„°ì„¸íŠ¸ë¥¼ ëª¨ë¸ì— ì „ë‹¬     
* **í˜„ì¬ ë°©ì‹**: ìƒì„±ê¸°ë¥¼ ì „ë‹¬í•˜ì—¬ ìƒì„±ê¸°ì˜ flow ë©”ì„œë“œë¥¼ í˜¸ì¶œ     
   * ê·¸ëŸ¬ë©´ ì´ë¯¸ì§€ê°€ íŠ¸ë ˆì´ë‹ì„ ìœ„í•´ **ëª¨ë¸ì— ì „ë‹¬ë˜ê¸° ì§ì „**ì— **ì‹¤ì‹œê°„ìœ¼ë¡œ ì¦ê°•**ë˜ì–´ ë©”ëª¨ë¦¬ì— ìœ„ì¹˜

**ìƒì„±ê¸°(Generator)**: ë¬´í•œí•œ ë°ì´í„°ë¥¼ ê³µê¸‰í•  ìˆ˜ ìˆìŒ     
* ìƒì„±ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ íŠ¸ë ˆì´ë‹í•  ë•Œ, ê° **ì—í¬í¬ê°€ ì–¼ë§ˆë‚˜ ì˜¤ë«ë™ì•ˆ ì‹¤í–‰**ë˜ì–´ì•¼ í•˜ëŠ”ì§€ë¥¼ ëª…ì‹œì ìœ¼ë¡œ **ì„¤ì •** í•„ìš”      
* ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì—í¬í¬ê°€ ë¬´í•œíˆ ì‹¤í–‰ë˜ê³  ìƒì„±ê¸°ëŠ” ëª¨ë¸ì„ ì œê³µí•˜ê¸° ìœ„í•´ ì¦ê°•ëœ ì´ë¯¸ì§€ë¥¼ ë¬´í•œì •ìœ¼ë¡œ ìƒì„±      
* ```steps_per_epoch```: ì—í¬í¬ê°€ ì–¼ë§ˆë‚˜ ì˜¤ë«ë™ì•ˆ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ”ì§€ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •        
* ```steps * batch_size = number_of_images_trained in an epoch```: ë‹¨ê³„ ìˆ˜ë¥¼ ì¦ê°•ë˜ì§€ ì•Šì€ ë°ì´í„°ì„¸íŠ¸ í¬ê¸°ë¥¼ batch_size(ê¸°ë³¸ê°’ 32)ë¡œ ë‚˜ëˆˆ ê°’ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸       

ê¸°ì¡´ì˜ CNNë³´ë‹¤ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì´ìœ ëŠ” ë°ì´í„°ê°€ ì¦ê°•ë˜ì–´ ë” ë§ì•„ì¡Œê¸° ë•Œë¬¸
```python 
model.fit(img_iter,
          epochs=20,
          steps_per_epoch=len(x_train)/batch_size, # Run same number of steps we would if we were not using a generator.
          validation_data=(x_valid, y_valid))
```

----

# ê²°ê³¼ í•´ì„
ë¨¼ì € ê²°ê³¼ë¥¼ ë³´ì
<details>
<summary> ğŸ‘€ ê²°ê³¼ ë³´ê¸°</summary>
<div markdown="1">

```python 
Epoch 1/20
858/857 [==============================] - 8s 9ms/step - loss: 1.0688 - accuracy: 0.6604 - val_loss: 0.8469 - val_accuracy: 0.7082
Epoch 2/20
858/857 [==============================] - 7s 8ms/step - loss: 0.3064 - accuracy: 0.8960 - val_loss: 0.1397 - val_accuracy: 0.9522
Epoch 3/20
858/857 [==============================] - 7s 8ms/step - loss: 0.1952 - accuracy: 0.9349 - val_loss: 1.6423 - val_accuracy: 0.6775
Epoch 4/20
858/857 [==============================] - 7s 8ms/step - loss: 0.1501 - accuracy: 0.9516 - val_loss: 0.6556 - val_accuracy: 0.8296
Epoch 5/20
858/857 [==============================] - 7s 8ms/step - loss: 0.1286 - accuracy: 0.9588 - val_loss: 0.1129 - val_accuracy: 0.9618
Epoch 6/20
858/857 [==============================] - 7s 8ms/step - loss: 0.1134 - accuracy: 0.9637 - val_loss: 0.3497 - val_accuracy: 0.8993
Epoch 7/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0995 - accuracy: 0.9700 - val_loss: 0.3377 - val_accuracy: 0.9060
Epoch 8/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0917 - accuracy: 0.9709 - val_loss: 0.1426 - val_accuracy: 0.9470
Epoch 9/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0834 - accuracy: 0.9748 - val_loss: 0.0934 - val_accuracy: 0.9663
Epoch 10/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0796 - accuracy: 0.9764 - val_loss: 0.0393 - val_accuracy: 0.9883
Epoch 11/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0740 - accuracy: 0.9779 - val_loss: 2.6428 - val_accuracy: 0.7280
Epoch 12/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0779 - accuracy: 0.9785 - val_loss: 0.2394 - val_accuracy: 0.9361
Epoch 13/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0652 - accuracy: 0.9801 - val_loss: 0.2099 - val_accuracy: 0.9516
Epoch 14/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0587 - accuracy: 0.9829 - val_loss: 0.0415 - val_accuracy: 0.9851
Epoch 15/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0603 - accuracy: 0.9826 - val_loss: 0.0218 - val_accuracy: 0.9930
Epoch 16/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0593 - accuracy: 0.9831 - val_loss: 0.0142 - val_accuracy: 0.9962
Epoch 17/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0578 - accuracy: 0.9835 - val_loss: 0.1707 - val_accuracy: 0.9587
Epoch 18/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0508 - accuracy: 0.9849 - val_loss: 0.5059 - val_accuracy: 0.8712
Epoch 19/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0573 - accuracy: 0.9844 - val_loss: 0.0666 - val_accuracy: 0.9806
Epoch 20/20
858/857 [==============================] - 7s 8ms/step - loss: 0.0528 - accuracy: 0.9860 - val_loss: 0.0086 - val_accuracy: 0.9962
<tensorflow.python.keras.callbacks.History at 0x7f37c461c9e8>
```
  
</div>
</details>
  
ê²€ì¦ ì •í™•ë„ê°€ ë” ë†’ê³ , ë” ì¼ê´€ì ì„    
CNNì— ë¹„í•´ ê³¼ì í•© ìƒíƒœë¥¼ ë³´ì´ì§€ ì•ŠìŒ    
â¡ ì¼ë°˜í™”ê°€ ê°œì„ ë˜ì—ˆê³  ìƒˆ ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡ë„ ê°œì„     


----

# ëª¨ë¸ ì €ì¥
ì œëŒ€ë¡œ íŠ¸ë ˆì´ë‹ëœ ëª¨ë¸ì„ ì–»ì—ˆìœ¼ë‹ˆ ì´ì œ ì´ë¥¼ ì´ìš©í•´ ìƒˆ ì´ë¯¸ì§€ì— ëŒ€í•œ ì¶”ë¡ ì„ ìˆ˜í–‰ í•„ìš”          

ë§Œì¡±ìŠ¤ëŸ½ê²Œ í•™ìŠµëœ ëª¨ë¸ì€ ë³´í†µ ë””ìŠ¤í¬ì— ì €ì¥í•˜      

Kerasì—ì„œ ì €ì¥ ë©”ì„œë“œ ì œê³µ

```python 
model.save('asl_model')
```

---


# ë©”ëª¨ë¦¬
ë„˜ì–´ê°€ê¸° ì „ì— ë‹¤ìŒ ì…€ì„ ì‹¤í–‰í•˜ì—¬ GPU ë©”ëª¨ë¦¬ë¥¼ ì§€ìš°ê¸°     
ì´ëŠ” ë‹¤ìŒ ë…¸íŠ¸ë¶ìœ¼ë¡œ ë„˜ì–´ê°€ê¸° ìœ„í•œ í•„ìˆ˜ ì‘ì—…     
```python
import IPython
app = IPython.Application.instance()
app.kernel.do_shutdown(True)
```

---

# ì´ ëª¨ë¸ë¡œ ì˜ˆì¸¡ ìˆ˜í–‰í•˜ê¸°
* [ì˜ˆì¸¡í•˜ëŸ¬ ê°€ê¸°]()


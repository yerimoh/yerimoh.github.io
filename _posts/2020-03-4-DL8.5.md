---
title: "[08.5] Deep learning 1: í•©ì„±ê³± ì‹ ê²½ë§(convolutional neural network, CNN) êµ¬í˜„"
date:   2020-03-4
excerpt: "í•©ì„±ê³± ì‹ ê²½ë§(convolutional neural network, CNN) ì „ì²´ ê³¼ì • ì‹¤ì œë¡œ êµ¬í˜„í•´ë³´ê¸°, CNNì„ ìœ„í•œ ì´ë¯¸ì§€ ë³€í™˜ reshaping, í•©ì„±ê³± ëª¨ë¸ ìƒì„±"
layout: post
tag:
- Deep Learning
order: 0

comments: true
---

# ëª©ì°¨
  * [êµ¬í˜„í•˜ê¸° ì „ ì½ì–´ ë³¼ ì§€ì‹](#êµ¬í˜„í•˜ê¸° ì „ ì½ì–´ ë³¼ ì§€ì‹)
  * [ëª©í‘œ](#ëª©í‘œ)
  * [ë°ì´í„° ì¤€ë¹„](#ë°ì´í„°-ì¤€ë¹„)
    + [ë ˆì´ë¸” ì¶”ì¶œ](#ë°ì´í„°-ì¤€ë¹„)
    + [ì´ë¯¸ì§€ ì¶”ì¶œ](#ì´ë¯¸ì§€-ì¶”ì¶œ)
    + [ë ˆì´ë¸” ë¶„ë¥˜](#ë ˆì´ë¸”-ë¶„ë¥˜)
    + [ì´ë¯¸ì§€ë°ì´í„° ì •ê·œí™”](#ì´ë¯¸ì§€ë°ì´í„° ì •ê·œí™”)
- [CNNì„ ìœ„í•œ ì´ë¯¸ì§€ ë³€í™˜ reshaping](#cnnì„ ìœ„í•œ-ì´ë¯¸ì§€ ë³€í™˜-reshaping)
- [í•©ì„±ê³± ëª¨ë¸ ìƒì„±](#í•©ì„±ê³±-ëª¨ë¸-ìƒì„±)
  * [Conv2D](#conv2d)
    + [ë°°ì¹˜ ì •ê·œí™”](#ë°°ì¹˜-ì •ê·œí™”)
    + [MaxPool2D](#maxpool2d)
    + [Dropout](#dropout)
    + [Flatten](#flatten)
    + [Dense](#dense)
- [ëª¨ë¸ ìš”ì•½](#ëª¨ë¸-ìš”ì•½)
- [ëª¨ë¸ ì»´íŒŒì¼](#ëª¨ë¸-ì»´íŒŒì¼)
- [ëª¨ë¸ íŠ¸ë ˆì´ë‹](#ëª¨ë¸-íŠ¸ë ˆì´ë‹)
- [ê²°ê³¼ í•´ì„](#ê²°ê³¼-í•´ì„)
- [ë©”ëª¨ë¦¬](#ë©”ëª¨ë¦¬)




---

## êµ¬í˜„í•˜ê¸° ì „ ì½ì–´ ë³¼ ì§€ì‹
* ğŸ“Œ**í•„ìˆ˜**ğŸ“Œ[í•©ì„±ê³± ì‹ ê²½ë§(convolutional neural network, CNN)](https://yerimoh.github.io/DL8/)           
* ğŸ“Œ**í•„ìˆ˜**ğŸ“Œ[ë” ê°„ë‹¨í•œ êµ¬í˜„ë¶€í„° í•´ë³´ê¸°: MNIST](https://yerimoh.github.io/DL6/)    

ì•„ë˜ì˜ ğŸ‘€**ì •ë‹µ ì½”ë“œ ë³´ê¸°** ë¥¼ ëˆ„ë¥´ê¸° ì „ ì½”ë“œë¥¼ í•œë²ˆ ì§œë³´ê³  ë‹µì„ ë³´ê¸¸ ë°”ë€ë‹¤!! 

----

## ëª©í‘œ
* CNN ëª¨ë¸ì„ ìœ„í•œ ë°ì´í„° ì¤€ë¹„     
* ì„¸ë ¨ëœ í˜•íƒœì˜ CNN ëª¨ë¸ ìƒì„±, ë‹¤ì–‘í•œ layerë“¤ì˜ ì´í•´    
* CNN ëª¨ë¸ í•™ìŠµ ë° ì„±ëŠ¥ ê´€ì°°    

----

## ë°ì´í„° ì¤€ë¹„

ìˆ˜í™” ë°ì´í„°ì„¸íŠ¸ëŠ” csv í˜•ì‹ìœ¼ë¡œ ë˜ì–´ìˆìŒ.      
* ìƒë‹¨ì— ë ˆì´ë¸”ì´ ìˆëŠ” í–‰ê³¼ ì—´ë¡œ ì´ë£¨ì–´ì§„ ê·¸ë¦¬ë“œ       
* ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì—¬ ì‘ì—…í•˜ê¸° ìœ„í•´ ë°ì´í„° ë¡œë“œ ë° ì¡°ì‘ì„ ìœ„í•œ ê³ ì„±ëŠ¥ íˆ´ì¸ [Pandas](https://yerimoh.github.io/PD/)ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©           
* CSV íŒŒì¼ì€ [DataFrame]( https://yerimoh.github.io/PD2/#%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%94%84%EB%A0%88%EC%9E%84-%EB%8B%A4%EB%A3%A8%EA%B8%B0)ì´ë¼ëŠ” í˜•ì‹ìœ¼ë¡œ ì½ìŒ        
 
```python
import pandas as pd
```



Pandasì—ëŠ” csv íŒŒì¼ì„ ì˜ˆìƒí•˜ê³  DataFrameì„ ë°˜í™˜í•˜ëŠ” read_csv ë©”ì„œë“œê°€ ì¡´ì¬      
* ì´ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ ì˜¬ ê²ƒì„   


<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# Load in our data from CSV files
train_df = pd.read_csv("data/asl_data/sign_mnist_train.csv")
valid_df = pd.read_csv("data/asl_data/sign_mnist_valid.csv")
```

</div>
</details>




### ë ˆì´ë¸” ì¶”ì¶œ
íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ë ˆì´ë¸”ì„ y_train ë° y_valid ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ” ë²•    
1ï¸âƒ£ í•´ë‹¹ ë³€ìˆ˜ë¥¼ ìƒì„±         
2ï¸âƒ£ ë‹¤ìŒ ë ˆì´ë¸”ì´ ë” ì´ìƒ í•„ìš”ì—†ëŠ” ë°ì´í„°í”„ë ˆì„ ì›ë³¸ì—ì„œ ë ˆì´ë¸”ì„ ì‚­ì œ      



<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# label ì´ë¼ëŠ” ì—´ì´ ì •ë‹µì—´ì„
y_train = train_df['label'] 
y_valid = valid_df['label']
del train_df['label']
del valid_df['label']
```

</div>
</details>


### ì´ë¯¸ì§€ ì¶”ì¶œ
íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ì´ë¯¸ì§€ë¥¼ x_train ë° x_valid ë³€ìˆ˜ì— ì €ì¥      

<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
x_train = train_df.values
x_valid = valid_df.values
```

</div>
</details>




### ë ˆì´ë¸” ë¶„ë¥˜
* [ë ˆì´ë¸”ì„ ë²”ì£¼ ì¸ì½”ë”©]( https://yerimoh.github.io/DL6/#31-%EB%B2%94%EC%A3%BC-%EC%9D%B8%EC%BD%94%EB%94%A9)

* ```keras.utils.to_categorical``` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ê¸°ì— ì¸ì½”ë”©í•  ê°’ê³¼ ê°’ì„ ì¸ì½”ë”©í•  ë²”ì£¼ ìˆ˜ë¥¼ ì „ë‹¬í•´ ë²”ì£¼ ì¸ì½”ë”©     
* ```kerasë¥¼ ê°€ì ¸ì™€ ë²”ì£¼ ìˆ˜(24)ë¥¼ ì„¤ì •í•´ë‘ ```       

```python
import tensorflow.keras as keras
num_classes = 24
```

ì´ ë‹¤ìŒ ì½”ë“œë¥¼ ì§œë´ë¼     
* Categorically encode y_train and y_valid     

<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
# TODO: Categorically encode y_train and y_valid.
y_train = keras.utils.to_categorical(y_train, num_classes)
y_valid = keras.utils.to_categorical(y_valid, num_classes)
```
    
</div>
</details>


### ì´ë¯¸ì§€ë°ì´í„° ì •ê·œí™”  
ë°ì´í„°ì˜ í”½ì…€ ê°’ì´ í˜„ì¬ì²˜ëŸ¼ 0~255ê°€ ì•„ë‹Œ 0~1ì˜ ë¶€ë™ ì†Œìˆ˜ì  ê°’ì´ ë˜ì–´ì•¼í•¨        
* [ì´ìœ  ì•Œì•„ë³´ëŸ¬ê°€ê¸°]( https://yerimoh.github.io/DL6/#2-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EA%B7%9C%ED%99%94)

ë³´ê¸°ì „ì— ì½”ë“œ ì§ì ‘ ì³ë³´ê³  ì •ë§ ì •ë‹µ í™•ì¸ìš©ìœ¼ë¡œ ë´ë¼   
<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
x_train = x_train / 255
x_valid = x_valid / 255
```

</div>
</details>


â¤ ì—¬ê¸°ê¹Œì§„ MNIST ëª¨ë¸ êµ¬í˜„ê³¼ ê°™ë‹¤ â¤ 

----




# CNNì„ ìœ„í•œ ì´ë¯¸ì§€ ë³€í™˜ reshaping

í˜„ì¬ ë°ì´í„° ì…‹ì˜ ìƒíƒœë¥¼ í™•ì¸í•´ë³´ì     
```python 
x_train.shape, x_valid.shape
# ((27455, 784), (7172, 784))
```

í˜„ì¬ ë°ì´í„° ì…‹ì˜ íŠ¹ì§•    
* ì„œë¡œ ê°€ê¹Œìš´ í”½ì…€(ìœ„ì¹˜ ì •ë³´)ì— ëŒ€í•œ ëª¨ë“  ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•ŠìŒ      
* featureë¥¼ íƒì§€í•˜ëŠ” **[ì»¨ë³¼ë£¨ì…˜(convolution)(í•©ì„±ê³± ê³„ì¸µ)](https://yerimoh.github.io/DL8/#%ED%95%A9%EC%84%B1%EA%B3%B1-%EA%B3%84%EC%B8%B5)** ì ìš© **ë¶ˆê°€**      

**[ë³€í™˜]**   
ì»¨ë³¼ë£¨ì…˜ ì ìš©ì„ ìœ„í•´ ë°ì´í„° ì…‹ì„ 28x28í”½ì…€ í˜•ì‹ìœ¼ë¡œ ë³€ê²½       
â¡ ì»¨ë³¼ë£¨ì…˜ì—ì„œ **ì¸ì ‘í•œ í”½ì…€ë¼ë¦¬ ê·¸ë£¹**ì„ ì§“ê³  ì¤‘ìš”í•œ featureë“¤ì„ íƒì§€ê°€ëŠ¥      

**[ëª¨ë¸ì˜ ì²«ë²ˆ ì§¸ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´]**     
[ìì„¸í•œ ì„¤ëª… ë³´ëŸ¬ê°€ê¸°](https://yerimoh.github.io/DL8/#%ED%95%A9%EC%84%B1%EA%B3%B1-%EA%B3%84%EC%B8%B5%EC%9D%98-%EA%B5%AC%ED%98%84)      
* ì´ë¯¸ì§€ì˜ ë†’ì´    
* ì´ë¯¸ì§€ ë„ˆë¹„     
* ì±„ë„ì˜ ìˆ«ì       
ìš°ë¦¬ì˜ ì´ë¯¸ì§€ëŠ” **Grayscale**ì´ê¸° ë•Œë¬¸ì— **ì±„ë„ì€ 1**ì˜ ê°’ì„ ê°–ìŒ          

ì¦‰,  
**(27455, 784) â¡ (27455, 28, 28, 1)**         
**(ì´ë¯¸ì§€ ê°œìˆ˜, í”½ì…€ ê°œìˆ˜) â¡ (ì´ë¯¸ì§€ ê°œìˆ˜, íŠ¹ì§•ë§µ ê°€ë¡œ, íŠ¹ì§•ë§µ ì„¸ë¡œ, ì±„ë„ ìˆ˜)**      


**ë™ì¼**í•˜ê²Œ **ìœ ì§€**í•˜ê¸°ë¥¼ ì›í•˜ëŠ” ëª¨ë“  ì°¨ì›ì— ëŒ€í•´ reshapeì„ ì§„í–‰í•˜ëŠ” ê²½ìš°,     
**'-1'** ì„ í†µí•´ í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±     

```python 
x_train = x_train.reshape(-1,28,28,1)
x_valid = x_valid.reshape(-1,28,28,1)
```

ë°”ë€ ë°ì´í„° í™•ì¸
```python 
x_train.shape
# (27455, 28, 28, 1)
x_valid.shape
# (7172, 28, 28, 1)
x_train.shape, x_valid.shape
# ((27455, 28, 28, 1), (7172, 28, 28, 1))
```



----

# í•©ì„±ê³± ëª¨ë¸ ìƒì„±
ì•„ë˜ì˜ ê·¸ë¦¼ì„ êµ¬í˜„í•  ê²ƒì„
![image](https://user-images.githubusercontent.com/76824611/128993962-42166a4e-3a09-4a15-a8f4-42dece705a69.png)

í•„ìš”í•œê±´ ì¤„í…Œë‹ˆ ê³„ì¸µì„ í•˜ë‚˜í•˜ë‚˜ êµ¬í˜„í•´ ë³´ì!
*  padding="same" ì´ë‹¤

```python 
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import (
    Dense,
    Conv2D,
    MaxPool2D,
    Flatten,
    Dropout,
    BatchNormalization,
) 
```

ë¨¼ì € ì¸ìŠ¤í„´ìŠ¤ ë¶€í„° ìƒì„±í•´ë¼  

<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python 
model = Sequential()
model.add(Conv2D(75, (3, 3), strides=1, padding="same", activation="relu", input_shape=(28, 28, 1)))
model.add(BatchNormalization())
model.add(MaxPool2D((2, 2), strides=2, padding="same"))
model.add(Conv2D(50, (3, 3), strides=1, padding="same", activation="relu"))
model.add(Dropout(0.2))
model.add(BatchNormalization())
model.add(MaxPool2D((2, 2), strides=2, padding="same"))
model.add(Conv2D(25, (3, 3), strides=1, padding="same", activation="relu"))
model.add(BatchNormalization())
model.add(MaxPool2D((2, 2), strides=2, padding="same"))
model.add(Flatten())
model.add(Dense(units=512, activation="relu"))
model.add(Dropout(0.3))
model.add(Dense(units=num_classes, activation="softmax"))
```
    
</div>
</details>

ê·¸ëŸ¼ ì´ì œ ê° ë§¤ì„œë“œë¥¼ ì„¤ëª…í•´ë³´ì!!


## Conv2D
ì‘ì€ ì»¤ë„ì€ ì…ë ¥ ì´ë¯¸ì§€ë“¤ì„ í›‘ìœ¼ë©°, ë¶„ë¥˜ì— ì¤‘ìš”í•œ íŠ¹ì§•ë“¤ì„ íŒŒì•…í•˜ëŠ” ë‹¨ê³„       
* ëª¨ë¸ì˜ ì´ˆê¸° ì»¨ë³¼ë£¨ì…˜: ì„ ê³¼ ê°™ì€ ê°„ë‹¨í•œ íŠ¹ì§•ì„ íƒì§€     
* ê·¸ ì´í›„ ì»¨ë³¼ë£¨ì…˜:  ì ì  ë” ë³µì¡í•œ íŠ¹ì§•ì„ íƒì§€         
* [ì¸µ ê¹Šì´ì— ë”°ë¥¸ ì¶”ì¶œì •ë³´ ë³€í™” ë” ì•Œì•„ë³´ê¸°](https://yerimoh.github.io/DL8/#%EC%B8%B5-%EA%B9%8A%EC%9D%B4%EC%97%90-%EB%94%B0%EB%A5%B8-%EC%B6%94%EC%B6%9C-%EC%A0%95%EB%B3%B4-%EB%B3%80%ED%99%94)

ì»¤ë„ êµ¬í˜„
* 75: ìš°ë¦¬ê°€ í•™ìŠµí•˜ê²Œ ë  í•„í„°(Filter)ì˜ ê°¯ìˆ˜     
* (3,3): í•„í„°ì˜ í¬ê¸°    
* strides: í•„í„°ê°€ ì´ë¯¸ì§€ë¥¼ ì–¼ë§ˆë§Œí¼ì˜ ê°„ê²©ìœ¼ë¡œ ì´ë™í•  ê²ƒì¸ì§€       
* padding: ì…ë ¥ ì´ë¯¸ì§€ì™€ ê²°ê³¼ ì´ë¯¸ì§€ì˜ í¬ê¸°ë¥¼ ë§ì¶”ê¸° ìœ„í•´ì„œ ì‚¬ìš©      

```python 
model.add(Conv2D(75 , (3,3) , strides = 1 , padding = 'same'...)
```


### ë°°ì¹˜ ì •ê·œí™”
[ì…ë ¥ì„ ì •ê·œí™”](https://yerimoh.github.io/DL6/#2-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EA%B7%9C%ED%99%94)í•˜ëŠ” ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ,      
ë°°ì¹˜ì •ê·œí™”ëŠ” **hidden layerë“¤ì˜ ê°’ì„ scaling**í•˜ì—¬ **í•™ìŠµì„ ê°œì„ **     


### MaxPool2D
í’€ë§ì˜ ì¢…ë¥˜ ì¤‘ [ìµœëŒ€ í’€ë§](https://yerimoh.github.io/DL8/#%ED%92%80%EB%A7%81%EC%9D%98-%EC%A2%85%EB%A5%98)       
* ëª¨ë¸ì´ ì•½ê°„ì˜ ë³€í™”ì— ë”ìš± ê²¬ê³ í•˜ê²Œ ë§Œë“¤ê¸° ê°€ëŠ¥        
* ëª¨ë¸ì˜ í•™ìŠµ ë° ì¶”ë¡  ì†ë„ í–¥ìƒ    


### Dropout
ê³¼ì í•©(Overfitting)ì„ ë°©ì§€í•˜ëŠ” ê¸°ìˆ       
* ë¬´ì‘ìœ„ë¡œ ë‰´ëŸ° ì¤‘ ì¼ë¶€ë¥¼ ì„ íƒí•˜ê³  ì œì™¸ì‹œì¼œ, ë‰´ëŸ°ë“¤ì´ íŠ¹ì • ê²½ë¡œì—ì„œ forward í˜¹ì€ backward progationì— ì°¸ì—¬í•˜ì§€ ì•Šë„ë¡ í•¨    
* [ë” ì•Œì•„ë³´ê¸°](https://yerimoh.github.io/DL5/#%EB%93%9C%EB%A1%AD%EC%95%84%EC%9B%83)


### Flatten
í‰íƒ„í™”ë¡œ ë‹¤ì°¨ì› ì…ë ¥ì„ 1ì°¨ì›ìœ¼ë¡œ ë³€í™˜ì‹œì¼œ ì¤Œ          
* feature vector: Flattenì˜ ê²°ê³¼, ë¶„ë¥˜ë¥¼ ìœ„í•œ ë§ˆì§€ë§‰ layerë¡œ ì—°ê²°    

### Dense 
**ì²« dense ë ˆì´ì–´**: (512 ìœ ë‹›)ëŠ” feature vectorë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ìœ¼ë©°, ì–´ë– í•œ Featureê°€ ë¶„ë¥˜ì— ê¸°ì—¬í•˜ëŠ”ì§€ë¥¼ í•™ìŠµ    
**ë‘ ë²ˆì§¸ dense ë ˆì´ì–´**: (24 ìœ ë‹›)ëŠ” ìš°ë¦¬ì˜ ë¶„ë¥˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ìœ„í•œ ë§ˆì§€ë§‰ layerë¡œ í™œìš©ë¨     



----

# ëª¨ë¸ ìš”ì•½

<details>
<summary>ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python 
model.summary()
```
```
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 28, 28, 75)        750       
_________________________________________________________________
batch_normalization (BatchNo (None, 28, 28, 75)        300       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 14, 14, 75)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 14, 14, 50)        33800     
_________________________________________________________________
dropout (Dropout)            (None, 14, 14, 50)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 14, 14, 50)        200       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 7, 7, 50)          0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 7, 7, 25)          11275     
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 25)          100       
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 4, 4, 25)          0         
_________________________________________________________________
flatten (Flatten)            (None, 400)               0         
_________________________________________________________________
dense (Dense)                (None, 512)               205312    
_________________________________________________________________
dropout_1 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 24)                12312     
=================================================================
Total params: 264,049
Trainable params: 263,749
Non-trainable params: 300
_________________________________________________________________
```    
</div>
</details>

----

# ëª¨ë¸ ì»´íŒŒì¼
ì‹¤ì œë¡œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ íŠ¸ë ˆì´ë‹í•˜ê¸° ì „ì— ìˆ˜í–‰í•´ì•¼ í•  ë§ˆì§€ë§‰ ë‹¨ê³„       
* ì†ì‹¤í•¨ìˆ˜: ```categorical crossentropy```ì‚¬ìš©      
* ëª¨ë¸ì˜ ì •í™•ë„ë¥¼ ì¸¡ì •

<details>
<summary> ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
model.compile(loss="categorical_crossentropy", metrics=["accuracy"])
```

</div>
</details>



# ëª¨ë¸ íŠ¸ë ˆì´ë‹
ëª¨ë¸ì˜ ```fit``` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ì—ì„œ ìƒì„±í•œ íŠ¸ë ˆì´ë‹ ë° ê²€ì¦ ì´ë¯¸ì§€ì™€ ë ˆì´ë¸”ë¡œ **20ì—í¬í¬** ë™ì•ˆ íŠ¸ë ˆì´ë‹í•´ë¼.     


<details>
<summary> ğŸ‘€ ì •ë‹µ ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```python
model.fit(x_train, y_train, epochs=20, verbose=1, validation_data=(x_valid, y_valid))
```

</div>
</details>


# ê²°ê³¼ í•´ì„

ë¨¼ì € ê²°ê³¼ë¥¼ ë³´ì

```python
Epoch 1/20
858/858 [==============================] - 5s 6ms/step - loss: 0.3107 - accuracy: 0.9055 - val_loss: 0.6278 - val_accuracy: 0.8240
Epoch 2/20
858/858 [==============================] - 4s 5ms/step - loss: 0.0192 - accuracy: 0.9940 - val_loss: 0.4390 - val_accuracy: 0.9131
Epoch 3/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0124 - accuracy: 0.9961 - val_loss: 0.2644 - val_accuracy: 0.9453
Epoch 4/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0085 - accuracy: 0.9973 - val_loss: 0.3846 - val_accuracy: 0.9186
Epoch 5/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0063 - accuracy: 0.9977 - val_loss: 0.3341 - val_accuracy: 0.9463
Epoch 6/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0053 - accuracy: 0.9986 - val_loss: 0.4166 - val_accuracy: 0.9366
Epoch 7/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0047 - accuracy: 0.9990 - val_loss: 0.5201 - val_accuracy: 0.9151
Epoch 8/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0041 - accuracy: 0.9989 - val_loss: 2.2097 - val_accuracy: 0.7839
Epoch 9/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0034 - accuracy: 0.9992 - val_loss: 0.3527 - val_accuracy: 0.9421
Epoch 10/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0024 - accuracy: 0.9993 - val_loss: 0.3070 - val_accuracy: 0.9516
Epoch 11/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0037 - accuracy: 0.9989 - val_loss: 0.3727 - val_accuracy: 0.9481
Epoch 12/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0025 - accuracy: 0.9993 - val_loss: 0.4154 - val_accuracy: 0.9423
Epoch 13/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.5034 - val_accuracy: 0.9463
Epoch 14/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0024 - accuracy: 0.9995 - val_loss: 0.7400 - val_accuracy: 0.9296
Epoch 15/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0011 - accuracy: 0.9998 - val_loss: 0.3552 - val_accuracy: 0.9414
Epoch 16/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0011 - accuracy: 0.9997 - val_loss: 0.3995 - val_accuracy: 0.9520
Epoch 17/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0032 - accuracy: 0.9992 - val_loss: 0.4067 - val_accuracy: 0.9511
Epoch 18/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0022 - accuracy: 0.9995 - val_loss: 0.5415 - val_accuracy: 0.9508
Epoch 19/20
858/858 [==============================] - 4s 4ms/step - loss: 8.1472e-04 - accuracy: 0.9998 - val_loss: 0.3580 - val_accuracy: 0.9626
Epoch 20/20
858/858 [==============================] - 4s 4ms/step - loss: 0.0021 - accuracy: 0.9997 - val_loss: 0.5734 - val_accuracy: 0.9399
<tensorflow.python.keras.callbacks.History at 0x7f2323e1feb8>
```

[CNNì„ ì“°ì§€ ì•Šì•˜ì„ ë•Œ](https://yerimoh.github.io/DL6/) ë³´ë‹¤ í•™ìŠµ ì •í™•ë„ë„ ë§¤ìš° ë†’ê³ , ê²€ì¦ ì •í™•ë„ë„ í–¥ìƒ        

ğŸš« ê²€ì¦ ì •í™•ë„ê°€ ìˆ˜ë ´í•˜ì§€ ì•ŠìŒ â¡ ë‚˜ì¤‘ì— ê°œì„ í•  ê²ƒì„

----


# ë©”ëª¨ë¦¬
ë„˜ì–´ê°€ê¸° ì „ì— ë‹¤ìŒ ì…€ì„ ì‹¤í–‰í•˜ì—¬ GPU ë©”ëª¨ë¦¬ë¥¼ ì§€ìš°ê¸°     
ì´ëŠ” ë‹¤ìŒ ë…¸íŠ¸ë¶ìœ¼ë¡œ ë„˜ì–´ê°€ê¸° ìœ„í•œ í•„ìˆ˜ ì‘ì—…     
```python
import IPython
app = IPython.Application.instance()
app.kernel.do_shutdown(True)
```


